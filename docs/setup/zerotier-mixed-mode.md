# üåê ZeroTier + –°–º–µ—à–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º

–ì–∏–±—Ä–∏–¥–Ω–∞—è —Å–µ—Ç—å: –ª–æ–∫–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø + ZeroTier VPN –¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã

---

## üéØ –í–∞—à–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      ZeroTier Network                        ‚îÇ
‚îÇ                    (–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å–µ—Ç—å)                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì                    ‚Üì                    ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ –õ–æ–∫–∞—Ü–∏—è‚îÇ          ‚îÇ –õ–æ–∫–∞—Ü–∏—è‚îÇ          ‚îÇ –ù–æ—É—Ç–±—É–∫‚îÇ
    ‚îÇ   #1   ‚îÇ          ‚îÇ   #2   ‚îÇ          ‚îÇ(–≤ –ø—É—Ç–∏)‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì                    ‚Üì                    ‚Üì
    MikroTik            MikroTik         –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø
    + ZeroTier          + ZeroTier        –∫ ZeroTier
         ‚Üì                    ‚Üì
  Home Assistant     Home Assistant
   192.168.1.X         192.168.2.X
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

‚úÖ **–õ–æ–∫–∞–ª—å–Ω–æ** - –±—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Ç—å (SSH/SAMBA)
‚úÖ **–£–¥–∞–ª—ë–Ω–Ω–æ** - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ ZeroTier VPN
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ** - —Å–∫—Ä–∏–ø—Ç—ã —Å–∞–º–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≥–¥–µ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å
‚úÖ **–ë–µ–∑ –ø—Ä–æ–±—Ä–æ—Å–∞ –ø–æ—Ä—Ç–æ–≤** - ZeroTier —Å–æ–∑–¥–∞—ë—Ç –ø—Ä—è–º–æ–µ P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

---

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

### –¢—Ä–∏ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤

**1. Local (–õ–æ–∫–∞–ª—å–Ω—ã–π)**

```text
–ö–æ–º–ø—å—é—Ç–µ—Ä ‚îÄ‚îÄ[SSH/SAMBA]‚îÄ‚îÄ> Home Assistant
  (–¥–æ–º–∞)     192.168.1.X      (–ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ)
```

**2. Global (–ì–ª–æ–±–∞–ª—å–Ω—ã–π)**

```text
–ö–æ–º–ø—å—é—Ç–µ—Ä ‚îÄ‚îÄ[Internet]‚îÄ‚îÄ> –ë–µ–ª—ã–π IP ‚îÄ‚îÄ> MikroTik ‚îÄ‚îÄ> Home Assistant
 (–≤ –ø—É—Ç–∏)    –ü–æ—Ä—Ç—ã 22/443                  192.168.1.X
```

**3. Mixed (–°–º–µ—à–∞–Ω–Ω—ã–π) ‚Üê –í–∞—à —Å–ª—É—á–∞–π!**

```text
–ï—Å–ª–∏ –¥–æ–º–∞:
  –ö–æ–º–ø—å—é—Ç–µ—Ä ‚îÄ‚îÄ[SSH/SAMBA]‚îÄ‚îÄ> 192.168.1.X (–±—ã—Å—Ç—Ä–æ, –ø—Ä—è–º–æ)

–ï—Å–ª–∏ –Ω–µ –¥–æ–º–∞:
  –ö–æ–º–ø—å—é—Ç–µ—Ä ‚îÄ‚îÄ[ZeroTier]‚îÄ‚îÄ> 10.147.X.X ‚îÄ‚îÄ> Home Assistant
              (VPN —Ç—É–Ω–Ω–µ–ª—å)  (ZeroTier IP)
```

---

## üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ZeroTier

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å —Å–µ—Ç—å ZeroTier

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è: <https://my.zerotier.com>
2. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å–µ—Ç—å: **Create A Network**
3. –ó–∞–ø–∏—Å–∞—Ç—å **Network ID**: `abcdef1234567890`

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å ZeroTier –Ω–∞ MikroTik

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ZeroTier –Ω–∞ RouterOS v7+

```bash
# –ß–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª MikroTik
/system package print
# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤–µ—Ä—Å–∏—è 7.0+

# –í–∫–ª—é—á–∏—Ç—å ZeroTier
/zerotier enable

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ç–∏
/zerotier join network=abcdef1234567890
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ static routes

```bash
# –£–∑–Ω–∞—Ç—å ZeroTier –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
/interface print
# –ù–∞–π–¥–∏—Ç–µ zt-abcdef (ZeroTier –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)

# –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç —á–µ—Ä–µ–∑ ZeroTier
# –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ –ª–æ–∫–∞—Ü–∏–∏ #2
/ip route add \
  dst-address=192.168.2.0/24 \
  gateway=10.147.X.X \
  comment="Route to Location #2 via ZeroTier"

# –ì–¥–µ 10.147.X.X - ZeroTier IP —Ä–æ—É—Ç–µ—Ä–∞ –ª–æ–∫–∞—Ü–∏–∏ #2
```

#### –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ —á–µ—Ä–µ–∑ ZeroTier

```bash
# Firewall: —Ä–∞–∑—Ä–µ—à–∏—Ç—å ZeroTier
/ip firewall filter add \
  chain=input \
  in-interface=zt-abcdef \
  action=accept \
  comment="Allow ZeroTier"

/ip firewall filter add \
  chain=forward \
  in-interface=zt-abcdef \
  action=accept \
  comment="Forward ZeroTier"
```

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å ZeroTier –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (Linux)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ZeroTier
curl -s https://install.zerotier.com | sudo bash

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ç–∏
sudo zerotier-cli join abcdef1234567890

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo zerotier-cli listnetworks
```

### –®–∞–≥ 4: –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –ø–∞–Ω–µ–ª–∏ ZeroTier

1. –ü–µ—Ä–µ–π—Ç–∏: <https://my.zerotier.com>
2. –û—Ç–∫—Ä—ã—Ç—å –≤–∞—à—É —Å–µ—Ç—å
3. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –¥–æ **Members**
4. –ü–æ—Å—Ç–∞–≤–∏—Ç—å ‚úÖ **Auth** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
5. –ü—Ä–∏—Å–≤–æ–∏—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ (MikroTik-Home, MikroTik-Office, Laptop)

---

## üìù –ù–∞—Å—Ç—Ä–æ–π–∫–∞ config.yml –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

```yaml
# /home/gfer/HASSio/config.yml

mode: "mixed"  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

home_assistant:
  # –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø (–∫–æ–≥–¥–∞ –¥–æ–º–∞)
  local_ip: "192.168.1.20"
  local_port: 8123

  # ZeroTier –¥–æ—Å—Ç—É–ø (–∫–æ–≥–¥–∞ –Ω–µ –¥–æ–º–∞)
  zerotier_ip: "10.147.20.100"  # ZeroTier IP –≤–∞—à–µ–≥–æ HA
  zerotier_port: 8123

  # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø (—á–µ—Ä–µ–∑ –±–µ–ª—ã–π IP)
  hostname: "hassio.yourdomain.com"
  global_ip: "YOUR_WHITE_IP"
  global_port: 443

ssh:
  username: "root"
  port: 22

  # –õ–æ–∫–∞–ª—å–Ω–æ
  local_ip: "192.168.1.20"

  # –ß–µ—Ä–µ–∑ ZeroTier
  zerotier_ip: "10.147.20.100"

  # –ì–ª–æ–±–∞–ª—å–Ω–æ
  global_ip: "YOUR_WHITE_IP"
  global_port: 22

samba:
  username: "homeassistant"
  password: "your_password"

  # –õ–æ–∫–∞–ª—å–Ω–æ
  local_ip: "192.168.1.20"

  # –ß–µ—Ä–µ–∑ ZeroTier
  zerotier_ip: "10.147.20.100"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞
detection:
  # IP –∞–¥—Ä–µ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏
  local_gateway: "192.168.1.1"

  # ZeroTier —Å–µ—Ç—å
  zerotier_network: "abcdef1234567890"
```

---

## üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

–°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏

```bash
# –ü–∏–Ω–≥—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑
ping -c 1 -W 1 192.168.1.1 >/dev/null 2>&1
if [ $? -eq 0 ]; then
    echo "–õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º LOCAL"
fi
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ ZeroTier

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º ZeroTier –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
if zerotier-cli listnetworks | grep -q "OK"; then
    echo "ZeroTier –∞–∫—Ç–∏–≤–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º ZEROTIER"
fi
```

### 3. Fallback –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π

```bash
# –ï—Å–ª–∏ –Ω–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è, –Ω–∏ ZeroTier –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
echo "–ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø ‚Üí GLOBAL"
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

```bash
# –ü–∏–Ω–≥ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ HA
ping 192.168.1.20

# SSH –ª–æ–∫–∞–ª—å–Ω–æ
ssh root@192.168.1.20

# SAMBA –ª–æ–∫–∞–ª—å–Ω–æ
mount | grep hassio
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ ZeroTier –¥–æ—Å—Ç—É–ø–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å ZeroTier
sudo zerotier-cli listnetworks
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: OK PRIVATE abcdef1234567890

# –£–∑–Ω–∞—Ç—å –≤–∞—à ZeroTier IP
ip addr show zt0
# –ò–ª–∏
sudo zerotier-cli listnetworks | grep "10.147"

# –ü–∏–Ω–≥ HA —á–µ—Ä–µ–∑ ZeroTier
ping 10.147.20.100

# SSH —á–µ—Ä–µ–∑ ZeroTier
ssh root@10.147.20.100

# Home Assistant —á–µ—Ä–µ–∑ ZeroTier
curl http://10.147.20.100:8123
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

```bash
# –ß–µ—Ä–µ–∑ –¥–æ–º–µ–Ω
curl https://hassio.yourdomain.com

# SSH —á–µ—Ä–µ–∑ –±–µ–ª—ã–π IP
ssh root@YOUR_WHITE_IP
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –õ–æ–∫–∞–ª—å–Ω—ã–π | ZeroTier | –ì–ª–æ–±–∞–ª—å–Ω—ã–π |
|----------|-----------|----------|------------|
| **–°–∫–æ—Ä–æ—Å—Ç—å** | ‚ö°‚ö°‚ö° –ë—ã—Å—Ç—Ä–æ | ‚ö°‚ö° –°—Ä–µ–¥–Ω–µ | ‚ö° –ú–µ–¥–ª–µ–Ω–Ω–æ |
| **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** | üîí –°–µ—Ç—å –∑–∞—â–∏—â–µ–Ω–∞ —Ä–æ—É—Ç–µ—Ä–æ–º | üîíüîí VPN —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ | üîí –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ |
| **–¢—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç** | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ | ‚úÖ –î–∞ |
| **–ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤** | ‚ùå –ù–µ –Ω—É–∂–µ–Ω | ‚ùå –ù–µ –Ω—É–∂–µ–Ω | ‚úÖ –ù—É–∂–µ–Ω |
| **–†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ** | ‚ùå –¢–æ–ª—å–∫–æ –¥–æ–º–∞ | ‚úÖ –í–µ–∑–¥–µ | ‚úÖ –í–µ–∑–¥–µ |
| **NAT traversal** | - | ‚úÖ P2P | ‚ùå –ù—É–∂–µ–Ω –±–µ–ª—ã–π IP |

---

## üîß –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –í—ã –¥–æ–º–∞

```bash
./ha
# –°–∫—Ä–∏–ø—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç: –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞
# ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç SSH/SAMBA –Ω–∞–ø—Ä—è–º—É—é –∫ 192.168.1.20
# ‚Üí –ë—ã—Å—Ç—Ä–æ, –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫
```

### –ü—Ä–∏–º–µ—Ä 2: –í—ã –≤ –∫–∞—Ñ–µ —Å –Ω–æ—É—Ç–±—É–∫–æ–º

```bash
# ZeroTier –∑–∞–ø—É—â–µ–Ω –Ω–∞ –Ω–æ—É—Ç–±—É–∫–µ
./ha
# –°–∫—Ä–∏–ø—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç: –õ–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –Ω–µ—Ç, –Ω–æ ZeroTier –∞–∫—Ç–∏–≤–µ–Ω
# ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç ZeroTier IP: 10.147.20.100
# ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ —á–µ—Ä–µ–∑ VPN —Ç—É–Ω–Ω–µ–ª—å
```

### –ü—Ä–∏–º–µ—Ä 3: –í—ã –Ω–∞ —á—É–∂–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ (–±–µ–∑ ZeroTier)

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä
https://hassio.yourdomain.com
# ‚Üí –ò–¥—ë—Ç —á–µ—Ä–µ–∑ –±–µ–ª—ã–π IP –∏ Reverse Proxy
# ‚Üí –†–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ, –Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ
```

---

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ configure.sh

–°–∫—Ä–∏–ø—Ç `configure.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```bash
./scripts/configure.sh

# –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º:
# 1) Local  - —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
# 2) Global - —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç
# 3) Mixed  - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```

**Mixed —Ä–µ–∂–∏–º —Å–æ–∑–¥–∞—Å—Ç:**
- SSH config —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ö–æ—Å—Ç–∞–º–∏
- –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

---

## üìù SSH config –¥–ª—è —Å–º–µ—à–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

–§–∞–π–ª `.ssh/config` –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å:

```text
# –õ–æ–∫–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)
Host hassio-local
    HostName 192.168.1.20
    User root
    Port 22
    IdentityFile /home/gfer/HASSio/.ssh/id_hassio
    ConnectTimeout 2

# ZeroTier –¥–æ—Å—Ç—É–ø (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)
Host hassio-zt
    HostName 10.147.20.100
    User root
    Port 22
    IdentityFile /home/gfer/HASSio/.ssh/id_hassio
    ConnectTimeout 5

# –ì–ª–æ–±–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3)
Host hassio-global
    HostName YOUR_WHITE_IP
    User root
    Port 22
    IdentityFile /home/gfer/HASSio/.ssh/id_hassio

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä
Host hassio
    HostName 192.168.1.20
    User root
    Port 22
    IdentityFile /home/gfer/HASSio/.ssh/id_hassio
    # –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω—è—Ç HostName
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ZeroTier

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **End-to-End —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ** - —Ç—Ä–∞—Ñ–∏–∫ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω
‚úÖ **P2P —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è** - –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
‚úÖ **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –≤ –ø–∞–Ω–µ–ª–∏
‚úÖ **NAT traversal** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ –ª—é–±—ã–º NAT/Firewall

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í–∫–ª—é—á–∏—Ç—å Flow Rules:**

   –í –ø–∞–Ω–µ–ª–∏ ZeroTier ‚Üí Networks ‚Üí Flow Rules:


   ```text
   # –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
   tag trusted
     id YOUR_LAPTOP_ID
     id YOUR_MIKROTIK_ID
   ;

   # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ
   drop not tag trusted;
   ```

2. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å Members:**
   - –£–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä—ã–µ/–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω—É—é —Å–µ—Ç—å:**
   - Network Access Control: **Private**
   - –¢—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

---

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### ZeroTier –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo zerotier-cli info
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: 200 info [node_id] [version] ONLINE

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–∏
sudo zerotier-cli listnetworks
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: OK PRIVATE [network_id]

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å ZeroTier
sudo systemctl restart zerotier-one
```

### –ú–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ ZeroTier

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
sudo zerotier-cli peers
# –ò—â–∏—Ç–µ DIRECT (–ø—Ä—è–º–æ–µ P2P) –∏–ª–∏ RELAY (—á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä)

# –ï—Å–ª–∏ RELAY - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ firewall
# ZeroTier –∏—Å–ø–æ–ª—å–∑—É–µ—Ç UDP –ø–æ—Ä—Ç—ã 9993
sudo ufw allow 9993/udp
```

### MikroTik –Ω–µ –≤–∏–¥–∏—Ç ZeroTier —Å–µ—Ç—å

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
/interface print
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å zt-[network_id]

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
/zerotier print
# Status: enabled

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å ZeroTier
/zerotier leave network=abcdef1234567890
/zerotier join network=abcdef1234567890
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `check_connectivity.sh`:

```bash
#!/bin/bash

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è..."
echo ""

# 1. –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
echo "1Ô∏è‚É£ –õ–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å (192.168.1.20):"
if ping -c 1 -W 1 192.168.1.20 >/dev/null 2>&1; then
    echo "   ‚úÖ –î–æ—Å—Ç—É–ø–Ω–∞"
else
    echo "   ‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–Ω–∞"
fi

# 2. ZeroTier
echo "2Ô∏è‚É£ ZeroTier (10.147.20.100):"
if ping -c 1 -W 2 10.147.20.100 >/dev/null 2>&1; then
    echo "   ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω"
    zerotier-cli peers | grep -A1 "10.147.20.100" | grep "DIRECT\|RELAY"
else
    echo "   ‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
fi

# 3. –ì–ª–æ–±–∞–ª—å–Ω—ã–π
echo "3Ô∏è‚É£ –ì–ª–æ–±–∞–ª—å–Ω—ã–π (hassio.yourdomain.com):"
if curl -s -I https://hassio.yourdomain.com >/dev/null 2>&1; then
    echo "   ‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω"
else
    echo "   ‚ùå –ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
fi
```

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [ZeroTier Documentation](https://docs.zerotier.com/)
- [ZeroTier MikroTik Setup](https://wiki.mikrotik.com/wiki/Manual:ZeroTier)
- [ZeroTier Network Rules](https://docs.zerotier.com/rules/)
- [–û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](SETUP.md)
- [–ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ MikroTik](portforward-mikrotik.md)

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- [ ] ZeroTier —Å–µ—Ç—å —Å–æ–∑–¥–∞–Ω–∞
- [ ] ZeroTier —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –≤—Å–µ—Ö MikroTik
- [ ] ZeroTier —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
- [ ] –í—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã –≤ –ø–∞–Ω–µ–ª–∏ ZeroTier
- [ ] –ú–∞—Ä—à—Ä—É—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–∞ MikroTik (via ZeroTier)
- [ ] config.yml –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å ZeroTier IP
- [ ] –¢–µ—Å—Ç: ping —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ ZeroTier
- [ ] –¢–µ—Å—Ç: SSH —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ ZeroTier
- [ ] –¢–µ—Å—Ç: Home Assistant –¥–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ ZeroTier
- [ ] –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç —Ä–µ–∂–∏–º

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ö–µ–º–∞ –≤–∞—à–µ–π —Å–µ—Ç–∏

```text
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               –í–∞—à–∞ –≥–∏–±—Ä–∏–¥–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  ZeroTier    ‚îÇ
                    ‚îÇ   Network    ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚Üì
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚Üì                 ‚Üì                 ‚Üì
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ–õ–æ–∫–∞—Ü–∏—è 1‚îÇ       ‚îÇ–õ–æ–∫–∞—Ü–∏—è 2‚îÇ      ‚îÇ –ù–æ—É—Ç–±—É–∫ ‚îÇ
    ‚îÇ  (–¥–æ–º)  ‚îÇ       ‚îÇ (–æ—Ñ–∏—Å)  ‚îÇ      ‚îÇ (–≤ –ø—É—Ç–∏)‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚Üì                 ‚Üì                 ‚Üì
    MikroTik          MikroTik         ZeroTier
    + ZeroTier        + ZeroTier        –∫–ª–∏–µ–Ω—Ç
         ‚Üì                 ‚Üì
    192.168.1.0       192.168.2.0
         ‚Üì                 ‚Üì
  Home Assistant    Home Assistant
   + SSH/SAMBA      + SSH/SAMBA

–†–µ–∂–∏–º—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ –õ–æ–∫–∞–ª—å–Ω–æ (–¥–æ–º–∞): 192.168.1.20 (–±—ã—Å—Ç—Ä–æ)
‚îÄ ‚îÄ ‚îÄ ZeroTier: 10.147.20.100 (–±–µ–∑–æ–ø–∞—Å–Ω–æ, –≤–µ–∑–¥–µ)
‚îà‚îà‚îà‚îà‚îà –ì–ª–æ–±–∞–ª—å–Ω–æ: hassio.yourdomain.com (fallback)
```

**–í—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –ª—É—á—à–µ–µ –∏–∑ –≤—Å–µ—Ö –º–∏—Ä–æ–≤:**
- üè† –ë—ã—Å—Ç—Ä–æ –¥–æ–º–∞
- üåê –ë–µ–∑–æ–ø–∞—Å–Ω–æ —á–µ—Ä–µ–∑ ZeroTier –≤ –ª—é–±–æ–π —Ç–æ—á–∫–µ
- üîì Fallback —á–µ—Ä–µ–∑ –±–µ–ª—ã–π IP –µ—Å–ª–∏ ZeroTier –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å —É –≤–∞—Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –≥–∏–±—Ä–∏–¥–Ω–∞—è —Å–µ—Ç—å —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–±–æ—Ä–æ–º –ª—É—á—à–µ–≥–æ –º–µ—Ç–æ–¥–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è! üéØ
