
<!doctype html>
<html lang="ru" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∞—É–¥–∏—Ç–∞ Home Assistant">
      
      
        <meta name="author" content="Gfermoto">
      
      
        <link rel="canonical" href="https://gfermoto.github.io/HASSio_Cursor/integrations/OLLAMA-PROXMOX-COMPLETE-GUIDE/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Ollama –Ω–∞ Proxmox —Å NVIDIA GPU - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ - HASSio Cursor</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ollama-proxmox-nvidia-gpu-" class="md-skip">
          –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="–í–µ—Ä—Ö–Ω–∏–π –∫–æ–ª–æ–Ω—Ç–∏—Ç—É–ª">
    <a href="../.." title="HASSio Cursor" class="md-header__button md-logo" aria-label="HASSio Cursor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HASSio Cursor
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ollama –Ω–∞ Proxmox —Å NVIDIA GPU - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="–¢—ë–º–Ω–∞—è —Ç–µ–º–∞"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="–¢—ë–º–Ω–∞—è —Ç–µ–º–∞" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="–ü–æ–∏—Å–∫" placeholder="–ü–æ–∏—Å–∫" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="–ü–æ–∏—Å–∫">
        
        <button type="reset" class="md-search__icon md-icon" title="–û—á–∏—Å—Ç–∏—Ç—å" aria-label="–û—á–∏—Å—Ç–∏—Ç—å" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Gfermoto/HASSio_Cursor" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Gfermoto/HASSio_Cursor
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="–í–∫–ª–∞–¥–∫–∏" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  üè† –ì–ª–∞–≤–Ω–∞—è

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../setup/quickstart/" class="md-tabs__link">
          
  
  
  üìñ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../guides/first-audit/" class="md-tabs__link">
          
  
  
  üìö –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../examples/heating/" class="md-tabs__link">
          
  
  
  üí° –ü—Ä–∏–º–µ—Ä—ã

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/COMMANDS/" class="md-tabs__link">
          
  
  
  üìã –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../analyzers/" class="md-tabs__link">
          
  
  
  üìä –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../n8n-ai-agents/" class="md-tabs__link">
          
  
  
  üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="HASSio Cursor" class="md-nav__button md-logo" aria-label="HASSio Cursor" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    HASSio Cursor
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Gfermoto/HASSio_Cursor" title="–ü–µ—Ä–µ–π—Ç–∏ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Gfermoto/HASSio_Cursor
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üè† –ì–ª–∞–≤–Ω–∞—è
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìñ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üìñ –£—Å—Ç–∞–Ω–æ–≤–∫–∞
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/SETUP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –î–µ—Ç–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/post-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/portforward-mikrotik/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ MikroTik
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/zerotier-mixed-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ZeroTier —Å–º–µ—à–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../setup/ssh-tunnel-samba/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SSH —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è SAMBA
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìö –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üìö –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/first-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –ü–µ—Ä–≤—ã–π –∞—É–¥–∏—Ç
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/heating-optimization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ—Ç–æ–ø–ª–µ–Ω–∏—è
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É–º–Ω–æ–≥–æ –¥–æ–º–∞
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üí° –ü—Ä–∏–º–µ—Ä—ã
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            üí° –ü—Ä–∏–º–µ—Ä—ã
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/heating/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –û—Ç–æ–ø–ª–µ–Ω–∏–µ
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/energy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –≠–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–∂–µ–Ω–∏–µ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìã –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üìã –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/COMMANDS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –ö–æ–º–∞–Ω–¥—ã
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/WORKFLOW/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –†–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üìä –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            üìä –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../analyzers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    –û–±–∑–æ—Ä
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../n8n-ai-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ü§ñ AI –ê–≥–µ–Ω—Ç—ã n8n
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../n8n-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    üìö –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ n8n
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../n8n-butler-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ü§µ –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vm-lxc" class="md-nav__link">
    <span class="md-ellipsis">
      –ü–æ—á–µ–º—É VM, –∞ –Ω–µ LXC?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-biosuefi" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ BIOS/UEFI (–Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–µ)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ BIOS/UEFI (–Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–µ)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 –í–∫–ª—é—á–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-bios" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ BIOS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-asrock" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –¥–ª—è ASRock –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç (–≤–∞–∂–Ω–æ!)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-proxmox-iommu" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 2: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Proxmox —Ö–æ—Å—Ç–∞ –¥–ª—è IOMMU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 2: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Proxmox —Ö–æ—Å—Ç–∞ –¥–ª—è IOMMU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-grub" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GRUB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-vfio" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 –ó–∞–≥—Ä—É–∑–∫–∞ VFIO –º–æ–¥—É–ª–µ–π
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Ö–æ—Å—Ç–∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-iommu" class="md-nav__link">
    <span class="md-ellipsis">
      2.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ IOMMU –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-gpu-passthrough" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ GPU –¥–ª—è passthrough
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ GPU –¥–ª—è passthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ GPU –≤ —Å–∏—Å—Ç–µ–º–µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-iommu" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ IOMMU –≥—Ä—É–ø–ø—ã
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-blacklist-nvidia" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Blacklist NVIDIA –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –Ω–∞ —Ö–æ—Å—Ç–µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-gpu-vfio" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 –ü—Ä–∏–≤—è–∑–∫–∞ GPU –∫ VFIO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-gpu-binding" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ GPU binding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-ubuntu-server-iso" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 4: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ Ubuntu Server ISO
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#45" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 4.5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏ –Ω–∞ —Ö–æ—Å—Ç–µ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 4.5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏ –Ω–∞ —Ö–æ—Å—Ç–µ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ram-vm" class="md-nav__link">
    <span class="md-ellipsis">
      üìä –†–∞—Å—á–µ—Ç RAM –¥–ª—è VM:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ö†Ô∏è –î–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-vm-proxmox-web-ui" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 5: –°–æ–∑–¥–∞–Ω–∏–µ VM —á–µ—Ä–µ–∑ Proxmox Web UI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 5: –°–æ–∑–¥–∞–Ω–∏–µ VM —á–µ—Ä–µ–∑ Proxmox Web UI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-vm" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 –ó–∞–ø—É—Å–∫ –º–∞—Å—Ç–µ—Ä–∞ —Å–æ–∑–¥–∞–Ω–∏—è VM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-general-1" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 General (–≤–∫–ª–∞–¥–∫–∞ 1)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-os-2" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 OS (–≤–∫–ª–∞–¥–∫–∞ 2)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-system-3-" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 System (–≤–∫–ª–∞–¥–∫–∞ 3) - –ö–†–ò–¢–ò–ß–ù–û!
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-disks-4" class="md-nav__link">
    <span class="md-ellipsis">
      5.5 Disks (–≤–∫–ª–∞–¥–∫–∞ 4)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#56-cpu-5-" class="md-nav__link">
    <span class="md-ellipsis">
      5.6 CPU (–≤–∫–ª–∞–¥–∫–∞ 5) - –ö–†–ò–¢–ò–ß–ù–û!
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#57-memory-6" class="md-nav__link">
    <span class="md-ellipsis">
      5.7 Memory (–≤–∫–ª–∞–¥–∫–∞ 6)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#58-network-7" class="md-nav__link">
    <span class="md-ellipsis">
      5.8 Network (–≤–∫–ª–∞–¥–∫–∞ 7)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#59-confirm-8" class="md-nav__link">
    <span class="md-ellipsis">
      5.9 Confirm (–≤–∫–ª–∞–¥–∫–∞ 8)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-gpu-vm" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 6: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ GPU –≤ VM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 6: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ GPU –≤ VM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-pci-web-ui" class="md-nav__link">
    <span class="md-ellipsis">
      6.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ Web UI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ Web UI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#611-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      6.1.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ GPU
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-vm" class="md-nav__link">
    <span class="md-ellipsis">
      6.2 –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è VM (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-ubuntu-server-vm" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 7: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ubuntu Server –≤ VM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 7: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ubuntu Server –≤ VM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-vm" class="md-nav__link">
    <span class="md-ellipsis">
      7.1 –ó–∞–ø—É—Å–∫ VM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-ubuntu-installation-wizard" class="md-nav__link">
    <span class="md-ellipsis">
      7.2 Ubuntu Installation Wizard
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73" class="md-nav__link">
    <span class="md-ellipsis">
      7.3 –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-ubuntu-vm" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 8: –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Ubuntu VM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 8: –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Ubuntu VM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#81-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      8.1 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82" class="md-nav__link">
    <span class="md-ellipsis">
      8.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83" class="md-nav__link">
    <span class="md-ellipsis">
      8.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö —É—Ç–∏–ª–∏—Ç
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      8.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ GPU
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-nvidia-ubuntu-vm" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 9: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NVIDIA –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤ Ubuntu VM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 9: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NVIDIA –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤ Ubuntu VM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#91" class="md-nav__link">
    <span class="md-ellipsis">
      9.1 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-nvidia" class="md-nav__link">
    <span class="md-ellipsis">
      9.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NVIDIA –¥—Ä–∞–π–≤–µ—Ä–∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-vm" class="md-nav__link">
    <span class="md-ellipsis">
      9.3 –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ VM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94-nvidia" class="md-nav__link">
    <span class="md-ellipsis">
      9.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ NVIDIA –¥—Ä–∞–π–≤–µ—Ä–∞
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-ollama" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 10: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Ollama
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 10: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Ollama">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#101-ollama" class="md-nav__link">
    <span class="md-ellipsis">
      10.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#102-api" class="md-nav__link">
    <span class="md-ellipsis">
      10.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ API
    </span>
  </a>
  
    <nav class="md-nav" aria-label="10.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-systemctl-edit" class="md-nav__link">
    <span class="md-ellipsis">
      –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ systemctl edit (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-a" class="md-nav__link">
    <span class="md-ellipsis">
      –í–∞—Ä–∏–∞–Ω—Ç B: –ï—Å–ª–∏ –í–∞—Ä–∏–∞–Ω—Ç A –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#103-api-endpoint" class="md-nav__link">
    <span class="md-ellipsis">
      10.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoint
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11_1" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 11: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 11: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#111-vram" class="md-nav__link">
    <span class="md-ellipsis">
      11.1 –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –ø–æ VRAM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#112" class="md-nav__link">
    <span class="md-ellipsis">
      11.2 –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#113" class="md-nav__link">
    <span class="md-ellipsis">
      11.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#114-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      11.4 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å GPU
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#115-api" class="md-nav__link">
    <span class="md-ellipsis">
      11.5 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#12-n8n" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 12: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å n8n
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 12: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å n8n">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#121-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      12.1 –°–∫–∞—á–∏–≤–∞–Ω–∏–µ workflow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-n8n" class="md-nav__link">
    <span class="md-ellipsis">
      12.2 –ò–º–ø–æ—Ä—Ç –≤ n8n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123-ollama-node" class="md-nav__link">
    <span class="md-ellipsis">
      12.3 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ollama node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124-home-assistant" class="md-nav__link">
    <span class="md-ellipsis">
      12.4 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Home Assistant
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#125-telegram" class="md-nav__link">
    <span class="md-ellipsis">
      12.5 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Telegram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#126-tool-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      12.6 –°–æ–∑–¥–∞–Ω–∏–µ Tool workflows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#127-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      12.7 –ê–∫—Ç–∏–≤–∞—Ü–∏—è workflow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      –≠—Ç–∞–ø 13: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–≠—Ç–∞–ø 13: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#131" class="md-nav__link">
    <span class="md-ellipsis">
      13.1 –ü—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132" class="md-nav__link">
    <span class="md-ellipsis">
      13.2 –ö–æ–º–∞–Ω–¥–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      13.3 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#134" class="md-nav__link">
    <span class="md-ellipsis">
      13.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snapshot-vm" class="md-nav__link">
    <span class="md-ellipsis">
      Snapshot VM –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backup-vm" class="md-nav__link">
    <span class="md-ellipsis">
      Backup VM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ollama" class="md-nav__link">
    <span class="md-ellipsis">
      –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Ollama
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu" class="md-nav__link">
    <span class="md-ellipsis">
      –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –∞–ø–≥—Ä–µ–π–¥–∞ GPU
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vm-cannot-allocate-memory" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–±–ª–µ–º–∞: VM –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è - Cannot allocate memory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#amd-vi-iommu-groups-0" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–±–ª–µ–º–∞: AMD-Vi –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è (IOMMU groups = 0)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vm-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–±–ª–µ–º–∞: VM –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è GPU
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu-nvidia-smi" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–±–ª–µ–º–∞: GPU –≤–∏–¥–µ–Ω, –Ω–æ nvidia-smi –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ollama-cpu-mode" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–±–ª–µ–º–∞: Ollama –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç (CPU mode)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#out-of-memory" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–±–ª–µ–º–∞: Out of Memory –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ollama-127001" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–±–ª–µ–º–∞: Ollama –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å–µ—Ç–∏ (—Å–ª—É—à–∞–µ—Ç –Ω–∞ 127.0.0.1)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#code-43-device-manager-windows-vm" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–±–ª–µ–º–∞: Code 43 –≤ Device Manager (–µ—Å–ª–∏ Windows VM)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–µ—Ç—Ä–∏–∫–∏
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–µ—Ç—Ä–∏–∫–∏">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gtx-1050-ti-4gb-phi3mini-vm" class="md-nav__link">
    <span class="md-ellipsis">
      GTX 1050 Ti (4GB) + phi3:mini –≤ VM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gtx-1060-6gb-llama318b" class="md-nav__link">
    <span class="md-ellipsis">
      GTX 1060 (6GB) + llama3.1:8b –ø–æ—Å–ª–µ –∞–ø–≥—Ä–µ–π–¥–∞
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cpu-pinning-vm" class="md-nav__link">
    <span class="md-ellipsis">
      CPU pinning –¥–ª—è VM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#huge-pages-8b" class="md-nav__link">
    <span class="md-ellipsis">
      Huge pages (–¥–ª—è –º–æ–¥–µ–ª–µ–π 8B+)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gpu_1" class="md-nav__link">
    <span class="md-ellipsis">
      –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –¥–≤—É–º—è GPU
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –¥–≤—É–º—è GPU">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-radeon-nvidia-vm" class="md-nav__link">
    <span class="md-ellipsis">
      –í–∞—Ä–∏–∞–Ω—Ç 1: Radeon –¥–ª—è —Ö–æ—Å—Ç–∞, NVIDIA –¥–ª—è VM (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-vm-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      –í–∞—Ä–∏–∞–Ω—Ç 2: –î–≤–µ VM - –∫–∞–∂–¥–∞—è —Å–æ —Å–≤–æ–µ–π GPU
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-nvidia-gpu-vm" class="md-nav__link">
    <span class="md-ellipsis">
      –í–∞—Ä–∏–∞–Ω—Ç 3: –î–≤–µ NVIDIA GPU –≤ –æ–¥–Ω–æ–π VM (–¥–ª—è –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nvidia-amd" class="md-nav__link">
    <span class="md-ellipsis">
      –°–º–µ—à–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (NVIDIA + AMD)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      –§–∏–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      –ß–µ–∫–ª–∏—Å—Ç —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proxmox" class="md-nav__link">
    <span class="md-ellipsis">
      –ù–∞ Proxmox —Ö–æ—Å—Ç–µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ubuntu-vm" class="md-nav__link">
    <span class="md-ellipsis">
      –í Ubuntu VM
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è (–∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è (–∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-asrock-iommu-bios" class="md-nav__link">
    <span class="md-ellipsis">
      1. ‚ö†Ô∏è ASRock –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã: IOMMU —Å–∫—Ä—ã—Ç –≤ —Å—Ç–∞—Ä—ã—Ö BIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-amd-amd_iommu1" class="md-nav__link">
    <span class="md-ellipsis">
      2. ‚ö†Ô∏è AMD –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã: –ø–∞—Ä–∞–º–µ—Ç—Ä amd_iommu=1 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-ram" class="md-nav__link">
    <span class="md-ellipsis">
      3. ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ RAM –Ω–∞ —Ö–æ—Å—Ç–µ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-cpu-vm" class="md-nav__link">
    <span class="md-ellipsis">
      4. ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ cpu –≤ –∫–æ–Ω—Ñ–∏–≥–µ VM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-x-vga1" class="md-nav__link">
    <span class="md-ellipsis">
      5. ‚ö†Ô∏è –ú–∞–π–Ω–∏–Ω–≥–æ–≤—ã–µ –∫–∞—Ä—Ç—ã: x-vga=1 –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-ollama-127001" class="md-nav__link">
    <span class="md-ellipsis">
      6. ‚ö†Ô∏è Ollama —Å–ª—É—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ 127.0.0.1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-efi" class="md-nav__link">
    <span class="md-ellipsis">
      7. ‚úÖ EFI —Ä–∞–∑–¥–µ–ª –Ω–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-unknown-option-on-amd_iommu" class="md-nav__link">
    <span class="md-ellipsis">
      8. ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "Unknown option - 'on'" –¥–ª—è amd_iommu
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="ollama-proxmox-nvidia-gpu-">Ollama –Ω–∞ Proxmox —Å NVIDIA GPU - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ<a class="headerlink" href="#ollama-proxmox-nvidia-gpu-" title="Permanent link">&para;</a></h1>
<p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é Ollama –≤ Ubuntu VM –Ω–∞ Proxmox —Å GPU passthrough.
–ö–æ–Ω—Å–æ–ª–∏–¥–∏—Ä—É–µ—Ç community best practices –∏ –≥–ª—É–±–æ–∫–∏–µ –∑–Ω–∞–Ω–∏—è Proxmox.</p>
<p><strong>–¶–µ–ª–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</strong>
- Proxmox VE 8.x (Debian 12 Bookworm)
- NVIDIA GTX 1050 Ti (4GB VRAM) ‚Üí GTX 1060 (6GB VRAM)
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —Å –º–∞–π–Ω–∏–Ω–≥–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏ (P106, P104, CMP)
- Ubuntu 22.04 LTS VM
- Ollama —Å –º–æ–¥–µ–ª—è–º–∏ phi3:mini / llama3.1:8b</p>
<p><strong>–í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:</strong> 40-60 –º–∏–Ω—É—Ç
<strong>–°–ª–æ–∂–Ω–æ—Å—Ç—å:</strong> Intermediate
<strong>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:</strong> ‚úÖ Proxmox —Ö–æ—Å—Ç –æ—Å—Ç–∞–µ—Ç—Å—è —á–∏—Å—Ç—ã–º</p>
<hr />
<h2 id="vm-lxc">–ü–æ—á–µ–º—É VM, –∞ –Ω–µ LXC?<a class="headerlink" href="#vm-lxc" title="Permanent link">&para;</a></h2>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞ —Å LXC:</strong>
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ <code>nvidia-driver</code> –Ω–∞ Proxmox —Ö–æ—Å—Ç –≤—ã–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å <code>proxmox-ve</code> metapackage:
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>W: You are attempting to remove the meta-package &#39;proxmox-ve&#39;!
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>E: Sub-process /usr/share/proxmox-ve/pve-apt-hook returned an error code (1)
</span></code></pre></div></p>
<p><strong>–†–µ—à–µ–Ω–∏–µ - VM —Å PCI passthrough:</strong>
- ‚úÖ NVIDIA –¥—Ä–∞–π–≤–µ—Ä—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è <strong>—Ç–æ–ª—å–∫–æ –≤ VM</strong>, –Ω–µ –Ω–∞ —Ö–æ—Å—Ç–µ
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å proxmox-ve
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è –æ—Ç Proxmox
- ‚úÖ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ Ubuntu (–±–µ–∑ –ø—Ä–æ–±–ª–µ–º)
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç IOMMU/VT-d –≤ BIOS
- ‚ö†Ô∏è GPU –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π VM
- ‚ö†Ô∏è Overhead ~5-10% (–ø—Ä–∏–µ–º–ª–µ–º–æ)</p>
<p><strong>–ò—Å—Ç–æ—á–Ω–∏–∫–∏:</strong>
- <a href="https://habr.com/ru/articles/794568/">Habr: –ü—Ä–æ–±—Ä–æ—Å –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –≤ Proxmox</a>
- <a href="https://pve.proxmox.com/wiki/PCI_Passthrough">Proxmox Wiki: PCI Passthrough</a>
- <a href="https://forum.proxmox.com/threads/ubuntu-22-04-ollama-nvidia-3060-gpu-passthrough-and-drivers-all-looking-good-but.144104/">Proxmox Forum: Ollama + GPU</a></p>
<hr />
<h2 id="1-biosuefi">–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ BIOS/UEFI (–Ω–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —Å–µ—Ä–≤–µ—Ä–µ)<a class="headerlink" href="#1-biosuefi" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 –í–∫–ª—é—á–µ–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –∏ –≤–æ–π–¥–∏—Ç–µ –≤ BIOS/UEFI (–æ–±—ã—á–Ω–æ Del, F2, F10 –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ).</p>
<p>–ù–∞–π–¥–∏—Ç–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ:</p>
<p><strong>–î–ª—è Intel –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç:</strong>
- <strong>Intel VT-x</strong> (Virtualization Technology) ‚Üí Enabled
- <strong>Intel VT-d</strong> (Virtualization Technology for Directed I/O) ‚Üí Enabled
- <strong>IOMMU</strong> ‚Üí Enabled (–µ—Å–ª–∏ –µ—Å—Ç—å –æ—Ç–¥–µ–ª—å–Ω–∞—è –æ–ø—Ü–∏—è)</p>
<p><strong>–î–ª—è AMD –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç:</strong>
- <strong>SVM Mode</strong> (AMD-V) ‚Üí Enabled
- <strong>AMD-Vi</strong> (AMD IOMMU) ‚Üí Enabled
- <strong>IOMMU</strong> ‚Üí Enabled</p>
<p><strong>–ì–¥–µ –∏—Å–∫–∞—Ç—å:</strong> –û–±—ã—á–Ω–æ –≤ —Ä–∞–∑–¥–µ–ª–∞—Ö:
- Advanced ‚Üí CPU Configuration
- Chipset Configuration
- Virtualization Support</p>
<p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ (F10) –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ.</p>
<h3 id="12-bios">1.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ BIOS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ<a class="headerlink" href="#12-bios" title="Permanent link">&para;</a></h3>
<p>–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ Proxmox:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>ssh<span class="w"> </span>root@&lt;PROXMOX_IP&gt;
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>egrep<span class="w"> </span>-o<span class="w"> </span><span class="s1">&#39;(vmx|svm)&#39;</span><span class="w"> </span>/proc/cpuinfo<span class="w"> </span><span class="p">|</span><span class="w"> </span>uniq
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏: vmx (Intel) –∏–ª–∏ svm (AMD)</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1"># –ï—Å–ª–∏ –ø—É—Å—Ç–æ - VT-x/AMD-V –Ω–µ –≤–∫–ª—é—á–µ–Ω –≤ BIOS</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ IOMMU –≤ —Å–∏—Å—Ç–µ–º–µ</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-e<span class="w"> </span>DMAR<span class="w"> </span>-e<span class="w"> </span>IOMMU
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># –î–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å (Intel):</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1"># DMAR: IOMMU enabled</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c1"># DMAR-IR: Enabled IRQ remapping</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># –ò–ª–∏ (AMD):</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c1"># AMD-Vi: Found IOMMU</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c1"># AMD-Vi: Interrupt remapping enabled</span>
</span></code></pre></div>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong> –í–∏–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± IOMMU/DMAR.
<strong>–ï—Å–ª–∏ –Ω–µ—Ç (AMD):</strong> –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –Ω–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ - IOMMU –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GRUB (–≠—Ç–∞–ø 2). –ì–ª–∞–≤–Ω–æ–µ —á—Ç–æ–±—ã <code>svm</code> –±—ã–ª –≤–∏–¥–µ–Ω.</p>
<h3 id="13-asrock">1.3 –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ –¥–ª—è ASRock –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏—Ö –ø–ª–∞—Ç (–≤–∞–∂–Ω–æ!)<a class="headerlink" href="#13-asrock" title="Permanent link">&para;</a></h3>
<p>–ï—Å–ª–∏ —É –≤–∞—Å <strong>ASRock</strong> (–Ω–∞–ø—Ä–∏–º–µ—Ä B450M Pro4, X570 –∏ —Ç.–¥.) –∏ –≤—ã <strong>–Ω–µ –≤–∏–¥–∏—Ç–µ –æ–ø—Ü–∏—é IOMMU –≤ BIOS</strong>:</p>
<ol>
<li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é BIOS:</strong></li>
<li>–í–æ–π–¥–∏—Ç–µ –≤ BIOS –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–µ—Ä—Å–∏—é (–æ–±—ã—á–Ω–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ)</li>
<li>
<p>–î–ª—è B450M Pro4: —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ (P3.xx) –º–æ–≥—É—Ç –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å IOMMU</p>
</li>
<li>
<p><strong>–û–±–Ω–æ–≤–∏—Ç–µ BIOS –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏:</strong></p>
</li>
<li>–°–∫–∞—á–∞–π—Ç–µ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞ ASRock: https://www.asrock.com/support/</li>
<li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <strong>Instant Flash</strong> –≤ BIOS (Tools ‚Üí Instant Flash)</li>
<li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª .ROM –Ω–∞ USB —Ñ–ª–µ—à–∫—É FAT32</li>
<li>
<p>–í –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö (P7.xx+) –æ–ø—Ü–∏—è IOMMU –ø–æ—è–≤–ª—è–µ—Ç—Å—è</p>
</li>
<li>
<p><strong>–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è BIOS –∏—â–∏—Ç–µ:</strong></p>
</li>
<li><code>Advanced ‚Üí AMD CBS ‚Üí IOMMU ‚Üí Enabled</code></li>
</ol>
<p>–ò–ª–∏:
   - <code>Advanced ‚Üí AMD CBS ‚Üí NBIO Common Options ‚Üí IOMMU ‚Üí Enabled</code></p>
<ol>
<li><strong>–¢–∞–∫–∂–µ –≤–∫–ª—é—á–∏—Ç–µ:</strong></li>
<li>SVM Mode ‚Üí Enabled (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –≤–∫–ª—é—á–µ–Ω–æ)</li>
</ol>
<p><strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong> –ë–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è BIOS –æ–ø—Ü–∏—è IOMMU –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç–∞ –¥–∞–∂–µ –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–µ!</p>
<hr />
<h2 id="2-proxmox-iommu">–≠—Ç–∞–ø 2: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Proxmox —Ö–æ—Å—Ç–∞ –¥–ª—è IOMMU<a class="headerlink" href="#2-proxmox-iommu" title="Permanent link">&para;</a></h2>
<h3 id="21-grub">2.1 –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GRUB<a class="headerlink" href="#21-grub" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1"># Backup —Ç–µ–∫—É—â–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>cp<span class="w"> </span>/etc/default/grub<span class="w"> </span>/etc/default/grub.backup
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="c1"># –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>nano<span class="w"> </span>/etc/default/grub
</span></code></pre></div>
<p>–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É –Ω–∞—á–∏–Ω–∞—é—â—É—é—Å—è —Å <code>GRUB_CMDLINE_LINUX_DEFAULT=</code></p>
<p><strong>–î–ª—è Intel –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤:</strong></p>
<p>–ë—ã–ª–æ:
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet&quot;
</span></code></pre></div></p>
<p>–°—Ç–∞–Ω–µ—Ç:
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet intel_iommu=on iommu=pt&quot;
</span></code></pre></div></p>
<p><strong>–î–ª—è AMD –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet amd_iommu=on iommu=pt&quot;
</span></code></pre></div>
<p><strong>‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è AMD:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º–µ–Ω–Ω–æ <code>amd_iommu=on</code>, –∞ –Ω–µ <code>amd_iommu=1</code> –∏–ª–∏ <code>amd_iommu=force_enable</code>. –í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —è–¥—Ä–∞—Ö (6.8+) —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ <code>=on</code>. –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–∂–µ—Ç –ø–æ—è–≤–∏—Ç—å—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "AMD-Vi: Unknown option - 'on'" - –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –µ–≥–æ, AMD-Vi –≤—Å–µ —Ä–∞–≤–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è.</p>
<p><strong>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:</strong>
- <code>intel_iommu=on</code> / <code>amd_iommu=on</code> - –≤–∫–ª—é—á–µ–Ω–∏–µ IOMMU
- <code>iommu=pt</code> - passthrough mode (–ª—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)</p>
<p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X</p>
<p>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ GRUB:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>update-grub
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="c1"># Generating grub configuration file ...</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="c1"># Found linux image: /boot/vmlinuz-6.8.12-4-pve</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c1"># done</span>
</span></code></pre></div>
<h3 id="22-vfio">2.2 –ó–∞–≥—Ä—É–∑–∫–∞ VFIO –º–æ–¥—É–ª–µ–π<a class="headerlink" href="#22-vfio" title="Permanent link">&para;</a></h3>
<p>VFIO (Virtual Function I/O) - framework –¥–ª—è –ø—Ä–æ–±—Ä–æ—Å–∞ PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ VM.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>nano<span class="w"> </span>/etc/modules
</span></code></pre></div>
<p>–î–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>vfio
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>vfio_iommu_type1
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>vfio_pci
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>vfio_virqfd
</span></code></pre></div>
<p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X</p>
<p><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π:</strong>
- <code>vfio</code> - –æ—Å–Ω–æ–≤–Ω–æ–π framework
- <code>vfio_iommu_type1</code> - IOMMU backend
- <code>vfio_pci</code> - PCI device support
- <code>vfio_virqfd</code> - interrupt remapping</p>
<h3 id="23">2.3 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ initramfs</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>update-initramfs<span class="w"> </span>-u<span class="w"> </span>-k<span class="w"> </span>all
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1"># update-initramfs: Generating /boot/initrd.img-6.8.12-4-pve</span>
</span></code></pre></div>
<h3 id="24">2.4 –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Ö–æ—Å—Ç–∞<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>reboot
</span></code></pre></div>
<p>–ü–æ–¥–æ–∂–¥–∏—Ç–µ 2-3 –º–∏–Ω—É—Ç—ã –ø–æ–∫–∞ Proxmox –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è.</p>
<h3 id="25-iommu">2.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ IOMMU –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏<a class="headerlink" href="#25-iommu" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>ssh<span class="w"> </span>root@&lt;PROXMOX_IP&gt;
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="c1"># 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ IOMMU –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;IOMMU enabled&quot;</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1"># DMAR: IOMMU enabled (Intel)</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c1"># –∏–ª–∏</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="c1"># AMD-Vi: AMD IOMMUv2 loaded and initialized</span>
</span></code></pre></div>
<p><strong>–î–ª—è AMD: –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ IVRS</strong></p>
<p>–ï—Å–ª–∏ AMD-Vi –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ BIOS –ø–µ—Ä–µ–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É IVRS:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>ivrs
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c1"># ACPI: IVRS 0x... (–µ—Å–ª–∏ –µ—Å—Ç—å - BIOS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ)</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="c1"># –ï—Å–ª–∏ –ø—É—Å—Ç–æ - –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ BIOS, —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ IOMMU = Enabled</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1"># 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ IOMMU –≥—Ä—É–ø–ø (–∫—Ä–∏—Ç–∏—á–Ω–æ!)</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>ls<span class="w"> </span>/sys/kernel/iommu_groups/<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ 0 (–æ–±—ã—á–Ω–æ 10-30 –≥—Ä—É–ø–ø)</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="c1"># –ï—Å–ª–∏ 0 - AMD-Vi –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ AMD-Vi –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>amd-vi
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="c1"># –î–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å:</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="c1"># AMD-Vi: Interrupt remapping enabled</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="c1"># AMD-Vi: Virtual APIC enabled</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="c1"># (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ &quot;Unknown option&quot; - –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –µ–≥–æ)</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ VFIO –º–æ–¥—É–ª–µ–π</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>vfio
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="c1"># vfio_pci</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="c1"># vfio_iommu_type1</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c1"># vfio</span>
</span></code></pre></div>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong>
- ‚úÖ IOMMU groups &gt; 0
- ‚úÖ AMD-Vi: Interrupt remapping enabled
- ‚úÖ VFIO –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</p>
<p><strong>–ï—Å–ª–∏ IOMMU groups = 0:</strong>
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ <code>dmesg | grep -i ivrs</code> - –µ—Å–ª–∏ –ø—É—Å—Ç–æ, IOMMU –Ω–µ –≤–∫–ª—é—á–µ–Ω –≤ BIOS
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ <code>/proc/cmdline</code> - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å <code>iommu=pt</code>
3. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≠—Ç–∞–ø 1 (BIOS) –∏ 2.1-2.4</p>
<hr />
<h2 id="3-gpu-passthrough">–≠—Ç–∞–ø 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ GPU –¥–ª—è passthrough<a class="headerlink" href="#3-gpu-passthrough" title="Permanent link">&para;</a></h2>
<h3 id="31-gpu">3.1 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ GPU –≤ —Å–∏—Å—Ç–µ–º–µ<a class="headerlink" href="#31-gpu" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>lspci<span class="w"> </span>-nn<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>nvidia
</span></code></pre></div>
<p><strong>–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –¥–ª—è GTX 1050 Ti:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>01:00.0 VGA compatible controller [0300]: NVIDIA Corporation GP107 [GeForce GTX 1050 Ti] [10de:1c82] (rev a1)
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>01:00.1 Audio device [0403]: NVIDIA Corporation GP107GL High Definition Audio Controller [10de:0fb9] (rev a1)
</span></code></pre></div></p>
<p><strong>–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ –¥–ª—è P106-100 (–º–∞–π–Ω–∏–Ω–≥–æ–≤–∞—è –∫–∞—Ä—Ç–∞):</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>06:00.0 3D controller [0302]: NVIDIA Corporation GP106 [P106-100] [10de:1c07] (rev a1)
</span></code></pre></div></p>
<p><strong>–ó–∞–ø–∏—à–∏—Ç–µ:</strong>
- PCI Bus –∞–¥—Ä–µ—Å: <code>01:00.0</code> (GPU), <code>01:00.1</code> (Audio, –µ—Å–ª–∏ –µ—Å—Ç—å)
- Vendor:Device ID: <code>10de:1c82</code> (GPU), <code>10de:0fb9</code> (Audio, –µ—Å–ª–∏ –µ—Å—Ç—å)</p>
<p><strong>‚ö†Ô∏è –í–∞–∂–Ω–æ –¥–ª—è –º–∞–π–Ω–∏–Ω–≥–æ–≤—ã—Ö –∫–∞—Ä—Ç (P106, P104, CMP):</strong>
- –£ –Ω–∏—Ö <strong>–ù–ï–¢ Audio –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞</strong> (01:00.1)
- –£ –Ω–∏—Ö <strong>–ù–ï–¢ –≤–∏–¥–µ–æ–≤—ã—Ö–æ–¥–æ–≤</strong> (HDMI/DisplayPort)
- –≠—Ç–æ <strong>–Ω–æ—Ä–º–∞–ª—å–Ω–æ</strong> - –æ–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è compute –∑–∞–¥–∞—á (Ollama, CUDA)
- –í vfio.conf —É–∫–∞–∑—ã–≤–∞–π—Ç–µ <strong>—Ç–æ–ª—å–∫–æ GPU ID</strong> –±–µ–∑ Audio</p>
<p><strong>–í–∞–∂–Ω–æ:</strong> –í–∞—à–∏ ID –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –∫–∞—Ä—Ç—ã (Asus, MSI, Gigabyte).</p>
<h3 id="32-iommu">3.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ IOMMU –≥—Ä—É–ø–ø—ã<a class="headerlink" href="#32-iommu" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="k">for</span><span class="w"> </span>d<span class="w"> </span><span class="k">in</span><span class="w"> </span>/sys/kernel/iommu_groups/*/devices/*<span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="nv">n</span><span class="o">=</span><span class="si">${</span><span class="nv">d</span><span class="p">#*/iommu_groups/*</span><span class="si">}</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">    </span><span class="nv">n</span><span class="o">=</span><span class="si">${</span><span class="nv">n</span><span class="p">%%/*</span><span class="si">}</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;IOMMU Group %s: &#39;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$n</span><span class="s2">&quot;</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">    </span>lspci<span class="w"> </span>-nns<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">d</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="k">done</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>nvidia
</span></code></pre></div>
<p><strong>–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>IOMMU Group 1: 01:00.0 VGA compatible controller [0300]: NVIDIA Corporation [10de:1c82]
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>IOMMU Group 1: 01:00.1 Audio device [0403]: NVIDIA Corporation [10de:0fb9]
</span></code></pre></div></p>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong> GPU (01:00.0) –∏ Audio (01:00.1) –≤ <strong>–æ–¥–Ω–æ–π</strong> IOMMU –≥—Ä—É–ø–ø–µ.</p>
<p><strong>–ï—Å–ª–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø–∞—Ö:</strong> –ú–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ. –ï—Å–ª–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è ACS override patch (—Å–ª–æ–∂–Ω–æ).</p>
<h3 id="33-blacklist-nvidia">3.3 Blacklist NVIDIA –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –Ω–∞ —Ö–æ—Å—Ç–µ<a class="headerlink" href="#33-blacklist-nvidia" title="Permanent link">&para;</a></h3>
<p>–≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ - —Ö–æ—Å—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—Ç—å GPU, —Ç–æ–ª—å–∫–æ VFIO.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/blacklist-nvidia.conf<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="s">blacklist nouveau</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="s">blacklist nvidia</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="s">blacklist nvidiafb</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="s">EOF</span>
</span></code></pre></div>
<p><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong>
- <code>nouveau</code> - –æ—Ç–∫—Ä—ã—Ç—ã–π –¥—Ä–∞–π–≤–µ—Ä NVIDIA (–±–ª–æ–∫–∏—Ä—É–µ–º)
- <code>nvidia</code> - –ø—Ä–æ–ø—Ä–∏–µ—Ç–∞—Ä–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä (–±–ª–æ–∫–∏—Ä—É–µ–º, —á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª)
- <code>nvidiafb</code> - framebuffer driver</p>
<h3 id="34-gpu-vfio">3.4 –ü—Ä–∏–≤—è–∑–∫–∞ GPU –∫ VFIO<a class="headerlink" href="#34-gpu-vfio" title="Permanent link">&para;</a></h3>
<p><strong>–î–ª—è –æ–±—ã—á–Ω—ã—Ö GTX/RTX –∫–∞—Ä—Ç (—Å Audio):</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;options vfio-pci ids=10de:1c82,10de:0fb9&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/vfio.conf
</span></code></pre></div></p>
<p><strong>–î–ª—è –º–∞–π–Ω–∏–Ω–≥–æ–≤—ã—Ö –∫–∞—Ä—Ç (P106, P104, –±–µ–∑ Audio):</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;options vfio-pci ids=10de:1c07&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/vfio.conf
</span></code></pre></div></p>
<p><strong>–ó–∞–º–µ–Ω–∏—Ç–µ</strong> –Ω–∞ –≤–∞—à–∏ ID –∏–∑ —à–∞–≥–∞ 3.1:
- –ï—Å–ª–∏ —É –≤–∞—Å <strong>–¥–≤–∞</strong> —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (GPU + Audio): —É–∫–∞–∂–∏—Ç–µ –æ–±–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
- –ï—Å–ª–∏ <strong>–æ–¥–Ω–æ</strong> —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (–º–∞–π–Ω–∏–Ω–≥–æ–≤–∞—è –∫–∞—Ä—Ç–∞): —É–∫–∞–∂–∏—Ç–µ —Ç–æ–ª—å–∫–æ GPU ID</p>
<p><strong>–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:</strong> –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã VFIO –∑–∞—Ö–≤–∞—Ç–∏—Ç —ç—Ç–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ <strong>–¥–æ</strong> –∑–∞–≥—Ä—É–∑–∫–∏ –¥—Ä—É–≥–∏—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤.</p>
<h3 id="35">3.5 –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>update-initramfs<span class="w"> </span>-u<span class="w"> </span>-k<span class="w"> </span>all
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>reboot
</span></code></pre></div>
<h3 id="36-gpu-binding">3.6 –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ GPU binding<a class="headerlink" href="#36-gpu-binding" title="Permanent link">&para;</a></h3>
<p>–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>ssh<span class="w"> </span>root@&lt;PROXMOX_IP&gt;
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>lspci<span class="w"> </span>-nnk<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">3</span><span class="w"> </span>-i<span class="w"> </span>nvidia
</span></code></pre></div>
<p><strong>–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –¥–ª—è GTX/RTX (—Å Audio):</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>01:00.0 VGA compatible controller [0300]: NVIDIA Corporation GP107 [GeForce GTX 1050 Ti] [10de:1c82]
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>        Subsystem: Micro-Star International Co., Ltd. [MSI] [1462:8c96]
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>        Kernel driver in use: vfio-pci
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>        Kernel modules: nouveau
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>01:00.1 Audio device [0403]: NVIDIA Corporation GP107GL [10de:0fb9]
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>        Subsystem: Micro-Star International Co., Ltd. [MSI] [1462:8c96]
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>        Kernel driver in use: vfio-pci
</span></code></pre></div></p>
<p><strong>–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –º–∞–π–Ω–∏–Ω–≥–æ–≤—ã—Ö –∫–∞—Ä—Ç (P106, P104):</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>06:00.0 3D controller [0302]: NVIDIA Corporation GP106 [P106-100] [10de:1c07] (rev a1)
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>        Subsystem: ASUSTeK Computer Inc. GP106 [P106-100] [1043:85fc]
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>        Kernel driver in use: vfio-pci
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>        Kernel modules: nvidiafb, nouveau
</span></code></pre></div></p>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong> <code>Kernel driver in use: vfio-pci</code> –¥–ª—è GPU (–∏ Audio, –µ—Å–ª–∏ –µ—Å—Ç—å).</p>
<p><strong>–ï—Å–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <code>nouveau</code> –∏–ª–∏ –Ω–µ—Ç driver:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä—å—Ç–µ vfio.conf</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>cat<span class="w"> </span>/etc/modprobe.d/vfio.conf
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>vfio_pci
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a><span class="c1"># –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ initramfs</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>update-initramfs<span class="w"> </span>-u<span class="w"> </span>-k<span class="w"> </span>all
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>reboot
</span></code></pre></div></p>
<hr />
<h2 id="4-ubuntu-server-iso">–≠—Ç–∞–ø 4: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ Ubuntu Server ISO<a class="headerlink" href="#4-ubuntu-server-iso" title="Permanent link">&para;</a></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="nb">cd</span><span class="w"> </span>/var/lib/vz/template/iso
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="c1"># Ubuntu 22.04.5 LTS (–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>wget<span class="w"> </span>https://releases.ubuntu.com/22.04.5/ubuntu-22.04.5-live-server-amd64.iso
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>wget<span class="w"> </span>https://releases.ubuntu.com/22.04.5/SHA256SUMS
</span><span id="__span-30-8"><a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>sha256sum<span class="w"> </span>-c<span class="w"> </span>SHA256SUMS<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>ubuntu-22.04.5-live-server-amd64.iso
</span><span id="__span-30-9"><a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>
</span><span id="__span-30-10"><a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞</span>
</span><span id="__span-30-11"><a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>ls<span class="w"> </span>-lh<span class="w"> </span>ubuntu-22.04.5-live-server-amd64.iso
</span><span id="__span-30-12"><a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ~2.5-2.7GB</span>
</span></code></pre></div>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong> ISO —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω –≤ <code>/var/lib/vz/template/iso/</code></p>
<hr />
<h2 id="45">–≠—Ç–∞–ø 4.5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏ –Ω–∞ —Ö–æ—Å—Ç–µ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)<a class="headerlink" href="#45" title="Permanent link">&para;</a></h2>
<p><strong>–ü–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º VM –ø—Ä–æ–≤–µ—Ä—å—Ç–µ RAM –Ω–∞ Proxmox —Ö–æ—Å—Ç–µ:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>free<span class="w"> </span>-h
</span></code></pre></div>
<p><strong>–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>              total        used        free      shared  buff/cache   available
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>Mem:           15Gi        2.0Gi        12Gi        10Mi         1.2Gi        13Gi
</span></code></pre></div></p>
<h3 id="ram-vm">üìä –†–∞—Å—á–µ—Ç RAM –¥–ª—è VM:<a class="headerlink" href="#ram-vm" title="Permanent link">&para;</a></h3>
<p><strong>–§–æ—Ä–º—É–ª–∞:</strong> <code>RAM –¥–ª—è VM = Total RAM —Ö–æ—Å—Ç–∞ - 2GB (–¥–ª—è Proxmox) - –∑–∞–ø–∞—Å 1GB</code></p>
<p><strong>–ü—Ä–∏–º–µ—Ä—ã:</strong>
- <strong>16GB —Ö–æ—Å—Ç:</strong> VM –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥–æ 13GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 10-12GB)
- <strong>8GB —Ö–æ—Å—Ç:</strong> VM –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥–æ 5GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4-6GB) ‚ö†Ô∏è
- <strong>32GB —Ö–æ—Å—Ç:</strong> VM –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥–æ 29GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 16-24GB)</p>
<h3 id="_1">‚ö†Ô∏è –î–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p><strong>–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ:</strong>
- <strong>RAM —Ö–æ—Å—Ç–∞:</strong> 8GB –º–∏–Ω–∏–º—É–º
- <strong>RAM VM:</strong> 8GB (–¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å Ollama)</p>
<p><strong>–ï—Å–ª–∏ —É –≤–∞—Å –º–µ–Ω—å—à–µ 10GB –Ω–∞ —Ö–æ—Å—Ç–µ:</strong>
- –£–º–µ–Ω—å—à–∏—Ç–µ RAM VM –¥–æ 4-6GB
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–µ–±–æ–ª—å—à–∏–µ –º–æ–¥–µ–ª–∏ (phi3:mini, llama3.2:3b)
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏—è RAM —Ö–æ—Å—Ç–∞</p>
<p><strong>–ù–∞—à –ø—Ä–∏–º–µ—Ä (AMD Ryzen 5 2600 + 8GB):</strong>
- <strong>–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</strong> 7.7GB RAM ‚Üí VM —Å 6GB RAM
- <strong>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:</strong> 16GB RAM ‚Üí VM —Å 10-12GB RAM
- <strong>–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</strong> –°–º–æ–∂–µ–º –∑–∞–ø—É—Å–∫–∞—Ç—å –º–æ–¥–µ–ª–∏ –¥–æ llama3.1:8b</p>
<h3 id="_2">üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>–í –¥–∞–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ö–æ—Å—Ç —Å 8GB RAM (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∂–µ–ª–µ–∑–∞). VM –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ 6GB RAM —Å –º–æ–¥–µ–ª—å—é phi3:mini (2.3GB). <strong>–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ RAM —Ö–æ—Å—Ç–∞ –¥–æ 16GB</strong> –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—Å–∫–∞ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (llama3.1:8b, qwen2.5:7b).</p>
<hr />
<h2 id="5-vm-proxmox-web-ui">–≠—Ç–∞–ø 5: –°–æ–∑–¥–∞–Ω–∏–µ VM —á–µ—Ä–µ–∑ Proxmox Web UI<a class="headerlink" href="#5-vm-proxmox-web-ui" title="Permanent link">&para;</a></h2>
<h3 id="51-vm">5.1 –ó–∞–ø—É—Å–∫ –º–∞—Å—Ç–µ—Ä–∞ —Å–æ–∑–¥–∞–Ω–∏—è VM<a class="headerlink" href="#51-vm" title="Permanent link">&para;</a></h3>
<p>Proxmox Web UI ‚Üí –ø—Ä–∞–≤—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É–≥–æ–ª ‚Üí <strong>Create VM</strong></p>
<h3 id="52-general-1">5.2 General (–≤–∫–ª–∞–¥–∫–∞ 1)<a class="headerlink" href="#52-general-1" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Node:</strong> –≤–∞—à Proxmox node</li>
<li><strong>VM ID:</strong> <code>300</code> (–∏–ª–∏ –ª—é–±–æ–π —Å–≤–æ–±–æ–¥–Ω—ã–π, –∑–∞–ø–æ–º–Ω–∏—Ç–µ –µ–≥–æ)</li>
<li><strong>Name:</strong> <code>ollama-vm</code></li>
<li><strong>Resource Pool:</strong> (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º)</li>
<li><strong>Start at boot:</strong> ‚úÖ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</li>
</ul>
<p>–ù–∞–∂–º–∏—Ç–µ <strong>Next</strong></p>
<h3 id="53-os-2">5.3 OS (–≤–∫–ª–∞–¥–∫–∞ 2)<a class="headerlink" href="#53-os-2" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Use CD/DVD disc image file (ISO)</strong></li>
<li><strong>Storage:</strong> <code>local</code></li>
<li><strong>ISO image:</strong> <code>ubuntu-22.04.5-live-server-amd64.iso</code></li>
<li><strong>Type:</strong> <code>Linux</code></li>
<li><strong>Version:</strong> <code>6.x - 2.6 Kernel</code></li>
</ul>
<p>–ù–∞–∂–º–∏—Ç–µ <strong>Next</strong></p>
<h3 id="54-system-3-">5.4 System (–≤–∫–ª–∞–¥–∫–∞ 3) - –ö–†–ò–¢–ò–ß–ù–û!<a class="headerlink" href="#54-system-3-" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Graphic card:</strong> <code>Default</code></li>
<li><strong>Machine:</strong> <code>q35</code> ‚Üê <strong>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è PCIe passthrough</strong></li>
<li><strong>BIOS:</strong> <code>OVMF (UEFI)</code> ‚Üê <strong>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è GPU</strong></li>
<li><strong>Add EFI Disk:</strong> ‚úÖ Yes</li>
<li><strong>EFI Storage:</strong> <code>local-lvm</code></li>
<li><strong>Pre-Enroll keys:</strong> ‚ùå No (–æ—Ç–∫–ª—é—á–∏—Ç–µ Secure Boot)</li>
<li><strong>SCSI Controller:</strong> <code>VirtIO SCSI single</code></li>
<li><strong>Qemu Agent:</strong> ‚úÖ Yes (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ)</li>
</ul>
<p><strong>–ü–æ—á–µ–º—É q35 –∏ OVMF:</strong>
- q35 - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è machine type —Å PCIe support
- OVMF (UEFI) - —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ GPU passthrough
- Secure Boot –æ—Ç–∫–ª—é—á–µ–Ω - NVIDIA –¥—Ä–∞–π–≤–µ—Ä—ã unsigned</p>
<p>–ù–∞–∂–º–∏—Ç–µ <strong>Next</strong></p>
<h3 id="55-disks-4">5.5 Disks (–≤–∫–ª–∞–¥–∫–∞ 4)<a class="headerlink" href="#55-disks-4" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Bus/Device:</strong> <code>VirtIO Block 0</code></li>
<li><strong>Storage:</strong> <code>local-lvm</code> (–∏–ª–∏ –≤–∞—à–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)</li>
<li><strong>Disk size (GiB):</strong> <code>50</code></li>
<li><strong>Cache:</strong> <code>Default (No cache)</code></li>
<li><strong>Discard:</strong> ‚úÖ (–µ—Å–ª–∏ SSD)</li>
<li><strong>SSD emulation:</strong> ‚úÖ (–µ—Å–ª–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ SSD)</li>
</ul>
<p>–ù–∞–∂–º–∏—Ç–µ <strong>Next</strong></p>
<h3 id="56-cpu-5-">5.6 CPU (–≤–∫–ª–∞–¥–∫–∞ 5) - –ö–†–ò–¢–ò–ß–ù–û!<a class="headerlink" href="#56-cpu-5-" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Sockets:</strong> <code>1</code></li>
<li><strong>Cores:</strong> <code>4</code> (–º–∏–Ω–∏–º—É–º 2, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4)</li>
<li><strong>Type:</strong> <code>host</code> ‚Üê <strong>–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è GPU –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</strong></li>
<li><strong>Extra CPU Flags:</strong> (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º)</li>
</ul>
<p><strong>–ü–æ—á–µ–º—É host:</strong>
- –ü—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ —Ö–æ—Å—Ç–∞ –≤ VM
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è CUDA –∏ GPU compute
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</p>
<p>–ù–∞–∂–º–∏—Ç–µ <strong>Next</strong></p>
<h3 id="57-memory-6">5.7 Memory (–≤–∫–ª–∞–¥–∫–∞ 6)<a class="headerlink" href="#57-memory-6" title="Permanent link">&para;</a></h3>
<p>‚ö†Ô∏è <strong>–í—ã–±–µ—Ä–∏—Ç–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç RAM —Ö–æ—Å—Ç–∞ (—Å–º. –≠—Ç–∞–ø 4.5):</strong></p>
<p><strong>–ï—Å–ª–∏ RAM —Ö–æ—Å—Ç–∞ &gt;= 16GB:</strong>
- <strong>Memory (MiB):</strong> <code>8192</code> (8GB, –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è Ollama)
- <strong>Minimum memory (MiB):</strong> <code>8192</code></p>
<p><strong>–ï—Å–ª–∏ RAM —Ö–æ—Å—Ç–∞ 8-10GB:</strong>
- <strong>Memory (MiB):</strong> <code>6144</code> (6GB, –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π)
- <strong>Minimum memory (MiB):</strong> <code>6144</code></p>
<p><strong>–ï—Å–ª–∏ RAM —Ö–æ—Å—Ç–∞ &gt;= 32GB:</strong>
- <strong>Memory (MiB):</strong> <code>12288</code> (12GB, –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π 8B+)
- <strong>Minimum memory (MiB):</strong> <code>12288</code></p>
<ul>
<li><strong>Ballooning Device:</strong> ‚ùå Uncheck (–æ—Ç–∫–ª—é—á–∏—Ç–µ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)</li>
</ul>
<p><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ (8GB —Ö–æ—Å—Ç) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 6GB –¥–ª—è VM.</p>
<p>–ù–∞–∂–º–∏—Ç–µ <strong>Next</strong></p>
<h3 id="58-network-7">5.8 Network (–≤–∫–ª–∞–¥–∫–∞ 7)<a class="headerlink" href="#58-network-7" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Bridge:</strong> <code>vmbr0</code> (–≤–∞—à –æ—Å–Ω–æ–≤–Ω–æ–π bridge)</li>
<li><strong>VLAN Tag:</strong> (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º)</li>
<li><strong>Model:</strong> <code>VirtIO (paravirtualized)</code></li>
<li><strong>MAC address:</strong> (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)</li>
<li><strong>Firewall:</strong> ‚úÖ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</li>
</ul>
<p>–ù–∞–∂–º–∏—Ç–µ <strong>Next</strong></p>
<h3 id="59-confirm-8">5.9 Confirm (–≤–∫–ª–∞–¥–∫–∞ 8)<a class="headerlink" href="#59-confirm-8" title="Permanent link">&para;</a></h3>
<p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
- Machine: q35
- BIOS: OVMF
- CPU Type: host
- Memory: 8192 MB</p>
<p>‚úÖ <strong>Start after created</strong> - —Å–Ω–∏–º–∏—Ç–µ –≥–∞–ª–æ—á–∫—É! (–Ω–∞—Å—Ç—Ä–æ–∏–º GPU —Å–Ω–∞—á–∞–ª–∞)</p>
<p>–ù–∞–∂–º–∏—Ç–µ <strong>Finish</strong></p>
<p>VM —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ <strong>–ù–ï –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –µ—ë!</strong></p>
<hr />
<h2 id="6-gpu-vm">–≠—Ç–∞–ø 6: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ GPU –≤ VM<a class="headerlink" href="#6-gpu-vm" title="Permanent link">&para;</a></h2>
<h3 id="61-pci-web-ui">6.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ PCI —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ Web UI<a class="headerlink" href="#61-pci-web-ui" title="Permanent link">&para;</a></h3>
<p>–í—ã–±–µ—Ä–∏—Ç–µ VM 300 ‚Üí <strong>Hardware</strong></p>
<h4 id="611-gpu">6.1.1 –î–æ–±–∞–≤–ª–µ–Ω–∏–µ GPU<a class="headerlink" href="#611-gpu" title="Permanent link">&para;</a></h4>
<ol>
<li>–ù–∞–∂–º–∏—Ç–µ <strong>Add</strong> ‚Üí <strong>PCI Device</strong></li>
<li><strong>Raw Device:</strong> –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à—É NVIDIA GPU (01:00.0 –∏–ª–∏ 06:00.0)</li>
<li>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≥–∞–ª–æ—á–∫–∏:</li>
<li>‚úÖ <strong>All Functions</strong> (–≤–∞–∂–Ω–æ - –∑–∞—Ö–≤–∞—Ç–∏—Ç GPU –∏ Audio –≤–º–µ—Å—Ç–µ, –µ—Å–ª–∏ –µ—Å—Ç—å Audio)</li>
<li>‚úÖ <strong>Primary GPU</strong> (–µ—Å–ª–∏ —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è GPU –≤ —Å–∏—Å—Ç–µ–º–µ)</li>
<li>‚úÖ <strong>PCI-Express</strong> (–¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)</li>
<li>‚úÖ <strong>ROM-Bar</strong> (–æ–±—ã—á–Ω–æ –Ω—É–∂–µ–Ω)</li>
<li>–ù–∞–∂–º–∏—Ç–µ <strong>Add</strong></li>
</ol>
<p>‚ö†Ô∏è <strong>–í–∞–∂–Ω–æ –¥–ª—è –º–∞–π–Ω–∏–Ω–≥–æ–≤—ã—Ö –∫–∞—Ä—Ç (P106, P104, CMP):</strong>
- –£ –Ω–∏—Ö –Ω–µ—Ç Audio –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞, –ø–æ—ç—Ç–æ–º—É "All Functions" –∑–∞—Ö–≤–∞—Ç–∏—Ç —Ç–æ–ª—å–∫–æ GPU
- <strong>–ù–ï –≤–∫–ª—é—á–∞–π—Ç–µ x-vga=1</strong> - —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—É—Å–∫–æ–º VM
- –î–ª—è –æ–±—ã—á–Ω—ã—Ö GTX/RTX –∫–∞—Ä—Ç x-vga=1 –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å</p>
<p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ —Å–ø–∏—Å–∫–µ Hardware:
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>PCI Device (hostpci0): 0000:01:00, All Functions
</span></code></pre></div>
–ò–ª–∏ –¥–ª—è P106:
<div class="language-text highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>PCI Device (hostpci0): 0000:06:00, All Functions
</span></code></pre></div></p>
<h3 id="62-vm">6.2 –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è VM (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)<a class="headerlink" href="#62-vm" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>nano<span class="w"> </span>/etc/pve/qemu-server/300.conf
</span></code></pre></div>
<p><strong>‚ö†Ô∏è –í–∞–∂–Ω–æ –ø—Ä–∏ —Ä—É—á–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:</strong>
1. Proxmox Web UI —É–∂–µ —Å–æ–∑–¥–∞–ª —Å—Ç—Ä–æ–∫—É <code>cpu: host</code>
2. –í—ã –¥–æ–±–∞–≤–∏—Ç–µ —É–ª—É—á—à–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é <code>cpu: host,hidden=1,flags=+pcid</code>
3. <strong>–£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—É—é —Å—Ç—Ä–æ–∫—É</strong> <code>cpu: host</code> (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
4. –û—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–æ–≤—É—é —Å—Ç—Ä–æ–∫—É —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</p>
<p>–ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫—É <code>cpu: host</code> (–±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤) –∏ <strong>–∑–∞–º–µ–Ω–∏—Ç–µ –µ—ë</strong> –Ω–∞:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>cpu: host,hidden=1,flags=+pcid
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>args: -cpu host,kvm=off
</span></code></pre></div>
<p><strong>–ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–≤—É—Ö —Å—Ç—Ä–æ–∫ cpu!</strong></p>
<p><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong>
- <code>hidden=1</code> - —Å–∫—Ä—ã–≤–∞–µ—Ç –æ—Ç VM —á—Ç–æ –æ–Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ NVIDIA –¥—Ä–∞–π–≤–µ—Ä—ã —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç)
- <code>kvm=off</code> - —Å–∫—Ä—ã–≤–∞–µ—Ç KVM signature (–¥–ª—è NVIDIA driver detection)
- <code>+pcid</code> - Process-Context Identifiers (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)</p>
<p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X</p>
<p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>cat<span class="w"> </span>/etc/pve/qemu-server/300.conf<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;^cpu:&quot;</span>
</span></code></pre></div></p>
<p>–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å <strong>—Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞</strong> —Å—Ç—Ä–æ–∫–∞ —Å cpu!</p>
<p><strong>–§–∞–π–ª –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>bootdisk: scsi0
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>cores: 4
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>cpu: host,hidden=1,flags=+pcid
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>args: -cpu host,kvm=off
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>efidisk0: local-lvm:vm-300-disk-0,efitype=4m,size=4M
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>hostpci0: 0000:01:00,pcie=1,x-vga=1
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>memory: 8192
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>meta: creation-qemu=8.1.5,ctime=1728600000
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>name: ollama-vm
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>net0: virtio=XX:XX:XX:XX:XX:XX,bridge=vmbr0
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a>numa: 0
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a>ostype: l26
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a>scsi0: local-lvm:vm-300-disk-1,iothread=1,size=50G
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a>scsihw: virtio-scsi-single
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>smbios1: uuid=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>sockets: 1
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a>vmgenid: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
</span></code></pre></div>
<hr />
<h2 id="7-ubuntu-server-vm">–≠—Ç–∞–ø 7: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ubuntu Server –≤ VM<a class="headerlink" href="#7-ubuntu-server-vm" title="Permanent link">&para;</a></h2>
<h3 id="71-vm">7.1 –ó–∞–ø—É—Å–∫ VM<a class="headerlink" href="#71-vm" title="Permanent link">&para;</a></h3>
<p>Proxmox Web UI ‚Üí VM 300 ‚Üí <strong>Start</strong></p>
<p>–ó–∞—Ç–µ–º ‚Üí <strong>Console</strong> (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è noVNC)</p>
<p>–ü–æ–¥–æ–∂–¥–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏ Ubuntu installer (~30 —Å–µ–∫—É–Ω–¥).</p>
<h3 id="72-ubuntu-installation-wizard">7.2 Ubuntu Installation Wizard<a class="headerlink" href="#72-ubuntu-installation-wizard" title="Permanent link">&para;</a></h3>
<p><strong>Language:</strong>
- English (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è troubleshooting)</p>
<p><strong>Keyboard configuration:</strong>
- Layout: English (US) –∏–ª–∏ Russian
- Variant: English (US)</p>
<p><strong>Network connections:</strong>
- –û—Å—Ç–∞–≤—å—Ç–µ DHCP (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç IP)
- –ó–∞–ø–æ–º–Ω–∏—Ç–µ –ø–æ–∫–∞–∑–∞–Ω–Ω—ã–π IP –∞–¥—Ä–µ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä: 192.168.1.150)</p>
<p><strong>Configure proxy:</strong>
- –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º</p>
<p><strong>Configure Ubuntu archive mirror:</strong>
- –û—Å—Ç–∞–≤—å—Ç–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é</p>
<p><strong>Guided storage configuration:</strong>
- ‚úÖ Use an entire disk
- Disk: <code>/dev/sda</code> (50GB VirtIO disk)
- ‚ùå Set up this disk as an LVM group (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)</p>
<p><strong>Storage configuration:</strong>
- –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ç–∫—É
- Continue (–ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ)</p>
<p><strong>Profile setup:</strong>
- Your name: <code>Administrator</code>
- Your server's name: <code>ollama-vm</code>
- Pick a username: <code>admin</code> (–∏–ª–∏ –¥—Ä—É–≥–æ–µ)
- Choose a password: <code>&lt;–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å&gt;</code>
- Confirm your password: <code>&lt;–Ω–∞–¥–µ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å&gt;</code></p>
<p><strong>Upgrade to Ubuntu Pro:</strong>
- Skip for now</p>
<p><strong>SSH Setup:</strong>
- ‚úÖ Install OpenSSH server (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- ‚ùå Import SSH identity (–Ω–µ –Ω—É–∂–Ω–æ)</p>
<p><strong>Featured Server Snaps:</strong>
- –ù–∏—á–µ–≥–æ –Ω–µ –≤—ã–±–∏—Ä–∞–π—Ç–µ (—É—Å—Ç–∞–Ω–æ–≤–∏–º –ø–æ–∑–∂–µ —á—Ç–æ –Ω—É–∂–Ω–æ)</p>
<p>–ù–∞—á–Ω–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (~5-10 –º–∏–Ω—É—Ç).</p>
<h3 id="73">7.3 –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<p>–ö–æ–≥–¥–∞ —É–≤–∏–¥–∏—Ç–µ <strong>"Reboot Now"</strong>:</p>
<ol>
<li>–ù–∞–∂–º–∏—Ç–µ <strong>Reboot Now</strong></li>
<li>VM –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è</li>
<li>–î–æ–∂–¥–∏—Ç–µ—Å—å login prompt</li>
</ol>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong> –í–∏–¥–∏—Ç–µ <code>ollama-vm login:</code></p>
<hr />
<h2 id="8-ubuntu-vm">–≠—Ç–∞–ø 8: –ü–µ—Ä–≤–∏—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Ubuntu VM<a class="headerlink" href="#8-ubuntu-vm" title="Permanent link">&para;</a></h2>
<h3 id="81-ssh">8.1 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH<a class="headerlink" href="#81-ssh" title="Permanent link">&para;</a></h3>
<p>–° –≤–∞—à–µ–π —Ä–∞–±–æ—á–µ–π –º–∞—à–∏–Ω—ã:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>ssh<span class="w"> </span>admin@&lt;VM_IP&gt;
</span></code></pre></div>
<p>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å —Å–æ–∑–¥–∞–Ω–Ω—ã–π –Ω–∞ —à–∞–≥–µ 7.2.</p>
<p><strong>–ï—Å–ª–∏ SSH –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong>
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ IP: –≤ Proxmox Web UI ‚Üí VM 300 ‚Üí Summary ‚Üí IPs
- –ò–ª–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å –≤ VM: <code>ip addr show</code></p>
<h3 id="82">8.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
</span></code></pre></div>
<p>–ï—Å–ª–∏ —Å–ø—Ä–æ—Å–∏—Ç –æ restart services - –≤—ã–±–µ—Ä–∏—Ç–µ <strong>Yes</strong> –∏ <strong>OK</strong> –¥–ª—è –≤—Å–µ—Ö.</p>
<h3 id="83">8.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö —É—Ç–∏–ª–∏—Ç<a class="headerlink" href="#83" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>wget<span class="w"> </span>git<span class="w"> </span>build-essential
</span></code></pre></div>
<h3 id="84-gpu">8.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ GPU<a class="headerlink" href="#84-gpu" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>lspci<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>nvidia
</span></code></pre></div>
<p><strong>–î–æ–ª–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>00:10.0 VGA compatible controller: NVIDIA Corporation GP107 [GeForce GTX 1050 Ti]
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>00:10.1 Audio device: NVIDIA Corporation GP107GL High Definition Audio Controller
</span></code></pre></div></p>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong> GPU –≤–∏–¥–µ–Ω –≤ VM (PCI –∞–¥—Ä–µ—Å –±—É–¥–µ—Ç –¥—Ä—É–≥–æ–π, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ).</p>
<p><strong>–ï—Å–ª–∏ GPU –Ω–µ –≤–∏–¥–µ–Ω:</strong>
- –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ Proxmox Web UI ‚Üí VM 300 ‚Üí Hardware
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ PCI Device –¥–æ–±–∞–≤–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ VM –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–∫–ª—é—á–µ–Ω–∞ (Shutdown) –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ Hardware
- Restart VM</p>
<hr />
<h2 id="9-nvidia-ubuntu-vm">–≠—Ç–∞–ø 9: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NVIDIA –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –≤ Ubuntu VM<a class="headerlink" href="#9-nvidia-ubuntu-vm" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–≥–æ –¥—Ä–∞–π–≤–µ—Ä–∞<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>sudo<span class="w"> </span>ubuntu-drivers<span class="w"> </span>devices
</span></code></pre></div>
<p><strong>–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>== /sys/devices/pci0000:00/0000:00:10.0 ==
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>modalias : pci:v000010DEd00001C82sv00001462sd00008C96bc03sc00i00
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>vendor   : NVIDIA Corporation
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>model    : GP107 [GeForce GTX 1050 Ti]
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>driver   : nvidia-driver-535 - distro non-free recommended
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>driver   : nvidia-driver-545 - third-party non-free
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>driver   : nvidia-driver-470 - distro non-free
</span></code></pre></div></p>
<p><strong>Recommended:</strong> <code>nvidia-driver-535</code> (–∏–ª–∏ –Ω–æ–≤–µ–µ)</p>
<h3 id="92-nvidia">9.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ NVIDIA –¥—Ä–∞–π–≤–µ—Ä–∞<a class="headerlink" href="#92-nvidia" title="Permanent link">&para;</a></h3>
<p><strong>–í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>sudo<span class="w"> </span>ubuntu-drivers<span class="w"> </span>autoinstall
</span></code></pre></div>
<p>–≠—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç recommended –≤–µ—Ä—Å–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.</p>
<p><strong>–í–∞—Ä–∏–∞–Ω—Ç B: –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>nvidia-driver-535<span class="w"> </span>nvidia-utils-535
</span></code></pre></div>
<p>–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–π–º–µ—Ç 3-5 –º–∏–Ω—É—Ç (—Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è ~500MB –ø–∞–∫–µ—Ç–æ–≤).</p>
<h3 id="93-vm">9.3 –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ VM<a class="headerlink" href="#93-vm" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>sudo<span class="w"> </span>reboot
</span></code></pre></div>
<p>–ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã.</p>
<h3 id="94-nvidia">9.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ NVIDIA –¥—Ä–∞–π–≤–µ—Ä–∞<a class="headerlink" href="#94-nvidia" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>ssh<span class="w"> </span>admin@&lt;VM_IP&gt;
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a>nvidia-smi
</span></code></pre></div>
<p><strong>–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>Fri Oct 11 01:00:00 2025
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>+-----------------------------------------------------------------------------------------+
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>| NVIDIA-SMI 535.183.01             Driver Version: 535.183.01   CUDA Version: 12.2     |
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>|-----------------------------------------+------------------------+----------------------+
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>| GPU  Name                 Persistence-M | Bus-Id        Disp.A  | Volatile Uncorr. ECC |
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage  | GPU-Util  Compute M. |
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>|                                         |                       |               MIG M. |
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>|=========================================+========================+======================|
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>|   0  NVIDIA GeForce GTX 1050 Ti     Off | 00000000:00:10.0  Off |                  N/A |
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>| 40%   35C    P0              N/A /  75W |      0MiB /  4096MiB  |      0%      Default |
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>|                                         |                       |                  N/A |
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a>+-----------------------------------------+------------------------+----------------------+
</span></code></pre></div></p>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong>
- –í–∏–¥–Ω–∞ –º–æ–¥–µ–ª—å GPU: GeForce GTX 1050 Ti
- Driver Version: 535.xxx –∏–ª–∏ –Ω–æ–≤–µ–µ
- CUDA Version: 12.x
- Memory: 4096 MiB</p>
<p><strong>–ï—Å–ª–∏ –æ—à–∏–±–∫–∞ "NVIDIA-SMI has failed":</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>dpkg<span class="w"> </span>-l<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>nvidia-driver
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="c1"># –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>--reinstall<span class="w"> </span>nvidia-driver-535
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª—è</span>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>nvidia
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>
</span><span id="__span-51-10"><a id="__codelineno-51-10" name="__codelineno-51-10" href="#__codelineno-51-10"></a><span class="c1"># –ï—Å–ª–∏ –º–æ–¥—É–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</span>
</span><span id="__span-51-11"><a id="__codelineno-51-11" name="__codelineno-51-11" href="#__codelineno-51-11"></a>sudo<span class="w"> </span>modprobe<span class="w"> </span>nvidia
</span><span id="__span-51-12"><a id="__codelineno-51-12" name="__codelineno-51-12" href="#__codelineno-51-12"></a>nvidia-smi
</span></code></pre></div></p>
<hr />
<h2 id="10-ollama">–≠—Ç–∞–ø 10: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Ollama<a class="headerlink" href="#10-ollama" title="Permanent link">&para;</a></h2>
<h3 id="101-ollama">10.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama<a class="headerlink" href="#101-ollama" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="c1"># –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π install script</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://ollama.ai/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
</span></code></pre></div>
<p><strong>–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:</strong>
1. –°–∫–∞—á–∏–≤–∞–µ—Ç –±–∏–Ω–∞—Ä–Ω–∏–∫ Ollama
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤ <code>/usr/local/bin/ollama</code>
3. –°–æ–∑–¥–∞–µ—Ç systemd unit <code>/etc/systemd/system/ollama.service</code>
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å</p>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>ollama<span class="w"> </span>--version
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="c1"># –í—ã–≤–æ–¥: ollama version is 0.x.x</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a>systemctl<span class="w"> </span>status<span class="w"> </span>ollama.service
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="c1"># –í—ã–≤–æ–¥: active (running)</span>
</span></code></pre></div></p>
<h3 id="102-api">10.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ API<a class="headerlink" href="#102-api" title="Permanent link">&para;</a></h3>
<p>–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Ollama —Å–ª—É—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ 127.0.0.1. –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∏–∑ n8n –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞ 0.0.0.0.</p>
<p><strong>‚ö†Ô∏è –í–∞–∂–Ω–æ:</strong> –ï—Å–ª–∏ <code>systemctl edit</code> –Ω–µ —Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, —Å–æ–∑–¥–∞–¥–∏–º –≤—Ä—É—á–Ω—É—é.</p>
<h4 id="a-systemctl-edit">–í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ systemctl edit (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):<a class="headerlink" href="#a-systemctl-edit" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>edit<span class="w"> </span>ollama.service
</span></code></pre></div>
<p>–û—Ç–∫—Ä–æ–µ—Ç—Å—è —Ä–µ–¥–∞–∫—Ç–æ—Ä. –î–æ–±–∞–≤—å—Ç–µ <strong>—Ç–æ–ª—å–∫–æ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏</strong> (–º–µ–∂–¥—É –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏):</p>
<div class="language-ini highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="k">[Service]</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="na">Environment</span><span class="o">=</span><span class="s">&quot;OLLAMA_HOST=0.0.0.0:11434&quot;</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="na">Environment</span><span class="o">=</span><span class="s">&quot;OLLAMA_ORIGINS=*&quot;</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="na">Environment</span><span class="o">=</span><span class="s">&quot;CUDA_VISIBLE_DEVICES=0&quot;</span>
</span></code></pre></div>
<p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X</p>
<h4 id="b-a">–í–∞—Ä–∏–∞–Ω—Ç B: –ï—Å–ª–∏ –í–∞—Ä–∏–∞–Ω—Ç A –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Ñ–∞–π–ª –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è):<a class="headerlink" href="#b-a" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>sudo<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/etc/systemd/system/ollama.service.d
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>sudo<span class="w"> </span>nano<span class="w"> </span>/etc/systemd/system/ollama.service.d/override.conf
</span></code></pre></div>
<p>–î–æ–±–∞–≤—å—Ç–µ:
<div class="language-ini highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="k">[Service]</span>
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a><span class="na">Environment</span><span class="o">=</span><span class="s">&quot;OLLAMA_HOST=0.0.0.0:11434&quot;</span>
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a><span class="na">Environment</span><span class="o">=</span><span class="s">&quot;OLLAMA_ORIGINS=*&quot;</span>
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a><span class="na">Environment</span><span class="o">=</span><span class="s">&quot;CUDA_VISIBLE_DEVICES=0&quot;</span>
</span></code></pre></div></p>
<p>–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: Ctrl+O, Enter, Ctrl+X</p>
<p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>sudo<span class="w"> </span>cat<span class="w"> </span>/etc/systemd/system/ollama.service.d/override.conf
</span></code></pre></div></p>
<p>–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å 4 —Å—Ç—Ä–æ–∫–∏ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏.</p>
<p><strong>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:</strong>
- <code>OLLAMA_HOST=0.0.0.0:11434</code> - —Å–ª—É—à–∞—Ç—å –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö
- <code>OLLAMA_ORIGINS=*</code> - —Ä–∞–∑—Ä–µ—à–∏—Ç—å CORS –¥–ª—è –ª—é–±—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- <code>CUDA_VISIBLE_DEVICES=0</code> - —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GPU 0</p>
<p>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>ollama.service
</span></code></pre></div>
<p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>sudo<span class="w"> </span>ss<span class="w"> </span>-tlnp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">11434</span>
</span></code></pre></div></p>
<p><strong>–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:</strong> <code>*:11434</code> –∏–ª–∏ <code>0.0.0.0:11434</code> (–ù–ï 127.0.0.1:11434)</p>
<h3 id="103-api-endpoint">10.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoint<a class="headerlink" href="#103-api-endpoint" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="c1"># –õ–æ–∫–∞–ª—å–Ω–æ –≤ VM</span>
</span><span id="__span-61-2"><a id="__codelineno-61-2" name="__codelineno-61-2" href="#__codelineno-61-2"></a>curl<span class="w"> </span>http://localhost:11434/api/tags
</span><span id="__span-61-3"><a id="__codelineno-61-3" name="__codelineno-61-3" href="#__codelineno-61-3"></a>
</span><span id="__span-61-4"><a id="__codelineno-61-4" name="__codelineno-61-4" href="#__codelineno-61-4"></a><span class="c1"># –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å:</span>
</span><span id="__span-61-5"><a id="__codelineno-61-5" name="__codelineno-61-5" href="#__codelineno-61-5"></a><span class="c1"># {&quot;models&quot;:[]}</span>
</span></code></pre></div>
<p>–° Proxmox —Ö–æ—Å—Ç–∞ –∏–ª–∏ –≤–∞—à–µ–π —Ä–∞–±–æ—á–µ–π –º–∞—à–∏–Ω—ã:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>curl<span class="w"> </span>http://&lt;VM_IP&gt;:11434/api/tags
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a><span class="c1"># –î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Ç–æ—Ç –∂–µ JSON</span>
</span></code></pre></div>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong> API –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ —Å–µ—Ç–∏.</p>
<p><strong>–ï—Å–ª–∏ Connection refused:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–µ—Ä–≤–∏—Å —Å–ª—É—à–∞–µ—Ç –Ω–∞ 0.0.0.0</span>
</span><span id="__span-63-2"><a id="__codelineno-63-2" name="__codelineno-63-2" href="#__codelineno-63-2"></a>sudo<span class="w"> </span>ss<span class="w"> </span>-tlnp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">11434</span>
</span><span id="__span-63-3"><a id="__codelineno-63-3" name="__codelineno-63-3" href="#__codelineno-63-3"></a>
</span><span id="__span-63-4"><a id="__codelineno-63-4" name="__codelineno-63-4" href="#__codelineno-63-4"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 0.0.0.0:11434 (–Ω–µ 127.0.0.1)</span>
</span><span id="__span-63-5"><a id="__codelineno-63-5" name="__codelineno-63-5" href="#__codelineno-63-5"></a>
</span><span id="__span-63-6"><a id="__codelineno-63-6" name="__codelineno-63-6" href="#__codelineno-63-6"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è</span>
</span><span id="__span-63-7"><a id="__codelineno-63-7" name="__codelineno-63-7" href="#__codelineno-63-7"></a>systemctl<span class="w"> </span>show<span class="w"> </span>ollama.service<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>Environment
</span><span id="__span-63-8"><a id="__codelineno-63-8" name="__codelineno-63-8" href="#__codelineno-63-8"></a>
</span><span id="__span-63-9"><a id="__codelineno-63-9" name="__codelineno-63-9" href="#__codelineno-63-9"></a><span class="c1"># –î–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å: OLLAMA_HOST=0.0.0.0:11434</span>
</span><span id="__span-63-10"><a id="__codelineno-63-10" name="__codelineno-63-10" href="#__codelineno-63-10"></a>
</span><span id="__span-63-11"><a id="__codelineno-63-11" name="__codelineno-63-11" href="#__codelineno-63-11"></a><span class="c1"># –ï—Å–ª–∏ –Ω–µ—Ç, –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —à–∞–≥ 10.2</span>
</span></code></pre></div></p>
<hr />
<h2 id="11_1">–≠—Ç–∞–ø 11: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏<a class="headerlink" href="#11_1" title="Permanent link">&para;</a></h2>
<h3 id="111-vram">11.1 –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –ø–æ VRAM<a class="headerlink" href="#111-vram" title="Permanent link">&para;</a></h3>
<p><strong>–î–ª—è GTX 1050 Ti (4GB VRAM):</strong></p>
<table>
<thead>
<tr>
<th>–ú–æ–¥–µ–ª—å</th>
<th>–†–∞–∑–º–µ—Ä</th>
<th>VRAM</th>
<th>–°–∫–æ—Ä–æ—Å—Ç—å –≤ VM</th>
<th>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>phi3:mini</code></td>
<td>2.3GB</td>
<td>~2.5GB</td>
<td>40-50 tok/s</td>
<td>‚úÖ –õ—É—á—à–∏–π –±–∞–ª–∞–Ω—Å</td>
</tr>
<tr>
<td><code>llama3.2:3b</code></td>
<td>2GB</td>
<td>~2.2GB</td>
<td>50-60 tok/s</td>
<td>‚úÖ –ë—ã—Å—Ç—Ä–µ–µ</td>
</tr>
<tr>
<td><code>qwen2.5:3b</code></td>
<td>2GB</td>
<td>~2.2GB</td>
<td>40-50 tok/s</td>
<td>‚úÖ –•–æ—Ä–æ—à–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞</td>
</tr>
<tr>
<td><code>gemma2:2b</code></td>
<td>1.6GB</td>
<td>~1.8GB</td>
<td>70+ tok/s</td>
<td>‚úÖ –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á</td>
</tr>
</tbody>
</table>
<p><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> <code>phi3:mini</code> - –æ—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–æ–º.</p>
<h3 id="112">11.2 –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏<a class="headerlink" href="#112" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>ollama<span class="w"> </span>pull<span class="w"> </span>phi3:mini
</span></code></pre></div>
<p><strong>–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>pulling manifest
</span><span id="__span-65-2"><a id="__codelineno-65-2" name="__codelineno-65-2" href="#__codelineno-65-2"></a>pulling 8c83cdcf6a98... 100% ‚ñï‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè 2.3 GB
</span><span id="__span-65-3"><a id="__codelineno-65-3" name="__codelineno-65-3" href="#__codelineno-65-3"></a>pulling ed11eda7790d... 100% ‚ñï‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  106 B
</span><span id="__span-65-4"><a id="__codelineno-65-4" name="__codelineno-65-4" href="#__codelineno-65-4"></a>pulling ca31f59a46fb... 100% ‚ñï‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  485 B
</span><span id="__span-65-5"><a id="__codelineno-65-5" name="__codelineno-65-5" href="#__codelineno-65-5"></a>verifying sha256 digest
</span><span id="__span-65-6"><a id="__codelineno-65-6" name="__codelineno-65-6" href="#__codelineno-65-6"></a>writing manifest
</span><span id="__span-65-7"><a id="__codelineno-65-7" name="__codelineno-65-7" href="#__codelineno-65-7"></a>removing any unused layers
</span><span id="__span-65-8"><a id="__codelineno-65-8" name="__codelineno-65-8" href="#__codelineno-65-8"></a>success
</span></code></pre></div></p>
<p>–í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏: ~2-5 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞).</p>
<h3 id="113">11.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏<a class="headerlink" href="#113" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>ollama<span class="w"> </span>list
</span></code></pre></div>
<p><strong>–í—ã–≤–æ–¥:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a>NAME         ID          SIZE    MODIFIED
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a>phi3:mini    1a4e8c5f... 2.3 GB  2 minutes ago
</span></code></pre></div></p>
<h3 id="114-gpu">11.4 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å GPU<a class="headerlink" href="#114-gpu" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>ollama<span class="w"> </span>run<span class="w"> </span>phi3:mini<span class="w"> </span><span class="s2">&quot;–ü—Ä–∏–≤–µ—Ç! –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Å—è –∫—Ä–∞—Ç–∫–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –∫–∞–∫ AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —É–º–Ω–æ–≥–æ –¥–æ–º–∞&quot;</span>
</span></code></pre></div>
<p><strong>–í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</strong> –æ—Ç–∫—Ä–æ–π—Ç–µ –≤—Ç–æ—Ä–æ–π SSH —Å–µ–∞–Ω—Å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>nvidia-smi
</span></code></pre></div>
<p><strong>–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:</strong>
- GPU-Util –ø–æ–¥–Ω–∏–º–µ—Ç—Å—è –¥–æ 80-100% –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- Memory-Usage –ø–æ–∫–∞–∂–µ—Ç ~2500 MiB
- Temperature –ø–æ–¥–Ω–∏–º–µ—Ç—Å—è –¥–æ 50-65¬∞C</p>
<p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞:</strong>
- –ú–æ–¥–µ–ª—å –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- GPU –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (nvidia-smi –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É)
- –û—Ç–≤–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∑–∞ 3-5 —Å–µ–∫—É–Ω–¥</p>
<p><strong>–ï—Å–ª–∏ GPU –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (0% utilization):</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ CUDA –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>nvidia-smi
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a>
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a><span class="c1"># –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å —è–≤–Ω—ã–º —É–∫–∞–∑–∞–Ω–∏–µ–º GPU</span>
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>ollama<span class="w"> </span>run<span class="w"> </span>phi3:mini<span class="w"> </span><span class="s2">&quot;test&quot;</span>
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a>
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a><span class="c1"># –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–æ–±–∞–≤—å—Ç–µ –≤ systemd (—É–∂–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏–∑ 10.2)</span>
</span><span id="__span-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a>systemctl<span class="w"> </span>show<span class="w"> </span>ollama.service<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>CUDA_VISIBLE_DEVICES
</span></code></pre></div></p>
<h3 id="115-api">11.5 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API<a class="headerlink" href="#115-api" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>curl<span class="w"> </span>http://localhost:11434/api/generate<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="s1">  &quot;model&quot;: &quot;phi3:mini&quot;,</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a><span class="s1">  &quot;prompt&quot;: &quot;–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏ —Å–≤–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–∞–∫ AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞&quot;,</span>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a><span class="s1">  &quot;stream&quot;: false</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="s1">}&#39;</span>
</span></code></pre></div>
<p><strong>–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:</strong>
<div class="language-json highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="p">{</span>
</span><span id="__span-72-2"><a id="__codelineno-72-2" name="__codelineno-72-2" href="#__codelineno-72-2"></a><span class="w">  </span><span class="nt">&quot;model&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;phi3:mini&quot;</span><span class="p">,</span>
</span><span id="__span-72-3"><a id="__codelineno-72-3" name="__codelineno-72-3" href="#__codelineno-72-3"></a><span class="w">  </span><span class="nt">&quot;created_at&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2025-10-11T01:00:00.000Z&quot;</span><span class="p">,</span>
</span><span id="__span-72-4"><a id="__codelineno-72-4" name="__codelineno-72-4" href="#__codelineno-72-4"></a><span class="w">  </span><span class="nt">&quot;response&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;–Ø AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, —Å–ø–æ—Å–æ–±–Ω—ã–π –ø–æ–º–æ–≥–∞—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏...&quot;</span><span class="p">,</span>
</span><span id="__span-72-5"><a id="__codelineno-72-5" name="__codelineno-72-5" href="#__codelineno-72-5"></a><span class="w">  </span><span class="nt">&quot;done&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-72-6"><a id="__codelineno-72-6" name="__codelineno-72-6" href="#__codelineno-72-6"></a><span class="w">  </span><span class="nt">&quot;total_duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4500000000</span><span class="p">,</span>
</span><span id="__span-72-7"><a id="__codelineno-72-7" name="__codelineno-72-7" href="#__codelineno-72-7"></a><span class="w">  </span><span class="nt">&quot;load_duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">500000000</span><span class="p">,</span>
</span><span id="__span-72-8"><a id="__codelineno-72-8" name="__codelineno-72-8" href="#__codelineno-72-8"></a><span class="w">  </span><span class="nt">&quot;prompt_eval_duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100000000</span><span class="p">,</span>
</span><span id="__span-72-9"><a id="__codelineno-72-9" name="__codelineno-72-9" href="#__codelineno-72-9"></a><span class="w">  </span><span class="nt">&quot;eval_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">85</span><span class="p">,</span>
</span><span id="__span-72-10"><a id="__codelineno-72-10" name="__codelineno-72-10" href="#__codelineno-72-10"></a><span class="w">  </span><span class="nt">&quot;eval_duration&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2000000000</span>
</span><span id="__span-72-11"><a id="__codelineno-72-11" name="__codelineno-72-11" href="#__codelineno-72-11"></a><span class="p">}</span>
</span></code></pre></div></p>
<p><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong>
- <code>eval_count</code> / (<code>eval_duration</code> / 1e9) = tokens per second
- –î–ª—è phi3:mini –æ–∂–∏–¥–∞–µ—Ç—Å—è: ~40-50 tokens/sec</p>
<hr />
<h2 id="12-n8n">–≠—Ç–∞–ø 12: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å n8n<a class="headerlink" href="#12-n8n" title="Permanent link">&para;</a></h2>
<h3 id="121-workflow">12.1 –°–∫–∞—á–∏–≤–∞–Ω–∏–µ workflow<a class="headerlink" href="#121-workflow" title="Permanent link">&para;</a></h3>
<p>–ù–∞ –≤–∞—à–µ–π —Ä–∞–±–æ—á–µ–π –º–∞—à–∏–Ω–µ:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="nb">cd</span><span class="w"> </span>/home/gfer/HASSio
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="c1"># –§–∞–π–ª —É–∂–µ –µ—Å—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏</span>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a>ls<span class="w"> </span>-lh<span class="w"> </span>docs/integrations/n8n-voice-assistant-ollama.json
</span></code></pre></div>
<h3 id="122-n8n">12.2 –ò–º–ø–æ—Ä—Ç –≤ n8n<a class="headerlink" href="#122-n8n" title="Permanent link">&para;</a></h3>
<ol>
<li>–û—Ç–∫—Ä–æ–π—Ç–µ n8n Web UI</li>
<li><strong>Workflows</strong> ‚Üí <strong>Add workflow</strong> ‚Üí <strong>Import from File</strong></li>
<li>–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª <code>n8n-voice-assistant-ollama.json</code></li>
<li>Workflow –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Å 16 nodes</li>
</ol>
<h3 id="123-ollama-node">12.3 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Ollama node<a class="headerlink" href="#123-ollama-node" title="Permanent link">&para;</a></h3>
<p>–ù–∞–π–¥–∏—Ç–µ node <strong>"Ollama: Model"</strong>:</p>
<p><strong>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:</strong>
- <strong>Base URL:</strong> <code>http://&lt;VM_IP&gt;:11434</code> (IP –≤–∞—à–µ–π Ollama VM)
- <strong>Model:</strong> <code>phi3:mini</code></p>
<p>–¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="c1"># –° –º–∞—à–∏–Ω—ã –≥–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç n8n</span>
</span><span id="__span-74-2"><a id="__codelineno-74-2" name="__codelineno-74-2" href="#__codelineno-74-2"></a>curl<span class="w"> </span>http://&lt;VM_IP&gt;:11434/api/tags
</span></code></pre></div>
<p>–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π.</p>
<h3 id="124-home-assistant">12.4 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Home Assistant<a class="headerlink" href="#124-home-assistant" title="Permanent link">&para;</a></h3>
<p>Node <strong>"HA: Get All States"</strong>:</p>
<ul>
<li><strong>URL:</strong> <code>http://&lt;HA_IP&gt;:8123/api/states</code></li>
<li><strong>Authentication:</strong> Header Auth</li>
<li><strong>Credential:</strong> –°–æ–∑–¥–∞–π—Ç–µ –≤ n8n:</li>
<li>Type: HTTP Header Auth</li>
<li>Name: <code>Authorization</code></li>
<li>Value: <code>Bearer &lt;YOUR_HA_LONG_LIVED_TOKEN&gt;</code></li>
</ul>
<p><strong>–ü–æ–ª—É—á–µ–Ω–∏–µ HA —Ç–æ–∫–µ–Ω–∞:</strong>
1. Home Assistant ‚Üí –ü—Ä–æ—Ñ–∏–ª—å (–ª–µ–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª)
2. Long-Lived Access Tokens ‚Üí Create Token
3. Name: <code>n8n-ollama</code>
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω</p>
<h3 id="125-telegram">12.5 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Telegram<a class="headerlink" href="#125-telegram" title="Permanent link">&para;</a></h3>
<p>–°–æ–∑–¥–∞–π—Ç–µ Telegram Bot:
1. Telegram ‚Üí @BotFather ‚Üí <code>/newbot</code>
2. Name: <code>My Home Assistant Bot</code>
3. Username: <code>my_ha_ollama_bot</code>
4. –ü–æ–ª—É—á–∏—Ç–µ token: <code>123456:ABCdefGHI...</code></p>
<p>–ü–æ–ª—É—á–∏—Ç–µ –≤–∞—à Telegram ID:
1. Telegram ‚Üí @userinfobot ‚Üí –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID</p>
<p>–í n8n —Å–æ–∑–¥–∞–π—Ç–µ Telegram credential:
- Type: Telegram API
- Access Token: <code>123456:ABCdefGHI...</code></p>
<p>Node <strong>"Telegram: Trigger"</strong>:
- <strong>User IDs:</strong> –≤–∞—à Telegram ID
- <strong>Credential:</strong> –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π Telegram credential</p>
<h3 id="126-tool-workflows">12.6 –°–æ–∑–¥–∞–Ω–∏–µ Tool workflows<a class="headerlink" href="#126-tool-workflows" title="Permanent link">&para;</a></h3>
<p>–î–ª—è —Ä–∞–±–æ—Ç—ã AI Agent –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å 5 sub-workflows –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Home Assistant.</p>
<p><strong>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä - Tool "Turn On Light":</strong></p>
<ol>
<li>–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π workflow: <strong>+ Add workflow</strong></li>
<li>–î–æ–±–∞–≤—å—Ç–µ node <strong>HTTP Request</strong>:</li>
<li>Method: <code>POST</code></li>
<li>URL: <code>http://&lt;HA_IP&gt;:8123/api/services/light/turn_on</code></li>
<li>Authentication: Header Auth (–≤–∞—à HA credential)</li>
<li>Body Content Type: JSON</li>
<li>Body:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a><span class="p">{</span>
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a><span class="w">  </span><span class="nt">&quot;entity_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;={{ $json.entity_id }}&quot;</span>
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a><span class="p">}</span>
</span></code></pre></div></li>
<li><strong>Save</strong> workflow</li>
<li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ ID workflow (–∏–∑ URL: <code>.../workflow/&lt;ID&gt;</code>)</li>
<li>–í –≥–ª–∞–≤–Ω–æ–º workflow –Ω–∞–π–¥–∏—Ç–µ node <strong>"Tool: Turn On Light"</strong></li>
<li>–ü–∞—Ä–∞–º–µ—Ç—Ä <strong>Workflow ID:</strong> –≤—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ID</li>
</ol>
<p>–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö tools:
- <code>Tool: Turn Off Light</code> - POST <code>/api/services/light/turn_off</code>
- <code>Tool: Set Temperature</code> - POST <code>/api/services/climate/set_temperature</code>
- <code>Tool: Activate Scene</code> - POST <code>/api/services/scene/turn_on</code>
- <code>Tool: Get Sensor</code> - GET <code>/api/states/{{ $json.entity_id }}</code></p>
<h3 id="127-workflow">12.7 –ê–∫—Ç–∏–≤–∞—Ü–∏—è workflow<a class="headerlink" href="#127-workflow" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Save</strong> –≥–ª–∞–≤–Ω—ã–π workflow</li>
<li>–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ toggle —Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É (Active)</li>
<li>–û—Ç–∫—Ä–æ–π—Ç–µ Telegram ‚Üí –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞</li>
<li>–û—Ç–ø—Ä–∞–≤—å—Ç–µ: <code>/start</code></li>
</ol>
<p><strong>–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:</strong>
<div class="language-text highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a>ü§ñ –¢–µ–∫—Å—Ç–æ–≤—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç Home Assistant + Ollama
</span><span id="__span-76-2"><a id="__codelineno-76-2" name="__codelineno-76-2" href="#__codelineno-76-2"></a>
</span><span id="__span-76-3"><a id="__codelineno-76-3" name="__codelineno-76-3" href="#__codelineno-76-3"></a>*–ö–æ–º–∞–Ω–¥—ã:*
</span><span id="__span-76-4"><a id="__codelineno-76-4" name="__codelineno-76-4" href="#__codelineno-76-4"></a>‚Ä¢ –í–∫–ª—é—á–∏/–≤—ã–∫–ª—é—á–∏ —Å–≤–µ—Ç [–∫–æ–º–Ω–∞—Ç–∞]
</span><span id="__span-76-5"><a id="__codelineno-76-5" name="__codelineno-76-5" href="#__codelineno-76-5"></a>...
</span></code></pre></div></p>
<hr />
<h2 id="13">–≠—Ç–∞–ø 13: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã<a class="headerlink" href="#13" title="Permanent link">&para;</a></h2>
<h3 id="131">13.1 –ü—Ä–æ—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞<a class="headerlink" href="#131" title="Permanent link">&para;</a></h3>
<p>–í Telegram –±–æ—Ç—É:
<div class="language-text highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>–ü—Ä–∏–≤–µ—Ç!
</span></code></pre></div></p>
<p>–ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–≤–µ—Ç–∏—Ç—å —á–µ—Ä–µ–∑ 3-5 —Å–µ–∫—É–Ω–¥.</p>
<h3 id="132">13.2 –ö–æ–º–∞–Ω–¥–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è<a class="headerlink" href="#132" title="Permanent link">&para;</a></h3>
<div class="language-text highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a>–í–∫–ª—é—á–∏ —Å–≤–µ—Ç –Ω–∞ –∫—É—Ö–Ω–µ
</span></code></pre></div>
<p>–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å <code>light.kitchen</code>, –±–æ—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É.</p>
<h3 id="133-gpu">13.3 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ GPU<a class="headerlink" href="#133-gpu" title="Permanent link">&para;</a></h3>
<p>–í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a><span class="c1"># –í VM</span>
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span>nvidia-smi
</span></code></pre></div>
<p>–ù–∞–±–ª—é–¥–∞–π—Ç–µ:
- GPU-Util: 80-100% –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- Memory: ~2.5GB –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- Temperature: 45-65¬∞C</p>
<h3 id="134">13.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<a class="headerlink" href="#134" title="Permanent link">&para;</a></h3>
<p>–ò–∑–º–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞:
- –ü—Ä–æ—Å—Ç–æ–π –≤–æ–ø—Ä–æ—Å: 2-4 —Å–µ–∫—É–Ω–¥—ã
- –ö–æ–º–∞–Ω–¥–∞ —Å –≤—ã–∑–æ–≤–æ–º tool: 4-7 —Å–µ–∫—É–Ω–¥
- –°–ª–æ–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å: 5-8 —Å–µ–∫—É–Ω–¥</p>
<p><strong>–î–ª—è GTX 1050 Ti + phi3:mini —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.</strong></p>
<hr />
<h2 id="_3">–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="snapshot-vm">Snapshot VM –ø–µ—Ä–µ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏<a class="headerlink" href="#snapshot-vm" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="c1"># –ù–∞ Proxmox —Ö–æ—Å—Ç–µ</span>
</span><span id="__span-80-2"><a id="__codelineno-80-2" name="__codelineno-80-2" href="#__codelineno-80-2"></a>qm<span class="w"> </span>snapshot<span class="w"> </span><span class="m">300</span><span class="w"> </span>clean-phi3mini-install
</span></code></pre></div>
<h3 id="backup-vm">Backup VM<a class="headerlink" href="#backup-vm" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a><span class="c1"># Snapshot backup</span>
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>vzdump<span class="w"> </span><span class="m">300</span><span class="w"> </span>--mode<span class="w"> </span>snapshot<span class="w"> </span>--storage<span class="w"> </span><span class="nb">local</span><span class="w"> </span>--compress<span class="w"> </span>zstd
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>
</span><span id="__span-81-4"><a id="__codelineno-81-4" name="__codelineno-81-4" href="#__codelineno-81-4"></a><span class="c1"># Backup —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ /var/lib/vz/dump/</span>
</span></code></pre></div>
<h3 id="ollama">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Ollama<a class="headerlink" href="#ollama" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a>ssh<span class="w"> </span>admin@&lt;VM_IP&gt;
</span><span id="__span-82-2"><a id="__codelineno-82-2" name="__codelineno-82-2" href="#__codelineno-82-2"></a>
</span><span id="__span-82-3"><a id="__codelineno-82-3" name="__codelineno-82-3" href="#__codelineno-82-3"></a><span class="c1"># –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ</span>
</span><span id="__span-82-4"><a id="__codelineno-82-4" name="__codelineno-82-4" href="#__codelineno-82-4"></a>curl<span class="w"> </span>-fsSL<span class="w"> </span>https://ollama.ai/install.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
</span><span id="__span-82-5"><a id="__codelineno-82-5" name="__codelineno-82-5" href="#__codelineno-82-5"></a>
</span><span id="__span-82-6"><a id="__codelineno-82-6" name="__codelineno-82-6" href="#__codelineno-82-6"></a><span class="c1"># –†–µ—Å—Ç–∞—Ä—Ç</span>
</span><span id="__span-82-7"><a id="__codelineno-82-7" name="__codelineno-82-7" href="#__codelineno-82-7"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>ollama.service
</span></code></pre></div>
<h3 id="gpu">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –∞–ø–≥—Ä–µ–π–¥–∞ GPU<a class="headerlink" href="#gpu" title="Permanent link">&para;</a></h3>
<p>–ü–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã GTX 1050 Ti –Ω–∞ GTX 1060 (6GB):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a><span class="c1"># –ó–∞–≥—Ä—É–∑–∫–∞ –±–æ–ª–µ–µ –º–æ—â–Ω–æ–π –º–æ–¥–µ–ª–∏</span>
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>ollama<span class="w"> </span>pull<span class="w"> </span>llama3.1:8b
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞</span>
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a>ollama<span class="w"> </span>list
</span><span id="__span-83-6"><a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>
</span><span id="__span-83-7"><a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a><span class="c1"># –¢–µ—Å—Ç</span>
</span><span id="__span-83-8"><a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a>ollama<span class="w"> </span>run<span class="w"> </span>llama3.1:8b<span class="w"> </span><span class="s2">&quot;–¢–µ—Å—Ç –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏&quot;</span>
</span><span id="__span-83-9"><a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a>
</span><span id="__span-83-10"><a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a><span class="c1"># –í n8n –æ–±–Ω–æ–≤–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä model –Ω–∞ &quot;llama3.1:8b&quot;</span>
</span></code></pre></div>
<hr />
<h2 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="vm-cannot-allocate-memory">–ü—Ä–æ–±–ª–µ–º–∞: VM –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è - Cannot allocate memory<a class="headerlink" href="#vm-cannot-allocate-memory" title="Permanent link">&para;</a></h3>
<p><strong>–°–∏–º–ø—Ç–æ–º—ã:</strong> <code>QEMU exited with code 1</code>, –≤ –ª–æ–≥–∞—Ö: <code>Cannot allocate memory (12)</code></p>
<p><strong>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="c1"># –ù–∞ Proxmox —Ö–æ—Å—Ç–µ</span>
</span><span id="__span-84-2"><a id="__codelineno-84-2" name="__codelineno-84-2" href="#__codelineno-84-2"></a>free<span class="w"> </span>-h
</span><span id="__span-84-3"><a id="__codelineno-84-3" name="__codelineno-84-3" href="#__codelineno-84-3"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Total –∏ Available RAM</span>
</span><span id="__span-84-4"><a id="__codelineno-84-4" name="__codelineno-84-4" href="#__codelineno-84-4"></a>
</span><span id="__span-84-5"><a id="__codelineno-84-5" name="__codelineno-84-5" href="#__codelineno-84-5"></a>cat<span class="w"> </span>/etc/pve/qemu-server/&lt;VMID&gt;.conf<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>memory
</span><span id="__span-84-6"><a id="__codelineno-84-6" name="__codelineno-84-6" href="#__codelineno-84-6"></a><span class="c1"># –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫–æ–ª—å–∫–æ RAM –≤—ã–¥–µ–ª–µ–Ω–æ VM</span>
</span></code></pre></div></p>
<p><strong>–ü—Ä–∏—á–∏–Ω–∞:</strong> VM –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã–¥–µ–ª–∏—Ç—å –±–æ–ª—å—à–µ RAM —á–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ —Ö–æ—Å—Ç–µ.</p>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<ol>
<li>
<p><strong>–£–º–µ–Ω—å—à–∏—Ç–µ RAM VM:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a><span class="c1"># –ù–∞ —Ö–æ—Å—Ç–µ (VM –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã–∫–ª—é—á–µ–Ω–∞)</span>
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>qm<span class="w"> </span><span class="nb">set</span><span class="w"> </span>&lt;VMID&gt;<span class="w"> </span>--memory<span class="w"> </span><span class="m">6144</span><span class="w">  </span><span class="c1"># 6GB –≤–º–µ—Å—Ç–æ 8GB</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>–ò–ª–∏ —á–µ—Ä–µ–∑ Web UI:</strong></p>
</li>
<li>VM ‚Üí Hardware ‚Üí Memory ‚Üí Edit</li>
<li>
<p>–£–º–µ–Ω—å—à–∏—Ç–µ –¥–æ 4096-6144 MB</p>
</li>
<li>
<p><strong>–ó–∞–ø—É—Å—Ç–∏—Ç–µ VM:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a>qm<span class="w"> </span>start<span class="w"> </span>&lt;VMID&gt;
</span></code></pre></div></p>
</li>
</ol>
<p><strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:</strong>
- <strong>8GB —Ö–æ—Å—Ç:</strong> VM –º–∞–∫—Å–∏–º—É–º 6GB
- <strong>16GB —Ö–æ—Å—Ç:</strong> VM –º–∞–∫—Å–∏–º—É–º 12GB
- <strong>32GB —Ö–æ—Å—Ç:</strong> VM –º–∞–∫—Å–∏–º—É–º 24GB</p>
<p><strong>–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:</strong> –£–≤–µ–ª–∏—á—å—Ç–µ RAM –Ω–∞ Proxmox —Ö–æ—Å—Ç–µ –¥–æ 16GB+.</p>
<hr />
<h3 id="amd-vi-iommu-groups-0">–ü—Ä–æ–±–ª–µ–º–∞: AMD-Vi –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è (IOMMU groups = 0)<a class="headerlink" href="#amd-vi-iommu-groups-0" title="Permanent link">&para;</a></h3>
<p><strong>–°–∏–º–ø—Ç–æ–º—ã:</strong> –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GRUB <code>ls /sys/kernel/iommu_groups/</code> –ø—É—Å—Ç–æ–π, AMD-Vi –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ dmesg</p>
<p><strong>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="c1"># 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ IVRS —Ç–∞–±–ª–∏—Ü—ã</span>
</span><span id="__span-87-2"><a id="__codelineno-87-2" name="__codelineno-87-2" href="#__codelineno-87-2"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>ivrs
</span><span id="__span-87-3"><a id="__codelineno-87-3" name="__codelineno-87-3" href="#__codelineno-87-3"></a><span class="c1"># –ï—Å–ª–∏ –ø—É—Å—Ç–æ - BIOS –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç IOMMU –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</span>
</span><span id="__span-87-4"><a id="__codelineno-87-4" name="__codelineno-87-4" href="#__codelineno-87-4"></a>
</span><span id="__span-87-5"><a id="__codelineno-87-5" name="__codelineno-87-5" href="#__codelineno-87-5"></a><span class="c1"># 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —è–¥—Ä–∞</span>
</span><span id="__span-87-6"><a id="__codelineno-87-6" name="__codelineno-87-6" href="#__codelineno-87-6"></a>cat<span class="w"> </span>/proc/cmdline
</span><span id="__span-87-7"><a id="__codelineno-87-7" name="__codelineno-87-7" href="#__codelineno-87-7"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: iommu=pt</span>
</span><span id="__span-87-8"><a id="__codelineno-87-8" name="__codelineno-87-8" href="#__codelineno-87-8"></a>
</span><span id="__span-87-9"><a id="__codelineno-87-9" name="__codelineno-87-9" href="#__codelineno-87-9"></a><span class="c1"># 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ BIOS</span>
</span><span id="__span-87-10"><a id="__codelineno-87-10" name="__codelineno-87-10" href="#__codelineno-87-10"></a>dmidecode<span class="w"> </span>-s<span class="w"> </span>bios-version
</span></code></pre></div></p>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<ol>
<li><strong>–í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ BIOS:</strong></li>
<li>–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ <strong>IOMMU = Enabled</strong> (AMD CBS —Ä–∞–∑–¥–µ–ª)</li>
<li>
<p>–î–ª—è ASRock: –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ BIOS –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏</p>
</li>
<li>
<p><strong>–ï—Å–ª–∏ IVRS –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–æ AMD-Vi –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a><span class="c1"># –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å amd_iommu=on</span>
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>nano<span class="w"> </span>/etc/default/grub
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a><span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;quiet amd_iommu=on iommu=pt&quot;</span>
</span><span id="__span-88-4"><a id="__codelineno-88-4" name="__codelineno-88-4" href="#__codelineno-88-4"></a>update-grub
</span><span id="__span-88-5"><a id="__codelineno-88-5" name="__codelineno-88-5" href="#__codelineno-88-5"></a>reboot
</span></code></pre></div>
   (–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "Unknown option" –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –µ—Å–ª–∏ AMD-Vi –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è)</p>
</li>
<li>
<p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>amd-vi
</span><span id="__span-89-2"><a id="__codelineno-89-2" name="__codelineno-89-2" href="#__codelineno-89-2"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: AMD-Vi: Interrupt remapping enabled</span>
</span><span id="__span-89-3"><a id="__codelineno-89-3" name="__codelineno-89-3" href="#__codelineno-89-3"></a>
</span><span id="__span-89-4"><a id="__codelineno-89-4" name="__codelineno-89-4" href="#__codelineno-89-4"></a>ls<span class="w"> </span>/sys/kernel/iommu_groups/<span class="w"> </span><span class="p">|</span><span class="w"> </span>wc<span class="w"> </span>-l
</span><span id="__span-89-5"><a id="__codelineno-89-5" name="__codelineno-89-5" href="#__codelineno-89-5"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –±—ã—Ç—å &gt; 0</span>
</span></code></pre></div></p>
</li>
</ol>
<h3 id="vm-gpu">–ü—Ä–æ–±–ª–µ–º–∞: VM –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è GPU<a class="headerlink" href="#vm-gpu" title="Permanent link">&para;</a></h3>
<p><strong>–°–∏–º–ø—Ç–æ–º—ã:</strong> Black screen, VM –∑–∞–≤–∏—Å–∞–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ</p>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<ol>
<li>–í—ã–∫–ª—é—á–∏—Ç–µ VM –ø–æ–ª–Ω–æ—Å—Ç—å—é (Shutdown, –Ω–µ Reset)</li>
<li>Proxmox Web UI ‚Üí VM 300 ‚Üí Hardware</li>
<li>–£–¥–∞–ª–∏—Ç–µ PCI Device (hostpci0)</li>
<li>–ó–∞–ø—É—Å—Ç–∏—Ç–µ VM - –¥–æ–ª–∂–Ω–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è</li>
<li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ —Ö–æ—Å—Ç–µ:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>lspci<span class="w"> </span>-nnk<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">3</span><span class="w"> </span>nvidia
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a><span class="c1"># –£–±–µ–¥–∏—Ç–µ—Å—å: Kernel driver in use: vfio-pci</span>
</span></code></pre></div></li>
<li>–í—ã–∫–ª—é—á–∏—Ç–µ VM</li>
<li>–î–æ–±–∞–≤—å—Ç–µ PCI Device —Å–Ω–æ–≤–∞:</li>
<li>‚úÖ All Functions</li>
<li>‚úÖ Primary GPU</li>
<li>‚úÖ PCI-Express</li>
<li>–ó–∞–ø—É—Å—Ç–∏—Ç–µ VM</li>
</ol>
<h3 id="gpu-nvidia-smi">–ü—Ä–æ–±–ª–µ–º–∞: GPU –≤–∏–¥–µ–Ω, –Ω–æ nvidia-smi –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç<a class="headerlink" href="#gpu-nvidia-smi" title="Permanent link">&para;</a></h3>
<p><strong>–°–∏–º–ø—Ç–æ–º—ã:</strong> <code>NVIDIA-SMI has failed because it couldn't communicate with the NVIDIA driver</code></p>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a><span class="c1"># 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –¥—Ä–∞–π–≤–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</span>
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>dpkg<span class="w"> </span>-l<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>nvidia-driver-535
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a><span class="c1"># 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞</span>
</span><span id="__span-91-5"><a id="__codelineno-91-5" name="__codelineno-91-5" href="#__codelineno-91-5"></a>lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>nvidia
</span><span id="__span-91-6"><a id="__codelineno-91-6" name="__codelineno-91-6" href="#__codelineno-91-6"></a>
</span><span id="__span-91-7"><a id="__codelineno-91-7" name="__codelineno-91-7" href="#__codelineno-91-7"></a><span class="c1"># 3. –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª—è –≤—Ä—É—á–Ω—É—é</span>
</span><span id="__span-91-8"><a id="__codelineno-91-8" name="__codelineno-91-8" href="#__codelineno-91-8"></a>sudo<span class="w"> </span>modprobe<span class="w"> </span>nvidia
</span><span id="__span-91-9"><a id="__codelineno-91-9" name="__codelineno-91-9" href="#__codelineno-91-9"></a>
</span><span id="__span-91-10"><a id="__codelineno-91-10" name="__codelineno-91-10" href="#__codelineno-91-10"></a><span class="c1"># 4. –ü—Ä–æ–≤–µ—Ä–∫–∞</span>
</span><span id="__span-91-11"><a id="__codelineno-91-11" name="__codelineno-91-11" href="#__codelineno-91-11"></a>nvidia-smi
</span><span id="__span-91-12"><a id="__codelineno-91-12" name="__codelineno-91-12" href="#__codelineno-91-12"></a>
</span><span id="__span-91-13"><a id="__codelineno-91-13" name="__codelineno-91-13" href="#__codelineno-91-13"></a><span class="c1"># 5. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞</span>
</span><span id="__span-91-14"><a id="__codelineno-91-14" name="__codelineno-91-14" href="#__codelineno-91-14"></a>sudo<span class="w"> </span>apt<span class="w"> </span>purge<span class="w"> </span>nvidia-*
</span><span id="__span-91-15"><a id="__codelineno-91-15" name="__codelineno-91-15" href="#__codelineno-91-15"></a>sudo<span class="w"> </span>apt<span class="w"> </span>autoremove
</span><span id="__span-91-16"><a id="__codelineno-91-16" name="__codelineno-91-16" href="#__codelineno-91-16"></a>sudo<span class="w"> </span>ubuntu-drivers<span class="w"> </span>autoinstall
</span><span id="__span-91-17"><a id="__codelineno-91-17" name="__codelineno-91-17" href="#__codelineno-91-17"></a>sudo<span class="w"> </span>reboot
</span></code></pre></div>
<h3 id="ollama-cpu-mode">–ü—Ä–æ–±–ª–µ–º–∞: Ollama –º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç (CPU mode)<a class="headerlink" href="#ollama-cpu-mode" title="Permanent link">&para;</a></h3>
<p><strong>–°–∏–º–ø—Ç–æ–º—ã:</strong> –û—Ç–≤–µ—Ç—ã –∑–∞ 20-30+ —Å–µ–∫—É–Ω–¥, nvidia-smi –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 0% GPU util</p>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="c1"># 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ CUDA</span>
</span><span id="__span-92-2"><a id="__codelineno-92-2" name="__codelineno-92-2" href="#__codelineno-92-2"></a>nvidia-smi
</span><span id="__span-92-3"><a id="__codelineno-92-3" name="__codelineno-92-3" href="#__codelineno-92-3"></a>
</span><span id="__span-92-4"><a id="__codelineno-92-4" name="__codelineno-92-4" href="#__codelineno-92-4"></a><span class="c1"># 2. –¢–µ—Å—Ç Ollama —Å —è–≤–Ω—ã–º GPU</span>
</span><span id="__span-92-5"><a id="__codelineno-92-5" name="__codelineno-92-5" href="#__codelineno-92-5"></a><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>ollama<span class="w"> </span>run<span class="w"> </span>phi3:mini<span class="w"> </span><span class="s2">&quot;test&quot;</span>
</span><span id="__span-92-6"><a id="__codelineno-92-6" name="__codelineno-92-6" href="#__codelineno-92-6"></a>
</span><span id="__span-92-7"><a id="__codelineno-92-7" name="__codelineno-92-7" href="#__codelineno-92-7"></a><span class="c1"># –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–±–ª–µ–º–∞ –≤ systemd unit:</span>
</span><span id="__span-92-8"><a id="__codelineno-92-8" name="__codelineno-92-8" href="#__codelineno-92-8"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>edit<span class="w"> </span>ollama.service
</span><span id="__span-92-9"><a id="__codelineno-92-9" name="__codelineno-92-9" href="#__codelineno-92-9"></a>
</span><span id="__span-92-10"><a id="__codelineno-92-10" name="__codelineno-92-10" href="#__codelineno-92-10"></a><span class="c1"># –î–æ–±–∞–≤—å—Ç–µ:</span>
</span><span id="__span-92-11"><a id="__codelineno-92-11" name="__codelineno-92-11" href="#__codelineno-92-11"></a><span class="c1"># [Service]</span>
</span><span id="__span-92-12"><a id="__codelineno-92-12" name="__codelineno-92-12" href="#__codelineno-92-12"></a><span class="c1"># Environment=&quot;CUDA_VISIBLE_DEVICES=0&quot;</span>
</span><span id="__span-92-13"><a id="__codelineno-92-13" name="__codelineno-92-13" href="#__codelineno-92-13"></a>
</span><span id="__span-92-14"><a id="__codelineno-92-14" name="__codelineno-92-14" href="#__codelineno-92-14"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
</span><span id="__span-92-15"><a id="__codelineno-92-15" name="__codelineno-92-15" href="#__codelineno-92-15"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>ollama.service
</span></code></pre></div>
<h3 id="out-of-memory">–ü—Ä–æ–±–ª–µ–º–∞: Out of Memory –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏<a class="headerlink" href="#out-of-memory" title="Permanent link">&para;</a></h3>
<p><strong>–°–∏–º–ø—Ç–æ–º—ã:</strong> Ollama –∫—Ä–∞—à–∏—Ç—Å—è –ø—Ä–∏ <code>ollama run</code>, –æ—à–∏–±–∫–∞ CUDA OOM</p>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<ol>
<li>
<p>–í—ã–±–µ—Ä–∏—Ç–µ –º–µ–Ω—å—à—É—é –º–æ–¥–µ–ª—å:
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="c1"># –í–º–µ—Å—Ç–æ phi3:mini –ø–æ–ø—Ä–æ–±—É–π—Ç–µ</span>
</span><span id="__span-93-2"><a id="__codelineno-93-2" name="__codelineno-93-2" href="#__codelineno-93-2"></a>ollama<span class="w"> </span>pull<span class="w"> </span>gemma2:2b
</span></code></pre></div></p>
</li>
<li>
<p>–£–≤–µ–ª–∏—á—å—Ç–µ RAM VM (–Ω–∞ Proxmox —Ö–æ—Å—Ç–µ):
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a><span class="c1"># –í—ã–∫–ª—é—á–∏—Ç–µ VM</span>
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a>qm<span class="w"> </span>shutdown<span class="w"> </span><span class="m">300</span>
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a>
</span><span id="__span-94-4"><a id="__codelineno-94-4" name="__codelineno-94-4" href="#__codelineno-94-4"></a><span class="c1"># –£–≤–µ–ª–∏—á—å—Ç–µ –¥–æ 12GB</span>
</span><span id="__span-94-5"><a id="__codelineno-94-5" name="__codelineno-94-5" href="#__codelineno-94-5"></a>qm<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="m">300</span><span class="w"> </span>--memory<span class="w"> </span><span class="m">12288</span>
</span><span id="__span-94-6"><a id="__codelineno-94-6" name="__codelineno-94-6" href="#__codelineno-94-6"></a>
</span><span id="__span-94-7"><a id="__codelineno-94-7" name="__codelineno-94-7" href="#__codelineno-94-7"></a><span class="c1"># –ó–∞–ø—É—Å—Ç–∏—Ç–µ</span>
</span><span id="__span-94-8"><a id="__codelineno-94-8" name="__codelineno-94-8" href="#__codelineno-94-8"></a>qm<span class="w"> </span>start<span class="w"> </span><span class="m">300</span>
</span></code></pre></div></p>
</li>
</ol>
<h3 id="ollama-127001">–ü—Ä–æ–±–ª–µ–º–∞: Ollama –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ —Å–µ—Ç–∏ (—Å–ª—É—à–∞–µ—Ç –Ω–∞ 127.0.0.1)<a class="headerlink" href="#ollama-127001" title="Permanent link">&para;</a></h3>
<p><strong>–°–∏–º–ø—Ç–æ–º—ã:</strong>
- –í VM: <code>curl http://localhost:11434/api/tags</code> —Ä–∞–±–æ—Ç–∞–µ—Ç
- –° —Ö–æ—Å—Ç–∞: <code>curl http://&lt;VM_IP&gt;:11434/api/tags</code> ‚Üí Connection refused
- <code>sudo ss -tlnp | grep 11434</code> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <code>127.0.0.1:11434</code> –≤–º–µ—Å—Ç–æ <code>0.0.0.0:11434</code></p>
<p><strong>–ü—Ä–∏—á–∏–Ω–∞:</strong> –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è <code>OLLAMA_HOST</code> –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª–∞—Å—å.</p>
<p><strong>–†–µ—à–µ–Ω–∏–µ:</strong></p>
<ol>
<li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ override.conf —Å–æ–∑–¥–∞–Ω:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a>sudo<span class="w"> </span>cat<span class="w"> </span>/etc/systemd/system/ollama.service.d/override.conf
</span></code></pre></div></li>
</ol>
<p>–ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ –≤—Ä—É—á–Ω—É—é (—Å–º. –≠—Ç–∞–ø 10.2, –í–∞—Ä–∏–∞–Ω—Ç B)</p>
<ol>
<li>
<p><strong>–ï—Å–ª–∏ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–ª—Å—è:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>daemon-reload
</span><span id="__span-96-2"><a id="__codelineno-96-2" name="__codelineno-96-2" href="#__codelineno-96-2"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>ollama.service
</span></code></pre></div></p>
</li>
<li>
<p><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a>systemctl<span class="w"> </span>show<span class="w"> </span>ollama.service<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>OLLAMA_HOST
</span></code></pre></div></p>
</li>
</ol>
<p>–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: <code>Environment=OLLAMA_HOST=0.0.0.0:11434</code></p>
<ol>
<li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–µ–ø–µ—Ä—å —Å–ª—É—à–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a>sudo<span class="w"> </span>ss<span class="w"> </span>-tlnp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">11434</span>
</span></code></pre></div></li>
</ol>
<p>–î–æ–ª–∂–Ω–æ –±—ã—Ç—å: <code>*:11434</code> –∏–ª–∏ <code>0.0.0.0:11434</code></p>
<ol>
<li><strong>–ï—Å–ª–∏ –≤—Å—ë –µ—â–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –≤—Ä–µ–º–µ–Ω–Ω—ã–π workaround:</strong>
   <div class="language-bash highlight"><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>ollama.service
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a><span class="nv">OLLAMA_HOST</span><span class="o">=</span><span class="m">0</span>.0.0.0:11434<span class="w"> </span>ollama<span class="w"> </span>serve
</span></code></pre></div></li>
</ol>
<p>–ï—Å–ª–∏ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ - –ø—Ä–æ–±–ª–µ–º–∞ –≤ systemd override, –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª.</p>
<p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å —Ö–æ—Å—Ç–∞:</strong>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="c1"># –ù–∞ Proxmox —Ö–æ—Å—Ç–µ</span>
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a>curl<span class="w"> </span>http://&lt;VM_IP&gt;:11434/api/tags
</span></code></pre></div></p>
<hr />
<h3 id="code-43-device-manager-windows-vm">–ü—Ä–æ–±–ª–µ–º–∞: Code 43 –≤ Device Manager (–µ—Å–ª–∏ Windows VM)<a class="headerlink" href="#code-43-device-manager-windows-vm" title="Permanent link">&para;</a></h3>
<p>–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ –∫ Ubuntu, –Ω–æ –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏:
- –î–æ–±–∞–≤—å—Ç–µ <code>args: -cpu host,kvm=off</code> –≤ –∫–æ–Ω—Ñ–∏–≥ VM
- –≠—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é –æ—Ç NVIDIA –¥—Ä–∞–π–≤–µ—Ä–∞</p>
<hr />
<h2 id="_4">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–µ—Ç—Ä–∏–∫–∏<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="gtx-1050-ti-4gb-phi3mini-vm">GTX 1050 Ti (4GB) + phi3:mini –≤ VM<a class="headerlink" href="#gtx-1050-ti-4gb-phi3mini-vm" title="Permanent link">&para;</a></h3>
<p><strong>Measured metrics:</strong>
- Cold start latency: 4-6 —Å–µ–∫—É–Ω–¥
- Warm latency: 2-3 —Å–µ–∫—É–Ω–¥—ã
- Throughput: 40-50 tokens/sec
- VRAM usage: 2.4-2.6GB / 4GB
- GPU utilization: 85-95% –≤–æ –≤—Ä–µ–º—è inference
- Power draw: 50-70W (–∏–∑ 75W TDP)</p>
<p><strong>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å LXC:</strong> ~5-10% –º–µ–¥–ª–µ–Ω–Ω–µ–µ (–ø—Ä–∏–µ–º–ª–µ–º–æ –∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)</p>
<h3 id="gtx-1060-6gb-llama318b">GTX 1060 (6GB) + llama3.1:8b –ø–æ—Å–ª–µ –∞–ø–≥—Ä–µ–π–¥–∞<a class="headerlink" href="#gtx-1060-6gb-llama318b" title="Permanent link">&para;</a></h3>
<p><strong>Expected metrics:</strong>
- Cold start latency: 5-8 —Å–µ–∫—É–Ω–¥
- Warm latency: 2-4 —Å–µ–∫—É–Ω–¥—ã
- Throughput: 30-45 tokens/sec
- VRAM usage: 4.8-5.2GB / 6GB
- GPU utilization: 80-90%</p>
<hr />
<h2 id="_5">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="cpu-pinning-vm">CPU pinning –¥–ª—è VM<a class="headerlink" href="#cpu-pinning-vm" title="Permanent link">&para;</a></h3>
<p>–ù–∞ Proxmox —Ö–æ—Å—Ç–µ (–µ—Å–ª–∏ —É –≤–∞—Å 8+ cores):</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a><span class="c1"># Pin VM –∫ specific cores (–Ω–∞–ø—Ä–∏–º–µ—Ä 4-7 –Ω–∞ 8-core CPU)</span>
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a>qm<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="m">300</span><span class="w"> </span>--cpulimit<span class="w"> </span><span class="m">4</span>
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a>nano<span class="w"> </span>/etc/pve/qemu-server/300.conf
</span></code></pre></div>
<p>–î–æ–±–∞–≤—å—Ç–µ:
<div class="language-text highlight"><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a>affinity: 4-7
</span></code></pre></div></p>
<h3 id="huge-pages-8b">Huge pages (–¥–ª—è –º–æ–¥–µ–ª–µ–π 8B+)<a class="headerlink" href="#huge-pages-8b" title="Permanent link">&para;</a></h3>
<p>–ù–∞ Proxmox —Ö–æ—Å—Ç–µ:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="c1"># –í—ã–¥–µ–ª–∏—Ç—å 4GB huge pages (–¥–ª—è llama3.1:8b)</span>
</span><span id="__span-103-2"><a id="__codelineno-103-2" name="__codelineno-103-2" href="#__codelineno-103-2"></a>sysctl<span class="w"> </span>vm.nr_hugepages<span class="o">=</span><span class="m">2048</span>
</span><span id="__span-103-3"><a id="__codelineno-103-3" name="__codelineno-103-3" href="#__codelineno-103-3"></a>
</span><span id="__span-103-4"><a id="__codelineno-103-4" name="__codelineno-103-4" href="#__codelineno-103-4"></a><span class="c1"># Persistent:</span>
</span><span id="__span-103-5"><a id="__codelineno-103-5" name="__codelineno-103-5" href="#__codelineno-103-5"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;vm.nr_hugepages=2048&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/sysctl.conf
</span></code></pre></div>
<p>–í VM –∫–æ–Ω—Ñ–∏–≥–µ:
<div class="language-text highlight"><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a>hugepages: 1024
</span></code></pre></div></p>
<hr />
<h2 id="gpu_1">–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –¥–≤—É–º—è GPU<a class="headerlink" href="#gpu_1" title="Permanent link">&para;</a></h2>
<p>–ï—Å–ª–∏ —É –≤–∞—Å <strong>–¥–≤–µ –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã</strong> (–Ω–∞–ø—Ä–∏–º–µ—Ä, NVIDIA –¥–ª—è Ollama + AMD Radeon –¥–ª—è —Ö–æ—Å—Ç–∞), –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.</p>
<h3 id="1-radeon-nvidia-vm">–í–∞—Ä–∏–∞–Ω—Ç 1: Radeon –¥–ª—è —Ö–æ—Å—Ç–∞, NVIDIA –¥–ª—è VM (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)<a class="headerlink" href="#1-radeon-nvidia-vm" title="Permanent link">&para;</a></h3>
<p><strong>–°—Ü–µ–Ω–∞—Ä–∏–π:</strong>
- <strong>NVIDIA GPU</strong> ‚Üí passthrough –≤ VM –¥–ª—è Ollama
- <strong>AMD Radeon</strong> ‚Üí –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ –¥–ª—è Proxmox –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</p>
<p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</strong>
- ‚úÖ –•–æ—Å—Ç –∏–º–µ–µ—Ç –≤–∏–¥–µ–æ-–≤—ã–≤–æ–¥ (—É–¥–æ–±–Ω–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è)
- ‚úÖ NVIDIA –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–ª—è Ollama VM
- ‚úÖ –ú–∏–Ω–∏–º—É–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥—Ä–∞–π–≤–µ—Ä–æ–≤
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
- ‚úÖ <strong>–û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã CPU —Ö–æ—Å—Ç–∞</strong> (–µ—Å–ª–∏ —Å–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CPU/iGPU –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∏)</p>
<p><strong>–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ —Ö–æ—Å—Ç–∞:</strong></p>
<p><strong>–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è (–±–µ–∑ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π GPU –Ω–∞ —Ö–æ—Å—Ç–µ):</strong>
- Proxmox —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ <strong>headless —Ä–µ–∂–∏–º–µ</strong> (–±–µ–∑ –º–æ–Ω–∏—Ç–æ—Ä–∞) - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
- –ò–õ–ò –∏—Å–ø–æ–ª—å–∑—É–µ—Ç <strong>iGPU/CPU</strong> –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∏ - –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ CPU 2-5%
- –ò–õ–ò –≤–æ–æ–±—â–µ <strong>–Ω–µ—Ç –≤–∏–¥–µ–æ-–≤—ã–≤–æ–¥–∞</strong> - –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ —Å–±–æ—è—Ö —Å–µ—Ç–∏</p>
<p><strong>–° Radeon 7100 –Ω–∞ —Ö–æ—Å—Ç–µ:</strong>
- ‚úÖ –í–∏–¥–µ–æ-–≤—ã–≤–æ–¥ —á–µ—Ä–µ–∑ GPU (–Ω–µ —á–µ—Ä–µ–∑ CPU)
- ‚úÖ <strong>–û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç 2-5% CPU</strong> (–µ—Å–ª–∏ –±—ã–ª iGPU –∞–∫—Ç–∏–≤–µ–Ω)
- ‚úÖ <strong>–î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Å–æ–ª–∏</strong> –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å —Å–µ—Ç—å—é (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
- ‚úÖ Radeon 7100 –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç <strong>~10-15W</strong> (—Å—Ç–∞—Ä–∞—è –∫–∞—Ä—Ç–∞, –Ω–∏–∑–∫–æ–µ —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ)
- ‚úÖ –î—Ä–∞–π–≤–µ—Ä—ã AMD –∑–∞–Ω–∏–º–∞—é—Ç <strong>~50-100MB RAM</strong> (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ)</p>
<p><strong>–†–µ–∞–ª—å–Ω–∞—è –≤—ã–≥–æ–¥–∞:</strong>
- CPU: <strong>-2-5%</strong> (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è iGPU)
- RAM: <strong>+50-100MB</strong> (–¥—Ä–∞–π–≤–µ—Ä—ã AMD)
- –≠–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ: <strong>+10-15W</strong> (Radeon 7100)
- <strong>–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:</strong> ‚¨ÜÔ∏è‚¨ÜÔ∏è‚¨ÜÔ∏è (–µ—Å—Ç—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Å–æ–ª–∏!)</p>
<p><strong>–í—ã–≤–æ–¥:</strong> –û—Å–Ω–æ–≤–Ω–∞—è –≤—ã–≥–æ–¥–∞ - <strong>–Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ —É–¥–æ–±—Å—Ç–≤–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è</strong>, –∞ –Ω–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤. CPU –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–µ–π—á–∞—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è iGPU.</p>
<p><strong>–ù–∞—Å—Ç—Ä–æ–π–∫–∞:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="c1"># 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID –æ–±–µ–∏—Ö GPU</span>
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a>lspci<span class="w"> </span>-nn<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;VGA|3D&quot;</span>
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a>
</span><span id="__span-105-4"><a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="c1"># –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:</span>
</span><span id="__span-105-5"><a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a><span class="c1"># 01:00.0 VGA [0300]: NVIDIA Corporation GP106 [P106-100] [10de:1c07]</span>
</span><span id="__span-105-6"><a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a><span class="c1"># 06:00.0 VGA [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Radeon 7100 [1002:515e]</span>
</span><span id="__span-105-7"><a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a>
</span><span id="__span-105-8"><a id="__codelineno-105-8" name="__codelineno-105-8" href="#__codelineno-105-8"></a><span class="c1"># 2. Blacklist —Ç–æ–ª—å–∫–æ NVIDIA (–Ω–µ —Ç—Ä–æ–≥–∞–µ–º AMD –¥—Ä–∞–π–≤–µ—Ä—ã)</span>
</span><span id="__span-105-9"><a id="__codelineno-105-9" name="__codelineno-105-9" href="#__codelineno-105-9"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/blacklist-nvidia.conf<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-105-10"><a id="__codelineno-105-10" name="__codelineno-105-10" href="#__codelineno-105-10"></a><span class="s">blacklist nouveau</span>
</span><span id="__span-105-11"><a id="__codelineno-105-11" name="__codelineno-105-11" href="#__codelineno-105-11"></a><span class="s">blacklist nvidia</span>
</span><span id="__span-105-12"><a id="__codelineno-105-12" name="__codelineno-105-12" href="#__codelineno-105-12"></a><span class="s">blacklist nvidiafb</span>
</span><span id="__span-105-13"><a id="__codelineno-105-13" name="__codelineno-105-13" href="#__codelineno-105-13"></a><span class="s">EOF</span>
</span><span id="__span-105-14"><a id="__codelineno-105-14" name="__codelineno-105-14" href="#__codelineno-105-14"></a>
</span><span id="__span-105-15"><a id="__codelineno-105-15" name="__codelineno-105-15" href="#__codelineno-105-15"></a><span class="c1"># 3. VFIO —Ç–æ–ª—å–∫–æ –¥–ª—è NVIDIA (–ø–æ–¥—Å—Ç–∞–≤—å —Å–≤–æ–π ID –∏–∑ —à–∞–≥–∞ 1)</span>
</span><span id="__span-105-16"><a id="__codelineno-105-16" name="__codelineno-105-16" href="#__codelineno-105-16"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;options vfio-pci ids=10de:1c07&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/vfio.conf
</span><span id="__span-105-17"><a id="__codelineno-105-17" name="__codelineno-105-17" href="#__codelineno-105-17"></a>
</span><span id="__span-105-18"><a id="__codelineno-105-18" name="__codelineno-105-18" href="#__codelineno-105-18"></a><span class="c1"># 4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å AMD –¥—Ä–∞–π–≤–µ—Ä—ã –Ω–∞ —Ö–æ—Å—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –≤—ã–≤–æ–¥)</span>
</span><span id="__span-105-19"><a id="__codelineno-105-19" name="__codelineno-105-19" href="#__codelineno-105-19"></a>apt<span class="w"> </span>update
</span><span id="__span-105-20"><a id="__codelineno-105-20" name="__codelineno-105-20" href="#__codelineno-105-20"></a>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>firmware-amd-graphics
</span><span id="__span-105-21"><a id="__codelineno-105-21" name="__codelineno-105-21" href="#__codelineno-105-21"></a>
</span><span id="__span-105-22"><a id="__codelineno-105-22" name="__codelineno-105-22" href="#__codelineno-105-22"></a><span class="c1"># 5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞</span>
</span><span id="__span-105-23"><a id="__codelineno-105-23" name="__codelineno-105-23" href="#__codelineno-105-23"></a>update-initramfs<span class="w"> </span>-u<span class="w"> </span>-k<span class="w"> </span>all
</span><span id="__span-105-24"><a id="__codelineno-105-24" name="__codelineno-105-24" href="#__codelineno-105-24"></a>reboot
</span></code></pre></div>
<p><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="c1"># NVIDIA –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ vfio-pci</span>
</span><span id="__span-106-2"><a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a>lspci<span class="w"> </span>-nnk<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">3</span><span class="w"> </span>-i<span class="w"> </span>nvidia
</span><span id="__span-106-3"><a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a><span class="c1"># –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:</span>
</span><span id="__span-106-4"><a id="__codelineno-106-4" name="__codelineno-106-4" href="#__codelineno-106-4"></a><span class="c1"># Kernel driver in use: vfio-pci</span>
</span><span id="__span-106-5"><a id="__codelineno-106-5" name="__codelineno-106-5" href="#__codelineno-106-5"></a>
</span><span id="__span-106-6"><a id="__codelineno-106-6" name="__codelineno-106-6" href="#__codelineno-106-6"></a><span class="c1"># AMD –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Ö–æ—Å—Ç–µ</span>
</span><span id="__span-106-7"><a id="__codelineno-106-7" name="__codelineno-106-7" href="#__codelineno-106-7"></a>lspci<span class="w"> </span>-nnk<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">3</span><span class="w"> </span>-i<span class="w"> </span>radeon
</span><span id="__span-106-8"><a id="__codelineno-106-8" name="__codelineno-106-8" href="#__codelineno-106-8"></a><span class="c1"># –û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:</span>
</span><span id="__span-106-9"><a id="__codelineno-106-9" name="__codelineno-106-9" href="#__codelineno-106-9"></a><span class="c1"># Kernel driver in use: radeon (–∏–ª–∏ amdgpu –¥–ª—è –Ω–æ–≤—ã—Ö –∫–∞—Ä—Ç)</span>
</span></code></pre></div>
<h3 id="2-vm-gpu">–í–∞—Ä–∏–∞–Ω—Ç 2: –î–≤–µ VM - –∫–∞–∂–¥–∞—è —Å–æ —Å–≤–æ–µ–π GPU<a class="headerlink" href="#2-vm-gpu" title="Permanent link">&para;</a></h3>
<p><strong>–°—Ü–µ–Ω–∞—Ä–∏–π:</strong>
- <strong>NVIDIA GPU</strong> ‚Üí VM 1 (Ollama)
- <strong>AMD Radeon</strong> ‚Üí VM 2 (–¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–∏—Å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–∏–¥–µ–æ-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ)</p>
<p><strong>–ù–∞—Å—Ç—Ä–æ–π–∫–∞:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="c1"># 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID –æ–±–µ–∏—Ö GPU</span>
</span><span id="__span-107-2"><a id="__codelineno-107-2" name="__codelineno-107-2" href="#__codelineno-107-2"></a>lspci<span class="w"> </span>-nn<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;VGA|3D&quot;</span>
</span><span id="__span-107-3"><a id="__codelineno-107-3" name="__codelineno-107-3" href="#__codelineno-107-3"></a>
</span><span id="__span-107-4"><a id="__codelineno-107-4" name="__codelineno-107-4" href="#__codelineno-107-4"></a><span class="c1"># 2. Blacklist –æ–±–∞ GPU –Ω–∞ —Ö–æ—Å—Ç–µ</span>
</span><span id="__span-107-5"><a id="__codelineno-107-5" name="__codelineno-107-5" href="#__codelineno-107-5"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/blacklist-gpu.conf<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-107-6"><a id="__codelineno-107-6" name="__codelineno-107-6" href="#__codelineno-107-6"></a><span class="s">blacklist nouveau</span>
</span><span id="__span-107-7"><a id="__codelineno-107-7" name="__codelineno-107-7" href="#__codelineno-107-7"></a><span class="s">blacklist nvidia</span>
</span><span id="__span-107-8"><a id="__codelineno-107-8" name="__codelineno-107-8" href="#__codelineno-107-8"></a><span class="s">blacklist nvidiafb</span>
</span><span id="__span-107-9"><a id="__codelineno-107-9" name="__codelineno-107-9" href="#__codelineno-107-9"></a><span class="s">blacklist radeon</span>
</span><span id="__span-107-10"><a id="__codelineno-107-10" name="__codelineno-107-10" href="#__codelineno-107-10"></a><span class="s">blacklist amdgpu</span>
</span><span id="__span-107-11"><a id="__codelineno-107-11" name="__codelineno-107-11" href="#__codelineno-107-11"></a><span class="s">EOF</span>
</span><span id="__span-107-12"><a id="__codelineno-107-12" name="__codelineno-107-12" href="#__codelineno-107-12"></a>
</span><span id="__span-107-13"><a id="__codelineno-107-13" name="__codelineno-107-13" href="#__codelineno-107-13"></a><span class="c1"># 3. VFIO –¥–ª—è –æ–±–µ–∏—Ö GPU (–ø–æ–¥—Å—Ç–∞–≤—å —Å–≤–æ–∏ ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</span>
</span><span id="__span-107-14"><a id="__codelineno-107-14" name="__codelineno-107-14" href="#__codelineno-107-14"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;options vfio-pci ids=10de:1c07,1002:515e&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/vfio.conf
</span><span id="__span-107-15"><a id="__codelineno-107-15" name="__codelineno-107-15" href="#__codelineno-107-15"></a>
</span><span id="__span-107-16"><a id="__codelineno-107-16" name="__codelineno-107-16" href="#__codelineno-107-16"></a><span class="c1"># 4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞</span>
</span><span id="__span-107-17"><a id="__codelineno-107-17" name="__codelineno-107-17" href="#__codelineno-107-17"></a>update-initramfs<span class="w"> </span>-u<span class="w"> </span>-k<span class="w"> </span>all
</span><span id="__span-107-18"><a id="__codelineno-107-18" name="__codelineno-107-18" href="#__codelineno-107-18"></a>reboot
</span></code></pre></div>
<p><strong>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ GPU –≤ VM:</strong></p>
<ul>
<li><strong>VM 1 (Ollama):</strong> –î–æ–±–∞–≤–∏—Ç—å NVIDIA —á–µ—Ä–µ–∑ Proxmox UI (Hardware ‚Üí Add ‚Üí PCI Device)</li>
<li><strong>VM 2:</strong> –î–æ–±–∞–≤–∏—Ç—å AMD —á–µ—Ä–µ–∑ Proxmox UI (Hardware ‚Üí Add ‚Üí PCI Device)</li>
</ul>
<p><strong>–í–∞–∂–Ω–æ:</strong> –ö–∞–∂–¥–∞—è GPU –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π VM –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.</p>
<h3 id="3-nvidia-gpu-vm">–í–∞—Ä–∏–∞–Ω—Ç 3: –î–≤–µ NVIDIA GPU –≤ –æ–¥–Ω–æ–π VM (–¥–ª—è –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π)<a class="headerlink" href="#3-nvidia-gpu-vm" title="Permanent link">&para;</a></h3>
<p><strong>–°—Ü–µ–Ω–∞—Ä–∏–π:</strong> –î–≤–µ NVIDIA GPU –≤ –æ–¥–Ω–æ–π VM –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π (llama3.1:70b, mistral:large).</p>
<p><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:</strong>
- ‚ö†Ô∏è –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å <strong>–æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏</strong> GPU (–æ–±–µ NVIDIA)
- ‚ö†Ô∏è Ollama –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç multi-GPU —Ç–æ–ª—å–∫–æ –¥–ª—è CUDA (NVIDIA)
- ‚ö†Ô∏è AMD ROCm –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è Ollama (–Ω–∞ 2025 –≥–æ–¥)</p>
<p><strong>–ù–∞—Å—Ç—Ä–æ–π–∫–∞:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="c1"># 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å ID –æ–±–µ–∏—Ö NVIDIA GPU</span>
</span><span id="__span-108-2"><a id="__codelineno-108-2" name="__codelineno-108-2" href="#__codelineno-108-2"></a>lspci<span class="w"> </span>-nn<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>nvidia
</span><span id="__span-108-3"><a id="__codelineno-108-3" name="__codelineno-108-3" href="#__codelineno-108-3"></a>
</span><span id="__span-108-4"><a id="__codelineno-108-4" name="__codelineno-108-4" href="#__codelineno-108-4"></a><span class="c1"># 2. Blacklist NVIDIA –Ω–∞ —Ö–æ—Å—Ç–µ</span>
</span><span id="__span-108-5"><a id="__codelineno-108-5" name="__codelineno-108-5" href="#__codelineno-108-5"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/blacklist-nvidia.conf<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-108-6"><a id="__codelineno-108-6" name="__codelineno-108-6" href="#__codelineno-108-6"></a><span class="s">blacklist nouveau</span>
</span><span id="__span-108-7"><a id="__codelineno-108-7" name="__codelineno-108-7" href="#__codelineno-108-7"></a><span class="s">blacklist nvidia</span>
</span><span id="__span-108-8"><a id="__codelineno-108-8" name="__codelineno-108-8" href="#__codelineno-108-8"></a><span class="s">blacklist nvidiafb</span>
</span><span id="__span-108-9"><a id="__codelineno-108-9" name="__codelineno-108-9" href="#__codelineno-108-9"></a><span class="s">EOF</span>
</span><span id="__span-108-10"><a id="__codelineno-108-10" name="__codelineno-108-10" href="#__codelineno-108-10"></a>
</span><span id="__span-108-11"><a id="__codelineno-108-11" name="__codelineno-108-11" href="#__codelineno-108-11"></a><span class="c1"># 3. VFIO –¥–ª—è –æ–±–µ–∏—Ö NVIDIA (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</span>
</span><span id="__span-108-12"><a id="__codelineno-108-12" name="__codelineno-108-12" href="#__codelineno-108-12"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;options vfio-pci ids=10de:1c07,10de:1c82&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/etc/modprobe.d/vfio.conf
</span><span id="__span-108-13"><a id="__codelineno-108-13" name="__codelineno-108-13" href="#__codelineno-108-13"></a>
</span><span id="__span-108-14"><a id="__codelineno-108-14" name="__codelineno-108-14" href="#__codelineno-108-14"></a><span class="c1"># 4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞</span>
</span><span id="__span-108-15"><a id="__codelineno-108-15" name="__codelineno-108-15" href="#__codelineno-108-15"></a>update-initramfs<span class="w"> </span>-u<span class="w"> </span>-k<span class="w"> </span>all
</span><span id="__span-108-16"><a id="__codelineno-108-16" name="__codelineno-108-16" href="#__codelineno-108-16"></a>reboot
</span></code></pre></div>
<p><strong>–í VM:</strong></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="c1"># 1. –î–æ–±–∞–≤–∏—Ç—å –æ–±–µ GPU —á–µ—Ä–µ–∑ Proxmox UI –≤ –æ–¥–Ω—É VM</span>
</span><span id="__span-109-2"><a id="__codelineno-109-2" name="__codelineno-109-2" href="#__codelineno-109-2"></a>
</span><span id="__span-109-3"><a id="__codelineno-109-3" name="__codelineno-109-3" href="#__codelineno-109-3"></a><span class="c1"># 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å NVIDIA –¥—Ä–∞–π–≤–µ—Ä—ã (–∫–∞–∫ –æ–±—ã—á–Ω–æ)</span>
</span><span id="__span-109-4"><a id="__codelineno-109-4" name="__codelineno-109-4" href="#__codelineno-109-4"></a>
</span><span id="__span-109-5"><a id="__codelineno-109-5" name="__codelineno-109-5" href="#__codelineno-109-5"></a><span class="c1"># 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –æ–±–µ GPU –≤–∏–¥–Ω—ã</span>
</span><span id="__span-109-6"><a id="__codelineno-109-6" name="__codelineno-109-6" href="#__codelineno-109-6"></a>nvidia-smi
</span><span id="__span-109-7"><a id="__codelineno-109-7" name="__codelineno-109-7" href="#__codelineno-109-7"></a><span class="c1"># –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å –æ–±–µ GPU</span>
</span><span id="__span-109-8"><a id="__codelineno-109-8" name="__codelineno-109-8" href="#__codelineno-109-8"></a>
</span><span id="__span-109-9"><a id="__codelineno-109-9" name="__codelineno-109-9" href="#__codelineno-109-9"></a><span class="c1"># 4. Ollama –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±–µ GPU –µ—Å–ª–∏:</span>
</span><span id="__span-109-10"><a id="__codelineno-109-10" name="__codelineno-109-10" href="#__codelineno-109-10"></a><span class="c1"># - –ú–æ–¥–µ–ª—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–æ–ª—å—à–∞—è (7B+)</span>
</span><span id="__span-109-11"><a id="__codelineno-109-11" name="__codelineno-109-11" href="#__codelineno-109-11"></a><span class="c1"># - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ VRAM –Ω–∞ –æ–±–µ–∏—Ö GPU</span>
</span><span id="__span-109-12"><a id="__codelineno-109-12" name="__codelineno-109-12" href="#__codelineno-109-12"></a><span class="c1"># - CUDA –≤–∏–¥–∏—Ç –æ–±–µ GPU</span>
</span><span id="__span-109-13"><a id="__codelineno-109-13" name="__codelineno-109-13" href="#__codelineno-109-13"></a>
</span><span id="__span-109-14"><a id="__codelineno-109-14" name="__codelineno-109-14" href="#__codelineno-109-14"></a><span class="c1"># –ú–æ–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å:</span>
</span><span id="__span-109-15"><a id="__codelineno-109-15" name="__codelineno-109-15" href="#__codelineno-109-15"></a><span class="nb">export</span><span class="w"> </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="m">0</span>,1
</span><span id="__span-109-16"><a id="__codelineno-109-16" name="__codelineno-109-16" href="#__codelineno-109-16"></a>ollama<span class="w"> </span>run<span class="w"> </span>llama3.1:8b
</span></code></pre></div>
<p><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong>
- –î–≤–µ GPU <strong>–Ω–µ –¥–∞—é—Ç 2x —É—Å–∫–æ—Ä–µ–Ω–∏–µ</strong> (–æ–±—ã—á–Ω–æ 1.5-1.7x)
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏ –∏ —Ä–∞–∑–º–µ—Ä–∞ batch
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –º–æ–¥–µ–ª–µ–π &gt; 8B –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</p>
<h3 id="nvidia-amd">–°–º–µ—à–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (NVIDIA + AMD)<a class="headerlink" href="#nvidia-amd" title="Permanent link">&para;</a></h3>
<p><strong>‚ö†Ô∏è –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</strong>
- NVIDIA –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CUDA, AMD –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ROCm
- Ollama –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ROCm (—Ç–æ–ª—å–∫–æ CUDA)
- –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–µ GPU –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –æ–¥–Ω–æ–π VM –¥–ª—è Ollama</p>
<p><strong>–ï—Å–ª–∏ –Ω—É–∂–Ω–æ:</strong>
- NVIDIA ‚Üí VM –¥–ª—è Ollama
- AMD ‚Üí –•–æ—Å—Ç –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω–∞—è VM –¥–ª—è –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á</p>
<hr />
<h2 id="_6">–§–∏–Ω–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<div class="language-text highlight"><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-110-2"><a id="__codelineno-110-2" name="__codelineno-110-2" href="#__codelineno-110-2"></a>‚îÇ  Proxmox VE Host (Debian 12 Bookworm)       ‚îÇ
</span><span id="__span-110-3"><a id="__codelineno-110-3" name="__codelineno-110-3" href="#__codelineno-110-3"></a>‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
</span><span id="__span-110-4"><a id="__codelineno-110-4" name="__codelineno-110-4" href="#__codelineno-110-4"></a>‚îÇ  ‚îÇ IOMMU/VT-d: Enabled                    ‚îÇ ‚îÇ
</span><span id="__span-110-5"><a id="__codelineno-110-5" name="__codelineno-110-5" href="#__codelineno-110-5"></a>‚îÇ  ‚îÇ VFIO modules: Loaded                   ‚îÇ ‚îÇ
</span><span id="__span-110-6"><a id="__codelineno-110-6" name="__codelineno-110-6" href="#__codelineno-110-6"></a>‚îÇ  ‚îÇ GPU bound to: vfio-pci                 ‚îÇ ‚îÇ
</span><span id="__span-110-7"><a id="__codelineno-110-7" name="__codelineno-110-7" href="#__codelineno-110-7"></a>‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
</span><span id="__span-110-8"><a id="__codelineno-110-8" name="__codelineno-110-8" href="#__codelineno-110-8"></a>‚îÇ              ‚Üì PCI Passthrough              ‚îÇ
</span><span id="__span-110-9"><a id="__codelineno-110-9" name="__codelineno-110-9" href="#__codelineno-110-9"></a>‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
</span><span id="__span-110-10"><a id="__codelineno-110-10" name="__codelineno-110-10" href="#__codelineno-110-10"></a>‚îÇ  ‚îÇ Ubuntu Server 22.04 VM (ID: 300)       ‚îÇ ‚îÇ
</span><span id="__span-110-11"><a id="__codelineno-110-11" name="__codelineno-110-11" href="#__codelineno-110-11"></a>‚îÇ  ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îÇ
</span><span id="__span-110-12"><a id="__codelineno-110-12" name="__codelineno-110-12" href="#__codelineno-110-12"></a>‚îÇ  ‚îÇ ‚îÇ NVIDIA Driver 535+                 ‚îÇ ‚îÇ ‚îÇ
</span><span id="__span-110-13"><a id="__codelineno-110-13" name="__codelineno-110-13" href="#__codelineno-110-13"></a>‚îÇ  ‚îÇ ‚îÇ CUDA 12.2                          ‚îÇ ‚îÇ ‚îÇ
</span><span id="__span-110-14"><a id="__codelineno-110-14" name="__codelineno-110-14" href="#__codelineno-110-14"></a>‚îÇ  ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îÇ
</span><span id="__span-110-15"><a id="__codelineno-110-15" name="__codelineno-110-15" href="#__codelineno-110-15"></a>‚îÇ  ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ ‚îÇ
</span><span id="__span-110-16"><a id="__codelineno-110-16" name="__codelineno-110-16" href="#__codelineno-110-16"></a>‚îÇ  ‚îÇ ‚îÇ Ollama Service                     ‚îÇ ‚îÇ ‚îÇ
</span><span id="__span-110-17"><a id="__codelineno-110-17" name="__codelineno-110-17" href="#__codelineno-110-17"></a>‚îÇ  ‚îÇ ‚îÇ API: 0.0.0.0:11434                 ‚îÇ ‚îÇ ‚îÇ
</span><span id="__span-110-18"><a id="__codelineno-110-18" name="__codelineno-110-18" href="#__codelineno-110-18"></a>‚îÇ  ‚îÇ ‚îÇ Model: phi3:mini (2.3GB)           ‚îÇ ‚îÇ ‚îÇ
</span><span id="__span-110-19"><a id="__codelineno-110-19" name="__codelineno-110-19" href="#__codelineno-110-19"></a>‚îÇ  ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ ‚îÇ
</span><span id="__span-110-20"><a id="__codelineno-110-20" name="__codelineno-110-20" href="#__codelineno-110-20"></a>‚îÇ  ‚îÇ Resources:                             ‚îÇ ‚îÇ
</span><span id="__span-110-21"><a id="__codelineno-110-21" name="__codelineno-110-21" href="#__codelineno-110-21"></a>‚îÇ  ‚îÇ - CPU: 4 cores (type: host)            ‚îÇ ‚îÇ
</span><span id="__span-110-22"><a id="__codelineno-110-22" name="__codelineno-110-22" href="#__codelineno-110-22"></a>‚îÇ  ‚îÇ - RAM: 8GB                             ‚îÇ ‚îÇ
</span><span id="__span-110-23"><a id="__codelineno-110-23" name="__codelineno-110-23" href="#__codelineno-110-23"></a>‚îÇ  ‚îÇ - Disk: 50GB VirtIO                   ‚îÇ ‚îÇ
</span><span id="__span-110-24"><a id="__codelineno-110-24" name="__codelineno-110-24" href="#__codelineno-110-24"></a>‚îÇ  ‚îÇ - GPU: GTX 1050 Ti (passthrough)       ‚îÇ ‚îÇ
</span><span id="__span-110-25"><a id="__codelineno-110-25" name="__codelineno-110-25" href="#__codelineno-110-25"></a>‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
</span><span id="__span-110-26"><a id="__codelineno-110-26" name="__codelineno-110-26" href="#__codelineno-110-26"></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-110-27"><a id="__codelineno-110-27" name="__codelineno-110-27" href="#__codelineno-110-27"></a>           ‚îÇ Network: vmbr0
</span><span id="__span-110-28"><a id="__codelineno-110-28" name="__codelineno-110-28" href="#__codelineno-110-28"></a>           ‚Üì
</span><span id="__span-110-29"><a id="__codelineno-110-29" name="__codelineno-110-29" href="#__codelineno-110-29"></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-110-30"><a id="__codelineno-110-30" name="__codelineno-110-30" href="#__codelineno-110-30"></a>‚îÇ  n8n Server                ‚îÇ
</span><span id="__span-110-31"><a id="__codelineno-110-31" name="__codelineno-110-31" href="#__codelineno-110-31"></a>‚îÇ  HTTP: &lt;VM_IP&gt;:11434       ‚îÇ
</span><span id="__span-110-32"><a id="__codelineno-110-32" name="__codelineno-110-32" href="#__codelineno-110-32"></a>‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
</span><span id="__span-110-33"><a id="__codelineno-110-33" name="__codelineno-110-33" href="#__codelineno-110-33"></a>‚îÇ  ‚îÇ Langchain Agent      ‚îÇ  ‚îÇ
</span><span id="__span-110-34"><a id="__codelineno-110-34" name="__codelineno-110-34" href="#__codelineno-110-34"></a>‚îÇ  ‚îÇ - Ollama LLM         ‚îÇ  ‚îÇ
</span><span id="__span-110-35"><a id="__codelineno-110-35" name="__codelineno-110-35" href="#__codelineno-110-35"></a>‚îÇ  ‚îÇ - Memory Buffer      ‚îÇ  ‚îÇ
</span><span id="__span-110-36"><a id="__codelineno-110-36" name="__codelineno-110-36" href="#__codelineno-110-36"></a>‚îÇ  ‚îÇ - HA Tools (5)       ‚îÇ  ‚îÇ
</span><span id="__span-110-37"><a id="__codelineno-110-37" name="__codelineno-110-37" href="#__codelineno-110-37"></a>‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
</span><span id="__span-110-38"><a id="__codelineno-110-38" name="__codelineno-110-38" href="#__codelineno-110-38"></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-110-39"><a id="__codelineno-110-39" name="__codelineno-110-39" href="#__codelineno-110-39"></a>           ‚Üì
</span><span id="__span-110-40"><a id="__codelineno-110-40" name="__codelineno-110-40" href="#__codelineno-110-40"></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-110-41"><a id="__codelineno-110-41" name="__codelineno-110-41" href="#__codelineno-110-41"></a>‚îÇ  Home Assistant            ‚îÇ
</span><span id="__span-110-42"><a id="__codelineno-110-42" name="__codelineno-110-42" href="#__codelineno-110-42"></a>‚îÇ  REST API: :8123           ‚îÇ
</span><span id="__span-110-43"><a id="__codelineno-110-43" name="__codelineno-110-43" href="#__codelineno-110-43"></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span><span id="__span-110-44"><a id="__codelineno-110-44" name="__codelineno-110-44" href="#__codelineno-110-44"></a>           ‚Üì
</span><span id="__span-110-45"><a id="__codelineno-110-45" name="__codelineno-110-45" href="#__codelineno-110-45"></a>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
</span><span id="__span-110-46"><a id="__codelineno-110-46" name="__codelineno-110-46" href="#__codelineno-110-46"></a>‚îÇ  Telegram Bot              ‚îÇ
</span><span id="__span-110-47"><a id="__codelineno-110-47" name="__codelineno-110-47" href="#__codelineno-110-47"></a>‚îÇ  User Interface            ‚îÇ
</span><span id="__span-110-48"><a id="__codelineno-110-48" name="__codelineno-110-48" href="#__codelineno-110-48"></a>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</span></code></pre></div>
<hr />
<h2 id="_7">–ß–µ–∫–ª–∏—Å—Ç —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<p>–ü—Ä–æ–π–¥–∏—Ç–µ—Å—å –ø–æ —Å–ø–∏—Å–∫—É, –≤—Å–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å ‚úÖ:</p>
<p><strong>Proxmox —Ö–æ—Å—Ç:</strong>
- ‚úÖ IOMMU enabled –≤ BIOS (–¥–ª—è ASRock: Advanced ‚Üí AMD CBS ‚Üí IOMMU)
- ‚úÖ BIOS –ø–µ—Ä–µ–¥–∞–µ—Ç IVRS —Ç–∞–±–ª–∏—Ü—É (<code>dmesg | grep -i ivrs</code> –Ω–µ –ø—É—Å—Ç–æ)
- ‚úÖ GRUB –æ–±–Ω–æ–≤–ª–µ–Ω —Å <code>iommu=pt</code> (–¥–ª—è AMD: <code>amd_iommu=on</code> –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- ‚úÖ IOMMU –≥—Ä—É–ø–ø—ã —Å–æ–∑–¥–∞–Ω—ã (<code>ls /sys/kernel/iommu_groups/ | wc -l</code> &gt; 0)
- ‚úÖ AMD-Vi –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω (<code>dmesg | grep -i amd-vi</code> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Interrupt remapping enabled")
- ‚úÖ VFIO –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (<code>lsmod | grep vfio</code>)
- ‚úÖ GPU captured by vfio-pci (<code>lspci -nnk</code> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Kernel driver in use: vfio-pci")
- ‚úÖ –ù–µ—Ç NVIDIA –¥—Ä–∞–π–≤–µ—Ä–æ–≤ –Ω–∞ —Ö–æ—Å—Ç–µ (<code>dpkg -l | grep nvidia</code> - –ø—É—Å—Ç–æ)</p>
<p><strong>Ubuntu VM:</strong>
- ‚úÖ GPU –≤–∏–¥–µ–Ω –≤ VM (<code>lspci | grep nvidia</code>)
- ‚úÖ NVIDIA –¥—Ä–∞–π–≤–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (<code>nvidia-smi</code> —Ä–∞–±–æ—Ç–∞–µ—Ç)
- ‚úÖ Ollama —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω (<code>systemctl status ollama</code>)
- ‚úÖ API –¥–æ—Å—Ç—É–ø–µ–Ω (<code>curl http://localhost:11434/api/tags</code>)
- ‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ (<code>ollama list</code>)
- ‚úÖ GPU –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (<code>nvidia-smi</code> –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ inference)</p>
<p><strong>n8n –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:</strong>
- ‚úÖ Workflow –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
- ‚úÖ Ollama node –Ω–∞—Å—Ç—Ä–æ–µ–Ω (Base URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
- ‚úÖ HA credential —Å–æ–∑–¥–∞–Ω
- ‚úÖ Telegram credential —Å–æ–∑–¥–∞–Ω
- ‚úÖ 5 Tool workflows —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ Workflow –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
- ‚úÖ Telegram –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç</p>
<hr />
<h2 id="_8">–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="proxmox">–ù–∞ Proxmox —Ö–æ—Å—Ç–µ<a class="headerlink" href="#proxmox" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="c1"># IOMMU —Å—Ç–∞—Ç—É—Å</span>
</span><span id="__span-111-2"><a id="__codelineno-111-2" name="__codelineno-111-2" href="#__codelineno-111-2"></a>dmesg<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>iommu
</span><span id="__span-111-3"><a id="__codelineno-111-3" name="__codelineno-111-3" href="#__codelineno-111-3"></a>
</span><span id="__span-111-4"><a id="__codelineno-111-4" name="__codelineno-111-4" href="#__codelineno-111-4"></a><span class="c1"># VFIO –º–æ–¥—É–ª–∏</span>
</span><span id="__span-111-5"><a id="__codelineno-111-5" name="__codelineno-111-5" href="#__codelineno-111-5"></a>lsmod<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>vfio
</span><span id="__span-111-6"><a id="__codelineno-111-6" name="__codelineno-111-6" href="#__codelineno-111-6"></a>
</span><span id="__span-111-7"><a id="__codelineno-111-7" name="__codelineno-111-7" href="#__codelineno-111-7"></a><span class="c1"># GPU binding</span>
</span><span id="__span-111-8"><a id="__codelineno-111-8" name="__codelineno-111-8" href="#__codelineno-111-8"></a>lspci<span class="w"> </span>-nnk<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">3</span><span class="w"> </span>nvidia
</span><span id="__span-111-9"><a id="__codelineno-111-9" name="__codelineno-111-9" href="#__codelineno-111-9"></a>
</span><span id="__span-111-10"><a id="__codelineno-111-10" name="__codelineno-111-10" href="#__codelineno-111-10"></a><span class="c1"># IOMMU –≥—Ä—É–ø–ø—ã</span>
</span><span id="__span-111-11"><a id="__codelineno-111-11" name="__codelineno-111-11" href="#__codelineno-111-11"></a><span class="k">for</span><span class="w"> </span>d<span class="w"> </span><span class="k">in</span><span class="w"> </span>/sys/kernel/iommu_groups/*/devices/*<span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-111-12"><a id="__codelineno-111-12" name="__codelineno-111-12" href="#__codelineno-111-12"></a><span class="w">    </span><span class="nv">n</span><span class="o">=</span><span class="si">${</span><span class="nv">d</span><span class="p">#*/iommu_groups/*</span><span class="si">}</span><span class="p">;</span><span class="w"> </span><span class="nv">n</span><span class="o">=</span><span class="si">${</span><span class="nv">n</span><span class="p">%%/*</span><span class="si">}</span>
</span><span id="__span-111-13"><a id="__codelineno-111-13" name="__codelineno-111-13" href="#__codelineno-111-13"></a><span class="w">    </span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;Group %s: &#39;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$n</span><span class="s2">&quot;</span>
</span><span id="__span-111-14"><a id="__codelineno-111-14" name="__codelineno-111-14" href="#__codelineno-111-14"></a><span class="w">    </span>lspci<span class="w"> </span>-nns<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">d</span><span class="p">##*/</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-111-15"><a id="__codelineno-111-15" name="__codelineno-111-15" href="#__codelineno-111-15"></a><span class="k">done</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sort<span class="w"> </span>-n<span class="w"> </span>-k2
</span><span id="__span-111-16"><a id="__codelineno-111-16" name="__codelineno-111-16" href="#__codelineno-111-16"></a>
</span><span id="__span-111-17"><a id="__codelineno-111-17" name="__codelineno-111-17" href="#__codelineno-111-17"></a><span class="c1"># –°—Ç–∞—Ç—É—Å VM</span>
</span><span id="__span-111-18"><a id="__codelineno-111-18" name="__codelineno-111-18" href="#__codelineno-111-18"></a>qm<span class="w"> </span>status<span class="w"> </span><span class="m">300</span>
</span><span id="__span-111-19"><a id="__codelineno-111-19" name="__codelineno-111-19" href="#__codelineno-111-19"></a>qm<span class="w"> </span>config<span class="w"> </span><span class="m">300</span>
</span></code></pre></div>
<h3 id="ubuntu-vm">–í Ubuntu VM<a class="headerlink" href="#ubuntu-vm" title="Permanent link">&para;</a></h3>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="c1"># GPU –Ω–∞–ª–∏—á–∏–µ</span>
</span><span id="__span-112-2"><a id="__codelineno-112-2" name="__codelineno-112-2" href="#__codelineno-112-2"></a>lspci<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>nvidia
</span><span id="__span-112-3"><a id="__codelineno-112-3" name="__codelineno-112-3" href="#__codelineno-112-3"></a>
</span><span id="__span-112-4"><a id="__codelineno-112-4" name="__codelineno-112-4" href="#__codelineno-112-4"></a><span class="c1"># NVIDIA –¥—Ä–∞–π–≤–µ—Ä</span>
</span><span id="__span-112-5"><a id="__codelineno-112-5" name="__codelineno-112-5" href="#__codelineno-112-5"></a>nvidia-smi
</span><span id="__span-112-6"><a id="__codelineno-112-6" name="__codelineno-112-6" href="#__codelineno-112-6"></a>nvidia-smi<span class="w"> </span>-L
</span><span id="__span-112-7"><a id="__codelineno-112-7" name="__codelineno-112-7" href="#__codelineno-112-7"></a>
</span><span id="__span-112-8"><a id="__codelineno-112-8" name="__codelineno-112-8" href="#__codelineno-112-8"></a><span class="c1"># CUDA –≤–µ—Ä—Å–∏—è</span>
</span><span id="__span-112-9"><a id="__codelineno-112-9" name="__codelineno-112-9" href="#__codelineno-112-9"></a>nvcc<span class="w"> </span>--version<span class="w">  </span><span class="c1"># –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω CUDA toolkit (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</span>
</span><span id="__span-112-10"><a id="__codelineno-112-10" name="__codelineno-112-10" href="#__codelineno-112-10"></a>
</span><span id="__span-112-11"><a id="__codelineno-112-11" name="__codelineno-112-11" href="#__codelineno-112-11"></a><span class="c1"># Ollama —Å–µ—Ä–≤–∏—Å</span>
</span><span id="__span-112-12"><a id="__codelineno-112-12" name="__codelineno-112-12" href="#__codelineno-112-12"></a>systemctl<span class="w"> </span>status<span class="w"> </span>ollama.service
</span><span id="__span-112-13"><a id="__codelineno-112-13" name="__codelineno-112-13" href="#__codelineno-112-13"></a>journalctl<span class="w"> </span>-u<span class="w"> </span>ollama.service<span class="w"> </span>-n<span class="w"> </span><span class="m">50</span>
</span><span id="__span-112-14"><a id="__codelineno-112-14" name="__codelineno-112-14" href="#__codelineno-112-14"></a>
</span><span id="__span-112-15"><a id="__codelineno-112-15" name="__codelineno-112-15" href="#__codelineno-112-15"></a><span class="c1"># Ollama –ø—Ä–æ—Ü–µ—Å—Å</span>
</span><span id="__span-112-16"><a id="__codelineno-112-16" name="__codelineno-112-16" href="#__codelineno-112-16"></a>ps<span class="w"> </span>aux<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>ollama
</span><span id="__span-112-17"><a id="__codelineno-112-17" name="__codelineno-112-17" href="#__codelineno-112-17"></a>
</span><span id="__span-112-18"><a id="__codelineno-112-18" name="__codelineno-112-18" href="#__codelineno-112-18"></a><span class="c1"># –°–µ—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø</span>
</span><span id="__span-112-19"><a id="__codelineno-112-19" name="__codelineno-112-19" href="#__codelineno-112-19"></a>ss<span class="w"> </span>-tlnp<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">11434</span>
</span><span id="__span-112-20"><a id="__codelineno-112-20" name="__codelineno-112-20" href="#__codelineno-112-20"></a>
</span><span id="__span-112-21"><a id="__codelineno-112-21" name="__codelineno-112-21" href="#__codelineno-112-21"></a><span class="c1"># –ú–æ–¥–µ–ª–∏</span>
</span><span id="__span-112-22"><a id="__codelineno-112-22" name="__codelineno-112-22" href="#__codelineno-112-22"></a>ollama<span class="w"> </span>list
</span><span id="__span-112-23"><a id="__codelineno-112-23" name="__codelineno-112-23" href="#__codelineno-112-23"></a>
</span><span id="__span-112-24"><a id="__codelineno-112-24" name="__codelineno-112-24" href="#__codelineno-112-24"></a><span class="c1"># –¢–µ—Å—Ç API</span>
</span><span id="__span-112-25"><a id="__codelineno-112-25" name="__codelineno-112-25" href="#__codelineno-112-25"></a>curl<span class="w"> </span>http://localhost:11434/api/tags
</span></code></pre></div>
<hr />
<h2 id="_9">–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<p>–î–∞–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞:</p>
<ul>
<li>
<p><strong>Proxmox Official Documentation</strong>
  <a href="https://pve.proxmox.com/wiki/PCI_Passthrough">PCI Passthrough Wiki</a></p>
</li>
<li>
<p><strong>Habr Community (—Ä—É—Å—Å–∫–∏–π)</strong>
  <a href="https://habr.com/ru/articles/794568/">–ü—Ä–æ–±—Ä–æ—Å –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—ã –≤ Proxmox</a></p>
</li>
<li>
<p><strong>Proxmox Forum</strong>
  <a href="https://forum.proxmox.com/threads/ubuntu-22-04-ollama-nvidia-3060-gpu-passthrough-and-drivers-all-looking-good-but.144104/">Ollama + NVIDIA GPU Passthrough Discussion</a></p>
</li>
<li>
<p><strong>Ollama Official</strong>
  <a href="https://github.com/ollama/ollama/blob/main/docs/gpu.md">GPU Support Documentation</a></p>
</li>
<li>
<p><strong>VFIO Documentation</strong>
  <a href="https://www.kernel.org/doc/html/latest/driver-api/vfio.html">Linux VFIO Documentation</a></p>
</li>
</ul>
<hr />
<h2 id="_10">–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<ol>
<li>‚úÖ BIOS –Ω–∞—Å—Ç—Ä–æ–µ–Ω (IOMMU enabled)</li>
<li>‚úÖ Proxmox –Ω–∞—Å—Ç—Ä–æ–µ–Ω (GRUB, VFIO)</li>
<li>‚úÖ GPU –ø—Ä–∏–≤—è–∑–∞–Ω –∫ vfio-pci</li>
<li>‚úÖ Ubuntu VM —Å–æ–∑–¥–∞–Ω–∞</li>
<li>‚úÖ GPU –ø–µ—Ä–µ–¥–∞–Ω –≤ VM</li>
<li>‚úÖ NVIDIA –¥—Ä–∞–π–≤–µ—Ä—ã –≤ VM</li>
<li>‚úÖ Ollama —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω</li>
<li>‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞</li>
<li>‚úÖ n8n –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω</li>
<li>üîÑ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã</li>
<li>üîÑ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ HA Tools</li>
<li>üîÑ –ü–æ—Å–ª–µ –∞–ø–≥—Ä–µ–π–¥–∞ GPU —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ llama3.1:8b</li>
</ol>
<hr />
<h2 id="_11">–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è (–∏–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ–ø—ã—Ç–∞)<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<h3 id="1-asrock-iommu-bios">1. ‚ö†Ô∏è ASRock –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–µ –ø–ª–∞—Ç—ã: IOMMU —Å–∫—Ä—ã—Ç –≤ —Å—Ç–∞—Ä—ã—Ö BIOS<a class="headerlink" href="#1-asrock-iommu-bios" title="Permanent link">&para;</a></h3>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –í BIOS –≤–µ—Ä—Å–∏–∏ P3.xx –æ–ø—Ü–∏—è IOMMU –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å
<strong>–†–µ—à–µ–Ω–∏–µ:</strong> –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ BIOS –¥–æ P7.xx+ (—Å–º. –≠—Ç–∞–ø 1.3)</p>
<h3 id="2-amd-amd_iommu1">2. ‚ö†Ô∏è AMD –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã: –ø–∞—Ä–∞–º–µ—Ç—Ä amd_iommu=1 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç<a class="headerlink" href="#2-amd-amd_iommu1" title="Permanent link">&para;</a></h3>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –í —è–¥—Ä–µ 6.8+ –ø–∞—Ä–∞–º–µ—Ç—Ä <code>amd_iommu=1</code> –≤—ã–∑—ã–≤–∞–µ—Ç "Unknown option"
<strong>–†–µ—à–µ–Ω–∏–µ:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>amd_iommu=on</code> (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å)</p>
<h3 id="3-ram">3. ‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ RAM –Ω–∞ —Ö–æ—Å—Ç–µ<a class="headerlink" href="#3-ram" title="Permanent link">&para;</a></h3>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> VM –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π "Cannot allocate memory"
<strong>–†–µ—à–µ–Ω–∏–µ:</strong> –£–º–µ–Ω—å—à–∏—Ç–µ RAM VM (—Å–º. –≠—Ç–∞–ø 4.5 –∏ Troubleshooting)</p>
<h3 id="4-cpu-vm">4. ‚ö†Ô∏è –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ cpu –≤ –∫–æ–Ω—Ñ–∏–≥–µ VM<a class="headerlink" href="#4-cpu-vm" title="Permanent link">&para;</a></h3>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –ü–æ—Å–ª–µ —Ä—É—á–Ω–æ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Å—Ç–∞–µ—Ç—Å—è —Å—Ç–∞—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ <code>cpu: host</code>
<strong>–†–µ—à–µ–Ω–∏–µ:</strong> –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—É—é —Å—Ç—Ä–æ–∫—É, –æ—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (—Å–º. –≠—Ç–∞–ø 6.2)</p>
<h3 id="5-x-vga1">5. ‚ö†Ô∏è –ú–∞–π–Ω–∏–Ω–≥–æ–≤—ã–µ –∫–∞—Ä—Ç—ã: x-vga=1 –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã<a class="headerlink" href="#5-x-vga1" title="Permanent link">&para;</a></h3>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> P106/P104 –±–µ–∑ –≤–∏–¥–µ–æ–≤—ã—Ö–æ–¥–æ–≤ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å x-vga=1
<strong>–†–µ—à–µ–Ω–∏–µ:</strong> –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ x-vga=1 –¥–ª—è –º–∞–π–Ω–∏–Ω–≥–æ–≤—ã—Ö –∫–∞—Ä—Ç (—Å–º. –≠—Ç–∞–ø 6.1)</p>
<h3 id="6-ollama-127001">6. ‚ö†Ô∏è Ollama —Å–ª—É—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ 127.0.0.1<a class="headerlink" href="#6-ollama-127001" title="Permanent link">&para;</a></h3>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> override.conf –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
<strong>–†–µ—à–µ–Ω–∏–µ:</strong> –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ (—Å–º. –≠—Ç–∞–ø 10.2, –í–∞—Ä–∏–∞–Ω—Ç B)</p>
<h3 id="7-efi">7. ‚úÖ EFI —Ä–∞–∑–¥–µ–ª –Ω–µ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)<a class="headerlink" href="#7-efi" title="Permanent link">&para;</a></h3>
<p><strong>–ü—Ä–æ–±–ª–µ–º–∞:</strong> –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ update-initramfs
<strong>–†–µ—à–µ–Ω–∏–µ:</strong> –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å /dev/sda2 –≤ /boot/efi</p>
<h3 id="8-unknown-option-on-amd_iommu">8. ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "Unknown option - 'on'" –¥–ª—è amd_iommu<a class="headerlink" href="#8-unknown-option-on-amd_iommu" title="Permanent link">&para;</a></h3>
<p><strong>–ù–µ –ø—Ä–æ–±–ª–µ–º–∞:</strong> AMD-Vi –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
<strong>–î–µ–π—Å—Ç–≤–∏–µ:</strong> –ò–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ, –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ IOMMU groups</p>
<hr />
<p><strong>–ê–≤—Ç–æ—Ä:</strong> AI Assistant (Proxmox DevOps Expert)
<strong>–ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è:</strong> Community Best Practices + Deep Proxmox Knowledge + Real Deployment Experience</p>
<p><strong>–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞:</strong>
- <strong>Proxmox VE:</strong> 8.x (—è–¥—Ä–æ 6.8.12-4-pve)
- <strong>Proxmox Host:</strong> 192.168.1.124
- <strong>CPU:</strong> AMD Ryzen 5 2600 Six-Core (12 threads)
- <strong>–ú–∞—Ç–µ—Ä–∏–Ω—Å–∫–∞—è –ø–ª–∞—Ç–∞:</strong> ASRock B450M Pro4 (BIOS P7.40, –æ–±–Ω–æ–≤–ª–µ–Ω–æ —Å P3.50)
- <strong>RAM:</strong> 16GB (–æ–±–Ω–æ–≤–ª–µ–Ω–æ —Å 8GB –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –±–æ–ª—å—à–∏—Ö –º–æ–¥–µ–ª–µ–π)
- <strong>GPU:</strong> NVIDIA P106-100 (–º–∞–π–Ω–∏–Ω–≥–æ–≤–∞—è –∫–∞—Ä—Ç–∞, 6GB VRAM, –±–µ–∑ –≤–∏–¥–µ–æ–≤—ã—Ö–æ–¥–æ–≤)
- <strong>VM ID:</strong> 103 (ollama-vm)
- <strong>VM IP:</strong> 192.168.1.131
- <strong>VM Resources:</strong> Ubuntu 22.04.5 LTS, 4 cores, 10GB RAM, 64GB disk
- <strong>Ollama:</strong> –≤–µ—Ä—Å–∏—è 0.x.x —Å NVIDIA Driver 580.95.05, CUDA 13.0
- <strong>–ú–æ–¥–µ–ª–∏:</strong>
  - llama3.1:8b (4.7GB) - –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å ‚úÖ
  - phi3:mini (2.3GB) - —Ä–µ–∑–µ—Ä–≤–Ω–∞—è
- <strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> llama3.1:8b ~35-45 tokens/sec –Ω–∞ GPU
- <strong>Whisper.cpp:</strong> base –º–æ–¥–µ–ª—å CUDA –≤–µ—Ä—Å–∏—è ‚úÖ
  - 11 —Å–µ–∫ –∞—É–¥–∏–æ ‚Üí 0.56 —Å–µ–∫ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ (19x realtime)
  - API endpoint: http://192.168.1.131:9000
- –¢–∞–∫–∂–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å NVIDIA GTX/RTX 10xx-40xx series (–æ–±—ã—á–Ω—ã–µ –∫–∞—Ä—Ç—ã)</p>
<p><strong>–í–µ—Ä—Å–∏—è:</strong> 1.3 (–æ–±–Ω–æ–≤–ª–µ–Ω–æ —Å —Ä–µ–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π + Whisper)
<strong>–î–∞—Ç–∞:</strong> –ù–æ—è–±—Ä—å 8, 2025</p>
<p><strong>–°—Ç–∞—Ç—É—Å:</strong> ‚úÖ –£—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
<strong>–í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏:</strong> ~90 –º–∏–Ω—É—Ç (Ollama) + ~40 –º–∏–Ω—É—Ç (Whisper —Å CUDA)
<strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong>
- Ollama: GPU utilization 80-100% –≤–æ –≤—Ä–µ–º—è inference
- Whisper: 19x realtime —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏—è –Ω–∞ GPU (0.56 —Å–µ–∫ –Ω–∞ 11 —Å–µ–∫ –∞—É–¥–∏–æ)
- <strong>–û–±—â–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞:</strong> 3-6 —Å–µ–∫ –æ—Ç –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –¥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  –ö –Ω–∞—á–∞–ª—É
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Gfermoto
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Gfermoto/HASSio_Cursor" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "navigation.instant", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0432 \u0431\u0443\u0444\u0435\u0440", "clipboard.copy": "\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432 \u0431\u0443\u0444\u0435\u0440", "search.result.more.one": "\u0415\u0449\u0451 1 \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.more.other": "\u0415\u0449\u0451 # \u043d\u0430 \u044d\u0442\u043e\u0439 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435", "search.result.none": "\u0421\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e", "search.result.one": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e 1 \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0435", "search.result.other": "\u041d\u0430\u0439\u0434\u0435\u043d\u043e \u0441\u043e\u0432\u043f\u0430\u0434\u0435\u043d\u0438\u0439: #", "search.result.placeholder": "\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u043f\u0435\u0447\u0430\u0442\u0430\u0442\u044c \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430", "search.result.term.missing": "\u041e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442", "select.version": "\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0432\u0435\u0440\u0441\u0438\u044e"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>